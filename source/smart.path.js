
/* Smart HTML Elements v4.0.0 (2019-Aug) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-path",class extends Smart.BaseElement{static get properties(){return{value:{value:"",type:"string"},hint:{value:"",type:"string"},label:{value:"",type:"string"},dataSource:{value:[{label:"notAPath"},{label:"validPath"}],type:"any",reflectToAttribute:!1},dropDownAppendTo:{value:null,type:"any"},dropDownPosition:{allowedValues:["auto","top","bottom","overlay-top","overlay-center","overlay-bottom","center-bottom","center-top"],value:"auto",type:"string"},messages:{extend:!0,value:{en:{incorrectArgument:"{{elementType}}: Incorrect argument {{argumentName}} in method {{methodName}}.",missingReference:"{{elementType}}: Missing reference to {{file}} in method {{methodName}}.",notAPath:"Set to not a path",validPath:"Set to valid path"}},type:"object"},name:{value:"",type:"string"},opened:{value:!1,type:"boolean"},placeholder:{value:"Enter a path",type:"string"},pathFormat:{allowedValues:["windows","unix"],value:"windows",type:"string"},renderMode:{allowedValues:["outlined","filled","underlined"],value:"outlined",type:"string"},indicator:{value:!1,type:"boolean"},displayMember:{value:"",type:"string"},valueMember:{value:"",type:"string"},noWrap:{value:!1,type:"boolean"}}}template(){return`<div id="container">
                    <span class="smart-label" id="label">[[label]]</span>
                    <div id="content" class="smart-content">
                        <div class="smart-buttons-container" id="buttonsContainer">
                            <span id="dropDownButton" class="smart-drop-down-button">
                                <span id="icon"></span>
                            </span>
                            <div id="inputContainer" class="smart-path-input-container">
                                <input id="input" type="text" name="[[name]]" class="smart-input smart-action-button"/>
                                <div id="multiline" contenteditable="true" class="smart-input smart-action-button smart-hidden"></div>
                            </div>
                            <span id="browseButton" class="smart-browse-button">
                                <span id="icon"></span>
                            </span>
                        </div>
                        <div id="dropDownContainer" class="smart-drop-down smart-drop-down-container smart-visibility-hidden"></div>
                    </div>
                    <span class="smart-hint" id="hint">[[hint]]</span>
                </div>`}static get listeners(){return{"inputContainer.change":"_inputChangeHandler","inputContainer.keydown":"_inputKeyDownHandler","inputContainer.keyup":"_inputKeyUpHandler","document.down":"_documentDownHandler","document.up":"_documentUpHandler",mouseover:"_mouseOverEventHandler",mouseout:"_mouseOverEventHandler","dropDownContainer.mouseover":"_mouseOverEventHandler","dropDownContainer.mouseout":"_mouseOverEventHandler","inputContainer.focusin":"_focusHandler","inputContainer.focusout":"_focusHandler",resize:"_resizeHandler"}}propertyChangedHandler(a,b,c){super.propertyChangedHandler(a,b,c);const d=this;switch(a){case"":break;case"dropDownAppendTo":d._positionDetection.dropDownAppendToChangedHandler();break;case"dataSource":d._setDropDownSize(),d._positionDetection.checkBrowserBounds("vertically"),d._positionDetection.positionDropDown(),d._positionDetection.checkBrowserBounds("horizontally");break;case"dropDownMinWidth":case"dropDownWidth":case"dropDownMaxWidth":case"dropDownHeight":case"dropDownMinHeight":case"dropDownMaxHeight":d._setDropDownSize();break;case"noWrap":d._setInput();}}attached(){const a=this;super.attached();a.isCompleted&&a.$.dropDownContainer&&(a._positionDetection.dropDownAttached("_setDropDownSize"),a._positionDetection.checkBrowserBounds())}detached(){const a=this;super.detached();a.$.dropDownContainer&&(a.close(),a._positionDetection.dropDownDetached())}ready(){super.ready();const a=this;a._setInput(),a._positionDetection=new Smart.Utilities.PositionDetection(a,a.$.dropDownContainer,a.$.container,"close"),a._positionDetection.getDropDownParent(!0),a._positionDetection.setDropDownPosition(),a._calculateDropDownSize(),a._positionDetection.handleAutoPositioning(),a._setDropDownSize(),a._dataBind(),a.opened&&a.open()}setNotAPath(){}setEmptyPath(){}close(){const a=this;if(!a.$dropDownContainer.hasClass("smart-visibility-hidden")){const b=a.$.fireEvent("closing").defaultPrevented;b||(a.$dropDownContainer.addClass("smart-visibility-hidden"),a.$.fireEvent("close"),a.opened=!1,a._preventDropDownClose=!1,a._positionDetection.removeOverlay(!0),a._edgeMacFF&&!a.hasAnimation&&a.$.dropDownContainer&&(a.$.dropDownContainer.style.top=a.$.dropDownContainer.style.left="",a.$dropDownContainer.addClass("not-in-view")))}}open(){const a=this;if(!a.disabled&&a.offsetHeight&&a.$dropDownContainer.hasClass("smart-visibility-hidden")){if(a._handleItemSelection(),a._inputChangeHandler(),a.$dropDownContainer.hasClass("not-in-view")&&a.$dropDownContainer.removeClass("not-in-view"),a.$.dropDownContainer.style.transition=null,a.dropDownAppendTo&&0<a.dropDownAppendTo.length){const b=a.getBoundingClientRect();if(a.$.container.contains(a.$.dropDownContainer)){let b=0;const c=setInterval(function(){const d=a.getBoundingClientRect();b++,d.top===a._positionTop&&10>b||(a.open(),clearInterval(c),a._positionTop=d.top)},100);return}b.top!==a._positionTop&&(a._positionTop=b.top)}const b=a.$.fireEvent("opening").defaultPrevented;b||(a.opened=!0,a._positionDetection.placeOverlay(),a._positionDetection.checkBrowserBounds("vertically"),a._positionDetection.positionDropDown(),a._positionDetection.checkBrowserBounds("horizontally"),a.$dropDownContainer.removeClass("smart-visibility-hidden"),a.$.fireEvent("open"),a._handleKeyStrokes("Home"),!Smart.Utilities.Core.isMobile&&(a.noWrap?a.$.multiline.focus():a.$.input.focus()))}}_calculateDropDownSize(){const a=this;a._dropDownSize={};const b=window.getComputedStyle(a.$.dropDownContainer),c=parseFloat(b.getPropertyValue("border-top-width").trim()),d=parseFloat(b.getPropertyValue("border-bottom-width").trim()),e=parseFloat(b.getPropertyValue("margin-top").trim()),f=parseFloat(b.getPropertyValue("margin-bottom").trim()),g=parseFloat(b.getPropertyValue("padding-top").trim()),h=parseFloat(b.getPropertyValue("padding-bottom").trim());Smart.Utilities.Core.CSSVariablesSupport()&&(a._dropDownSize.width=b.getPropertyValue("--smart-drop-down-list-drop-down-width").trim(),a._dropDownSize.height=b.getPropertyValue("--smart-drop-down-list-drop-down-height").trim()),(!a._dropDownSize.width||-1<a._dropDownSize.width.indexOf("initial"))&&(a._dropDownSize.width=a.offsetWidth),a._dropDownSize.height||(a._dropDownSize.height="auto"),a._dropDownSize.minHeight=parseFloat(b.getPropertyValue("min-height").trim()),a._dropDownSize.maxHeight=parseFloat(b.getPropertyValue("max-height").trim()),a._dropDownSize.borderWidth=(isNaN(c)?0:c)+(isNaN(d)?0:d),a._dropDownSize.paddingWidth=(isNaN(g)?0:g)+(isNaN(h)?0:h),a._dropDownSize.marginWidth=(isNaN(e)?0:e)+(isNaN(f)?0:f)}_focusHandler(a){this;"focus"===a.type}_setInput(){const a=this;let b=a.$.input,c=a.$.multiline;c.value||Object.defineProperty(c,"value",{get(){return this.textContent},set(a){this.innerHTML=a,a?this.removeAttribute("show-placeholder"):this.setAttribute("show-placeholder",""),b.value=this.textContent}}),c.readonly||Object.defineProperty(c,"readonly",{get(){return this.getAttribute("contenteditable")},set(a){this.setAttribute("contenteditable",!a)}}),a.noWrap?(b.$.addClass("smart-hidden"),c.$.removeClass("smart-hidden")):(b.$.removeClass("smart-hidden"),c.$.addClass("smart-hidden")),b.value=c.value=a.value,b.placeholder=c.placeholder=a.placeholder,b.readonly=c.readonly=a.readonly,c.setAttribute("placeholder",a.placeholder),c.setAttribute("readonly",a.readonly)}_handleItemSelection(a,b){const c=this,d=c.$.dropDownContainer.getElementsByClassName("smart-path-item");for(let c=0;c<d.length;c++)d[c].removeAttribute("active");a&&(b&&c.$.fireEvent(b,{selected:a.hasAttribute("selected"),disabled:a.hasAttribute("disabled"),label:a.label,value:a.value}),a.hasAttribute("disabled")||(a.setAttribute("active",""),"notAPath"===a.value?(c.$.input.value="",c.$.multiline.value="",c.value="//"):"validPath"===a.value&&(c.value="////"),c.close()))}_handleKeyStrokes(a){const b=this,c=[].slice.call(b.$.dropDownContainer.children),d=c.find(a=>a.hasAttribute("focus")),e=function(a,b){if(!a)return;let c;for(c=a[b+"ElementSibling"];c;){if(!c.hasAttribute("disabled"))return c;c=c[b+"ElementSibling"]}};let f;if(c.length){switch(a){case"ArrowDown":case"ArrowRight":f=d?e("next"):c.find(a=>!a.hasAttribute("disabled"));break;case"ArrowUp":case"ArrowLeft":f=d?e("previous"):c.find(a=>!a.hasAttribute("disabled"));break;case"Home":f=c.find(a=>!a.hasAttribute("disabled"));break;case"End":for(let a=c.length-1;0<=a;a--)if(!c[a].hasAttribute("disabled")){f=c[a];break}}f&&(c.map(a=>a.removeAttribute("focus")),f.setAttribute("focus",""))}}_inputChangeHandler(){const a=this,b=a.$.input,c=a.$.dropDownContainer.children;let d,e;for(let a=0;a<c.length;a++){const b=c[a];if("notAPath"===b.value?d=b:"validPath"===b.value&&(e=b),d&&e)break}d&&(!b.value.length||a.indicator?(d.setAttribute("disabled",""),d.hasAttribute("focus")&&d.removeAttribute("focus")):d.removeAttribute("disabled")),e&&(b.value.length||a.indicator?(e.setAttribute("disabled",""),e.hasAttribute("focus")&&e.removeAttribute("focus")):e.removeAttribute("disabled"))}_dataBind(){const a=this,b=a.dataSource;let c=[];if((a.$.dropDownContainer.innerHTML="",b&&b.length)&&("string"==typeof b&&(a.dataSource=JSON.parse(b)),Array.isArray(b))){const d=document.createDocumentFragment();for(let e=0;e<b.length;e++){const f=b[e],g=a._createItem(f);c.push(g),d&&d.appendChild(g)}a.$.dropDownContainer.appendChild(d)}}_documentDownHandler(a){const b=this;if(b.disabled||b.readonly)return;let c=a.originalEvent.target;if(c===b._overlay&&(b._overlayDown=!0),b.enableShadowDOM){c=a.originalEvent.composedPath()[0];for(let a=c.getRootNode().host;a;)a.closest(".smart-drop-down-container")===b.$.dropDownContainer&&(b._isDropDownClicked=!0),a=a.getRootNode().host}else b._isDropDownClicked=c.closest(".smart-drop-down-container")===b.$.dropDownContainer;b._buttonClicked=c.closest(".smart-browse-button")||c.closest(".smart-drop-down-button");let d=c.closest(".smart-path-item");b.$.dropDownContainer.contains(d)||(d=void 0),b.hasRippleAnimation&&d&&Smart.Utilities.Animation.Ripple.animate(d,a.pageX,a.pageY),d&&(b._itemClicked=d,b._preventDropDownClose=!0),b._isDropDownClicked&&(b._preventDropDownClose=!0)}_documentUpHandler(a){const b=this;let c=a.originalEvent.target;const d=c.closest(".smart-path-item");return d===b._itemClicked?void b._handleItemSelection(d,"itemClick"):(b._itemClicked=void 0,b._buttonClicked&&(c.closest(".smart-browse-button")===b._buttonClicked&&b._buttonClicked===b.$.browseButton?b.$.fireEvent("browseButtonClick"):c.closest(".smart-drop-down-button")===b._buttonClicked&&b._buttonClicked===b.$.dropDownButton&&b.$.fireEvent("dropDownButtonClick")),c.closest(".smart-drop-down-button")===b._buttonClicked&&b._buttonClicked===b.$.dropDownButton)?(b.$dropDownContainer.hasClass("smart-visibility-hidden")?b.open():b.close(),void(b._buttonClicked=void 0)):void(b._buttonClicked=void 0,c=b._getUpEventTarget(c),void 0===c||("dropDownContainer"!==c&&"item"!==c||"item"===c)&&b.close())}_inputKeyDownHandler(a){const b=this;if(b.opened)switch(a.key){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Home":case"End":return(a.preventDefault(),a.altKey&&"ArrowUp"===a.key)?void b.close():void b._handleKeyStrokes(a.key);}else if(a.altKey&&"ArrowDown"===a.key)return a.preventDefault(),void b.open();if(b.opened&&"Enter"===a.key)return a.preventDefault(),b._handleItemSelection(b._focusedItem(),"change"),void b.close();if(b.opened&&"Escape"===a.key)return a.preventDefault(),void b.close();const c=/^[a-z0-9\/\\.:\s]$/gmi;c.test(a.key)&&b.$.multiline.removeAttribute("show-placeholder")}_focusedItem(){const a=this.$.dropDownContainer.children;for(let b=0;b<a.length;b++)if(a[b].hasAttribute("focus"))return a[b]}_inputKeyUpHandler(){const a=this;if(a.noWrap){const b=a.$.multiline.value;b||a.$.multiline.setAttribute("show-placeholder",""),a.$.input.value=b}a.opened&&a._inputChangeHandler()}_getUpEventTarget(a){const b=this;let c=a;for(;c;){if(c.classList.contains(".smart-path-item")){if(c.hasAttribute("disabled"))return;c="item";break}else if(c===b.$.dropDownContainer){c="dropDownContainer";break}c=c.parentElement}if(b.enableShadowDOM&&null!==c)for(c=a.getRootNode().host;c;){if(c===b.$.dropDownContainer){c="dropDownContainer";break}c=c.parentElement}return c}_mouseOverEventHandler(a){const b=this,c=a.target,d=c.closest(".smart-drop-down-button")||c.closest(".smart-browse-button")||c.closest(".smart-input")||c.closest(".smart-path-item");!d||d.hasAttribute("disabled")||("mouseover"===a.type?d.setAttribute("hover",""):d.removeAttribute("hover"))}_createItem(a){const b=this,c=document.createElement("div");"number"==typeof a&&(a=""+a);const d=function(b,c){return void 0===a[b]?a[c]:""+a[b]};let e=("string"==typeof a?a:d(b.displayMember,"label"))||"",f=("string"==typeof a?a:d(b.valueMember,"value"))||"";return c.label=c.innerHTML=""+(b.localize(e)||e),c.value=""+(f||e),c.selected=!!a.selected&&a.selected,c.disabled=!!a.disabled&&a.disabled,c.classList.add("smart-path-item"),c}_resizeHandler(){const a=this;"none"===a.resizeMode&&(a._calculateDropDownSize(),a._setDropDownSize())}_setDropDownSize(){const a=this;if(a._dropDownSize||a._calculateDropDownSize(),["dropDownMinWidth","dropDownMinHeight","dropDownMaxWidth","dropDownMaxHeight"].forEach(b=>{a.$.dropDownContainer.style[b.replace("dropDown","").replace(/^./,"m")]=a[b]?a[b]+(a[b].toString().endsWith("%")?"%":"px"):null}),!a.dropDownWidth)a.$.dropDownContainer.style.width="auto"===a._dropDownSize.width?"auto":(parseFloat(a._dropDownSize.width)||0)+"px";else if("auto"!==a.dropDownWidth)a.$.dropDownContainer.style.width=("initial"===a.dropDownWidth?a.offsetWidth:parseFloat(a.dropDownWidth))+"px";else if(a.$.dropDownContainer.style.width="auto",a.$.listBox){let b=2+2*parseInt(window.getComputedStyle(a.$.listBox.$.itemsContainer).getPropertyValue("--smart-list-item-horizontal-offset"));a.$.dropDownContainer.style.width=b+a.$.listBox._scrollWidth+"px"}if(a.dropDownHeight&&"auto"!==a.dropDownHeight)a.$.dropDownContainer.style.height=parseFloat(a.dropDownHeight)+(-1<(a.dropDownHeight+"").indexOf("%")?"%":"px");else if(a.$.listBox&&("auto"===a._dropDownSize.height||"auto"===a.dropDownHeight)){a.$.dropDownContainer.style.height="";let b=2*parseInt(window.getComputedStyle(a.$.listBox.$.itemsContainer).getPropertyValue("--smart-list-item-vertical-offset"));isNaN(b)&&(b=6);let c=b;0<a.$.listBox.items.length&&a.$.listBox.items.map(a=>c+=a.height||a.offsetHeight),c=c+a._dropDownSize.paddingWidth+a._dropDownSize.borderWidth,a.$.dropDownContainer.style.height=c+"px"}else a.$.dropDownContainer.style.height=a._dropDownSize.height;a.$.listBox&&a.$.listBox._refreshLayout()}});