
/* Smart HTML Elements v6.0.0 (2020-Jan) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-layout",class extends Smart.ContentElement{static get properties(){return{contextMenuDataSource:{reflectToAttribute:!1,value:["delete"],type:"any"},dataSource:{reflectToAttribute:!1,value:"",type:"any"},itemLabel:{value:"Template",type:"string"},itemGroupLabel:{value:"Layout",type:"string"},messages:{value:{en:{invalidNode:"{{elementType}}: \"{{method}}\" method accepts an object or an array of objects as it's second parameter.",invalidIndex:"{{elementType}}: \"{{method}}\" method accepts an index of type number.",delete:"Delete",noId:"{{elementType}}: requires an id in order to save/load a state."}},type:"object",extend:!0},liveResize:{value:!1,type:"boolean"},orientation:{allowedValues:["horizontal","vertical"],value:"vertical",type:"string"},placeholder:{value:"Empty",type:"string"},resizeStep:{value:5,type:"number"},selectedIndex:{value:null,type:"any"}}}static get listeners(){return{contextmenu:"_contextMenuHandler","document.down":"_documentDownHandler","document.move":"_documentMoveHandler","document.up":"_documentUpHandler","document.selectstart":"_documentSelectStartHandler"}}static get requires(){return{"Smart.Splitter":"smart.splitter.js"}}template(){return`<div id="container" role="presentation">
                    <smart-splitter id="itemsContainer" orientation="[[orientation]]" class="smart-items-container" theme="[[theme]]">
                        <smart-splitter-item><content></content></smart-splitter-item>
                    </smart-splitter>
                </div>`}propertyChangedHandler(a,b,c){const d=this;switch(a){case"contextMenuDataSource":d._contextMenu&&(d._closeContextMenu(),d._contextMenu.innerHTML="");break;case"dataSource":d._dataBind(!0);break;case"selectedIndex":d._handleItemSelection(d.getItem(c+""),!0);break;case"liveResize":case"resizeStep":case"animation":case"rightToLeft":d._applySplitterProperties(a);break;default:super.propertyChangedHandler(a,b,c);}}render(){const a=this;a.setAttribute("role","group"),a._dataBind(),a._applySplitterProperties(["liveResize","resizeStep","animation","rightToLeft"]),a._handleItemSelection(a.getItem(a.selectedIndex+""),!0),a.checkLicense(),Object.defineProperty(a,"dataSource",{get:function(){return a.context===a?a.properties.dataSource.value:a._getDataSource(a._getLayoutStruture())},set(b){a.updateProperty(a,a._properties.dataSource,b)}}),super.render()}appendChild(a){const b=this;if(!b.isCompleted||a instanceof HTMLElement&&a.classList.contains("smart-resize-trigger-container")){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.appendChild.apply(b,a.concat(Array.prototype.slice.call(arguments)))}return a&&a instanceof Smart.SplitterItem?void(b.contains(a)||b.querySelector("smart-splitter:last-of-type").appendChild(a)):void b.error(b.localize("invalidNode",{elementType:b.nodeName.toLowerCase(),method:"appendChild",node:"node"}))}insertBefore(a,b){const c=this;if(!a)return void c.error(c.localize("invalidNode",{elementType:c.nodeName.toLowerCase(),method:"insertBefore",node:"node"}));if(!c.isCompleted||a instanceof HTMLElement&&a.classList.contains("smart-resize-trigger-container")){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.insertBefore.apply(c,a.concat(Array.prototype.slice.call(arguments)))}c.contains(b)&&b.closest("smart-splitter").insertBefore(a,b)}removeChild(a){const b=this;if(!b.isCompleted||a instanceof HTMLElement&&a.classList.contains("smart-resize-trigger-container")){const a=Array.prototype.slice.call(arguments,2);return HTMLElement.prototype.removeChild.apply(b,a.concat(Array.prototype.slice.call(arguments)))}return a&&a instanceof Smart.SplitterItem?void(!b.contains(a)||1===b.items.length||a.closest("smart-splitter").removeChild(a)):void b.error(b.localize("invalidNode",{elementType:b.nodeName.toLowerCase(),method:"removeChild",node:"node"}))}get items(){const a=this;if(a.isReady)return a.querySelectorAll("smart-splitter-item")}getItem(a){const b=this;if(void 0===a||null===a)return;a=(a+"").split(".");let c,d=b.$.itemsContainer.items;for(let b=0;b<a.length&&(c=d[a[b]],!!c);b++){const a=c.querySelector("smart-splitter");if(!a){d=[];continue}d=a.items}return c}getItemIndex(a){const b=this;if(!a||!b.contains(a))return;if(a=a.closest("smart-splitter-item"),!a)return;let c=a.closest("smart-splitter"),d=[];for(;c&&(d.push(c.items.indexOf(a)),!!a.parentElement)&&(a=c.closest("smart-splitter-item"),!!a);)c=a.closest("smart-splitter");return d.reverse().join(".")}insert(a,b,c){const d=this;let e;return(("string"==typeof b||"number"==typeof b)&&(e=d.getItem(b+"")),!(e instanceof Smart.SplitterItem))?void d.error(d.localize("invalidIndex",{elementType:d.nodeName.toLowerCase(),method:"insert"})):void("object"==typeof a&&a.constructor===Object&&(a=d._createLayoutItem(a)),!(a instanceof Smart.SplitterItem)||d.contains(a)||(d._createNewItem(e,c,a),d.$.fireEvent("stateChange",{type:"insert",item:a})))}removeItem(a){const b=this;if(("string"==typeof a||"number"==typeof a)&&(a=b.getItem(a+"")),!(a instanceof Smart.SplitterItem)||!b.contains(a))return void b.error(b.localize("invalidIndex",{elementType:b.nodeName.toLowerCase(),method:"removeItem"}));let c=a.closest("smart-splitter");b._removeItem(c,a),b.$.fireEvent("stateChange",{type:"deleteItem",item:a})}removeAll(){const a=this;a._clearContent();const b=a.$.itemsContainer.items[0];b&&(b.innerHTML=a.placeholder)}updateItem(a,b){const c=this;if(("string"==typeof a||"number"==typeof a)&&(a=c.getItem(a+"")),!(a instanceof Smart.SplitterItem)||!c.contains(a))return void c.error(c.localize("invalidIndex",{elementType:c.nodeName.toLowerCase(),method:"updateItem"}));for(let d in b)switch(d){case"content":c._setLayoutItemContent(a,b);break;case"label":a._label=b[d];break;case"root":a._root=b[d];break;case"buttonPosition":a._buttonPosition=b[d];break;case"readonly":case"min":case"max":case"collapsible":case"size":case"locked":a[d]=b[d];break;case"orientation":{const c=a.closest("smart-splitter");c&&(c.orientation=b[d]);break}}}clearState(){const a=this;return a.id?void window.localStorage.removeItem("smartLayout"+a.id):void a.warn(a.localize("noId",{elementType:a.nodeName.toLowerCase()}))}loadState(a){const b=this;if(!a){if(!b.id)return void b.warn(b.localize("noId",{elementType:b.nodeName.toLowerCase()}));a=JSON.parse(window.localStorage.getItem("smartLayout"+b.id))}if(a){b.set("dataSource",[]);const c=b.context;b.context=document,b.dataSource=a,b.context=c}}saveState(){const a=this,b=JSON.stringify(a._getLayoutStruture());return a.id?window.localStorage.setItem("smartLayout"+a.id,b):a.warn(a.localize("noId",{elementType:a.nodeName.toLowerCase()})),JSON.parse(b)}select(a){const b=this;("string"==typeof a||"number"==typeof a)&&(a=b.getItem(a+""));a instanceof Smart.SplitterItem&&b.contains(a)&&b._handleItemSelection(a,!0)}unselect(){const a=this;a._handleItemSelection()}_applySplitterProperties(a){const b=this,c=b.querySelectorAll("smart-splitter");Array.isArray(a)||(a=[a]);for(let d=0;d<c.length;d++)for(let e=0;e<a.length;e++)c[d][a[e]]=b[a[e]]}_contextMenuHandler(a){const b=this;let c=a.target;if(c.closest){if(c.closest(".smart-layout-context-menu"))return void a.preventDefault();if(c.closest("smart-splitter-bar"))return;if(c=c.closest("smart-splitter-item"),!c||c.readonly)return;a.preventDefault(),b._createContextMenu();const d=b._contextMenu.children,e=b.querySelectorAll("smart-splitter-item");for(let a=0;a<d.length;a++){const f=d[a];"delete"===f.getAttribute("value")&&(c._root&&(!c.innerHTML||c.innerHTML===b.placeholder)||1===e.length&&c===e[0]&&c.innerHTML===b.placeholder?f.setAttribute("disabled",""):f.removeAttribute("disabled"))}b._openContextMenu(c,a.pageX,a.pageY)}}_createContextMenu(){const a=this;let b=a._contextMenu;if(b||(b=document.createElement("div"),b.classList.add("smart-layout-context-menu","smart-visibility-hidden"),a._contextMenu=b),!b.innerHTML){const c=a.contextMenuDataSource;for(let d=0;d<c.length;d++){const e=c[d];let f,g;"object"==typeof e?(f=e.label,g=e.value):g=f=e+"",b.innerHTML+=`<div class="smart-layout-context-menu-item" value="${g}">${a.localize(f)||f}</div>`}}}_openContextMenu(a,b,c){const d=this,e=d._contextMenu;if(e&&e.classList.contains("smart-visibility-hidden")){const f=d.$.fireEvent("opening");f.defaultPrevented||!a.parentElement||(e._target=a,d._opening=!0,d.$.container.appendChild(e),d._positionContextMenu(b,c),e.classList.remove("smart-visibility-hidden"),d.$.fireEvent("open"))}}_closeContextMenu(){const a=this,b=a._contextMenu;if(b&&!b.classList.contains("smart-visibility-hidden")){const c=a.$.fireEvent("closing");c.defaultPrevented||(delete a._opening,a.hasAnimation&&b.addEventListener("transitionend",a._contextMenuTransitionEndHandler.bind(a),{once:!0}),b.classList.add("smart-visibility-hidden"),a.$.fireEvent("close"))}}_contextMenuTransitionEndHandler(){const a=this,b=a._contextMenu;b&&!a._opening&&b.parentElement&&a.$.container.removeChild(b)}_clearContent(a){const b=this,c=b.$.itemsContainer,d=c.items,e=b.selectedIndex;for(let b=1;b<d.length;b++)c.removeChild(d[b]);d[0].clearContent(),d[0].innerHTML="",b.selectedIndex=null,a||b.$.fireEvent("change",{selectedIndex:b.selectedIndex,oldSelectedIndex:e})}_positionContextMenu(a,b){const c=this,d=c._contextMenu;if(d){const e=c.$.container.getBoundingClientRect();a-=e.left+window.pageXOffset,b-=e.top+window.pageYOffset,a+d.offsetWidth>e.width&&(a-=a+d.offsetWidth-e.width),b+d.offsetHeight>e.height&&(b-=b+d.offsetHeight-e.height),d.style.left=a+"px",d.style.top=b+"px"}}_documentDownHandler(a){const b=this,c=a.originalEvent.target;b.contains(c)&&c.closest&&(b._target=c)}_documentMoveHandler(a){const b=this,c=a.originalEvent.target,d=b._contextMenu;if(d&&!Smart.Utilities.Core.isMobile){if(d.querySelector(".smart-layout-context-menu-item[hover]")){const a=d.children;for(let b=0;b<a.length;b++)a[b].removeAttribute("hover")}d.contains(c)&&c.closest&&c.closest(".smart-layout-context-menu-item")&&c.setAttribute("hover","")}}_documentUpHandler(a){const b=this,c=a.originalEvent.target;if(b._target&&!b._target.closest("smart-splitter-bar")&&b._handleItemSelection(c),b._target){if(b._target!==c)return void delete b._target;!a.button&&c.closest(".smart-layout-buttons-container")?b._handleButtonClick(c):c.closest(".smart-layout-context-menu")&&!Smart.Utilities.Core.isMobile&&!a.button&&b._handleMenuItemClick(c.closest(".smart-layout-context-menu-item")),delete b._target}}_documentSelectStartHandler(a){const b=this;b._target&&a.preventDefault()}_dataBind(a){const b=this;if(!b.dataSource){a&&b._clearContent();const c=b.$.itemsContainer.items;if(1===c.length){const a=c[0];a.innerHTML&&"<content></content>"!==a.innerHTML||(a.innerHTML=b.placeholder)}return}"string"==typeof b.dataSource&&(b.dataSource=JSON.parse(b.dataSource)),null!==b.dataSource&&Array.isArray(b.dataSource)&&b._createItemsFromArray(b.dataSource)}_createItemsFromArray(a){const b=this,c=a.length;let d;b._clearContent(!0),b.$.itemsContainer.autoFitMode="overflow";for(let c=0;c<a.length;c++)d=b._createLayoutItem(a[c],0==c),d&&!d.parentElement&&b.$.itemsContainer.appendChild(d);b.$.itemsContainer.autoFitMode="proportional";const e=b.$.itemsContainer.items[0];e&&e.size&&e._setSize("size",e.size),c||(b.$.itemsContainer.items[0].placeholder=b.placeholder)}_createLayoutItem(a,b){if(!a)return;const c=this;let d;return d=b?c.$.itemsContainer.items[0]:document.createElement("smart-splitter-item"),c._setLayoutItemContent(d,a),c._setItemProperties(d,a),d}_setLayoutItemContent(a,b){const c=this;let d="object"==typeof b?b.content:b;if(Array.isArray(d)){const e=document.createElement("smart-splitter");c._applySplitterProperties(["liveResize","resizeStep","rightToLeft"]),e.orientation=b.orientation||c.orientation;const f=100/d.length+"%";for(let a=0;a<d.length;a++){const b=c._createLayoutItem(d[a]);b&&(!d[a].size&&(d[a].size=f),c._setItemProperties(b,d[a]),e.appendChild(b))}a.appendChild(e)}else if(d+="",/^[#.]{1}\w(\w|-)+$/gm.test(d)){const b=document.querySelectorAll(d);for(let c=0;c<b.length;c++){const d=b[c];a.appendChild(d instanceof HTMLTemplateElement?document.importNode(d.content,!0):d)}}else a.innerHTML=d||c.placeholder}_getDataSource(a){function b(a){return a.label?a:void(a.label="string"==typeof a.content?c.itemLabel:c.itemGroupLabel)}const c=this;if(Array.isArray(a))for(let d=0;d<a.length;d++)b(a[d]),Array.isArray(a[d].content)&&c._getDataSource(a[d].content);else b(a);return a}_getLayoutStruture(){function a(a,b){if(a){let c={};return a._label&&(c.label=a._label),a._root&&(c.root=a._root),a.content&&(c.content="string"==typeof a.content?a.content:a.content.textContent.trim()),a.readonly&&(c.readonly=a.readonly),a.min&&(c.min=a.min),a.max&&(c.max=a.max),c.size=a.size?a.size:a["offset"+("horizontal"===b.orientation?"Height":"Width")],a.locked&&(c.locked=a.locked),a.collapsible&&(c.collapsible=a.collapsible),a.collapsed&&(c.collapsed=a.collapsed),c}}const b=this;let c;if(c=arguments.length?arguments[0]:b.$.itemsContainer.items,c&&c.length){let d=[];for(let e=0;e<c.length;e++){const f=c[e],g=a(f,f.closest("smart-splitter")),h=f.querySelector("smart-splitter");if(h){const a=b._getLayoutStruture(h.items);a&&a.length&&(g.content=a),h.orientation!==b.orientation&&(g.orientation=h.orientation)}d.push(g)}return d}}_setItemProperties(a,b){a.readonly=b.readonly||!1,a.size=b.size||"",a.max=b.max||"",a.max=b.max||"",a.min=b.min||30,a.collapsible=b.collapsible||!1,a.locked=b.locked||!1,Array.isArray(b.buttonPosition)&&(a._buttonPosition=b.buttonPosition),"boolean"==typeof a._root&&(a._root=b.root),("string"==typeof a._label||"number"==typeof a._label)&&(a._label=b.label)}_handleItemSelection(a,b){const c=this,d=a?a.closest("smart-splitter-item"):void 0,e=c.selectedIndex;return d&&d.readonly?(c._closeContextMenu(),void(c.selectedIndex=null)):(c.querySelectorAll("smart-splitter-item").forEach(a=>a.removeAttribute("selected")),c._closeContextMenu(),d&&(b||c._target)?void((b||c._target.closest("smart-splitter-item")===d)&&(c._handleButtonsVisibility(d),d.setAttribute("selected",""),c.selectedIndex=c.getItemIndex(d)),e!==c.selectedIndex&&c.$.fireEvent("change",{selectedIndex:c.selectedIndex,oldSelectedIndex:e})):(c._handleButtonsVisibility(),void(c.selectedIndex=null)))}_handleButtonClick(a){const b=this,c=b._createNewItem(a.closest("smart-splitter-item"),a.getAttribute("position"));b._handleItemSelection(c,!0),b.$.fireEvent("stateChange",{type:"insert",item:c})}_handleMenuItemClick(a){const b=this;if(a&&!a.hasAttribute("disabled")){const c=a.getAttribute("value"),d=b._contextMenu;if(b.$.fireEvent("menuItemClick",{target:d?d._target:null,item:a,label:a.textContent,value:c}),"delete"===c){const a=d._target;if(!a)return;const e=a.closest("smart-splitter");delete d._target,b._removeItem(e,a),b.$.fireEvent("stateChange",{type:c,item:a})}}}_createNewItem(a,b,c){var d=Math.max;const e=this,f=document;if(!a)return;c||(c=f.createElement("smart-splitter-item"));const g=a.closest("smart-splitter");let h;if(c.innerHTML||(c.innerHTML=e.placeholder),c.min||(c.min=30),a.min=30,"vertical"===g.orientation&&("left"===b||"right"===b)||"horizontal"===g.orientation&&("top"===b||"bottom"===b)){h=g;const e=h.items,f=d(0,e.indexOf(a)+("top"===b||"left"===b?0:1)),i=a["offset"+("horizontal"===h.orientation?"Height":"Width")]/2;c.size||(c.size=i),h.insertBefore(c,e[f]),a.size=i}else{if(h=a.querySelector("smart-splitter")||f.createElement("smart-splitter"),("top"===b||"bottom"===b)&&(h.orientation="horizontal"),h.parentElement){const e=h.items,f=d(0,e.indexOf(a)+("top"===b||"left"===b?0:1));return h.insertBefore(c,e[f]),c}const g=f.createElement("smart-splitter-item"),i=a.content;if(e._setItemProperties(g,a),g.min=30,g.size="50%",c.size||(c.size="50%"),"string"==typeof i)g.innerHTML=i,a.innerHTML="";else for(;i.firstChild;)g.appendChild(i.firstChild);"bottom"===b||"right"===b?(h.appendChild(g),h.appendChild(c)):(h.appendChild(c),h.appendChild(g)),a.appendChild(h)}return c}_removeItem(a,b){const c=this;if(a===c.$.itemsContainer){const b=a.items;if(1===b.length)return b[0].innerHTML=c.placeholder,b[0].size="",void a.refresh()}else if(b._root)return b.innerHTML=c.placeholder,void a.refresh();a.removeChild(b);const d=a.items;if(1===d.length){const b=a.closest("smart-splitter-item");if(!b)return;b.removeChild(a);const e=d[0];if("string"==typeof e.content)b.innerHTML=e.content;else for(;e.content.firstChild;)b.appendChild(e.content.firstChild);e.size=b.size,c._setItemProperties(b,e),b.collapsed=!1,b.closest("smart-splitter").refresh()}}_handleButtonsVisibility(a){const b=this;if(b._buttons||(b._buttons=document.createElement("div"),b._buttons.classList.add("smart-layout-buttons-container"),b._buttons.innerHTML=`<div role="button" position="top"></div>
                                       <div role="button" position="bottom"></div>
                                       <div role="button" position="left"></div>
                                       <div role="button" position="right"></div>`),!a&&b._buttons.parentElement)return void b._buttons.parentElement.removeChild(b._buttons);if(a&&a!==b._buttons.closest("smart-splitter-item")){const c=a._buttonPosition||[],d=b._buttons.children;for(let a=0;a<d.length;a++){const b=d[a];c.length&&0>c.indexOf(b.getAttribute("position"))?b.classList.add("smart-hidden"):b.classList.remove("smart-hidden")}a.appendChild(b._buttons)}}});