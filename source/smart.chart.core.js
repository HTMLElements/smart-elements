
/* Smart HTML Elements v3.2.0 (2019-June) 
Copyright (c) 2011-2019 jQWidgets. 
License: https://htmlelements.com/license/ */

Smart("smart-chart",class extends Smart.BaseElement{static get properties(){return{animationDuration:{value:300,type:"number"},backgroundColor:{value:null,type:"string?"},backgroundImage:{value:"",type:"string"},borderLineColor:{value:null,type:"string?"},borderLineWidth:{value:1,type:"number"},caption:{value:"Caption",type:"string"},clip:{value:!0,type:"boolean"},colorScheme:{value:"scheme01",type:"string"},columnSeriesOverlap:{value:!1,type:"boolean"},crosshairsColor:{value:null,type:"string?"},crosshairsDashStyle:{value:"2,2",type:"string"},crosshairsLineWidth:{value:1,type:"number"},dataSource:{value:[],type:"object",reflectToAttribute:!1},description:{value:"Description",type:"string"},draw:{value:null,type:"function?"},drawBefore:{value:null,type:"function?"},enableAxisTextAnimation:{value:!1,type:"boolean"},enableCrosshairs:{value:!1,type:"boolean"},greyScale:{value:!1,type:"boolean"},legendLayout:{value:{flow:{value:"horizontal",allowedValues:["horizontal","vertical"],type:"string"},height:{value:null,type:"number?"},left:{value:null,type:"number?"},top:{value:null,type:"number?"},width:{value:null,type:"number?"}},type:"object?"},localization:{value:{decimalSeparator:{value:".",type:"string"},patterns:{value:null,type:"object?"},thousandsSeparator:{value:"",type:"string"}},type:"object"},messages:{value:{en:{invalidRadiusDataField:"smart-chart: Invalid radiusDataField value at [{{index}}]",invalidSeries:"smart-chart: Invalid property: each series group must have a 'series' property which must be a valid array.",invalidSeriesGroups:"smart-chart: Invalid property: 'seriesGroups' property is required and must be a valid array.",invalidType:"smart-chart: Invalid serie type \"{{type}}\".",missingAxis:"smart-chart: seriesGroup[{{index}}] is missing {{axis}} definition.",missingReference:"smart-chart: Missing reference to {{files}}.",missingType:"smart-chart: Invalid property: each series group must have a valid 'type' property."}},type:"object",extend:!0},padding:{value:{bottom:{value:5,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},renderEngine:{value:"",allowedValues:["","SVG","HTML5"],type:"string"},rightToLeft:{value:!1,type:"boolean"},seriesGroups:{value:[],type:"any"},showBorderLine:{value:!0,type:"boolean"},showLegend:{value:!0,type:"boolean"},showToolTips:{value:!0,type:"boolean"},showToolTipsOnAllSeries:{value:!1,type:"boolean"},theme:{value:"light",allowedValues:["light","dark"],type:"string"},titlePadding:{value:{bottom:{value:10,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},toolTipBackground:{value:null,type:"string?"},toolTipFormatFunction:{value:null,type:"function?"},toolTipHideDelay:{value:4e3,type:"number"},toolTipLineColor:{value:null,type:"string?"},toolTipShowDelay:{value:300,type:"number"},valueAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baselineValue:{value:0,type:"any"},customDraw:{value:!1,type:"boolean"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:void 0,type:"any"},minValue:{value:void 0,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"left",allowedValues:["left","right","top","bottom"],type:"string"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!0,type:"boolean"}},type:"object"},xAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baseUnit:{value:null,allowedValues:["year","month","day","hour","minute","second","millisecond"],type:"string?"},customDraw:{value:!1,type:"boolean"},dataField:{value:"",type:"string"},dateFormat:{value:null,type:"string?"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:void 0,type:"any"},minValue:{value:void 0,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"bottom",allowedValues:["bottom","top","left","right"],type:"string"},rangeSelector:{value:{backgroundColor:{value:null,type:"string?"},backgroundImage:{value:"",type:"string"},baseUnit:{value:null,allowedValues:["year","month","day","hour","minute","second","millisecond"],type:"string?"},borderLineColor:{value:null,type:"string?"},borderLineWidth:{value:null,type:"number?"},caption:{value:"",type:"string"},colorScheme:{value:null,type:"string?"},columnSeriesOverlap:{value:!1,type:"boolean"},columnsGapPercent:{value:25,type:"number"},dataField:{value:null,type:"string?"},description:{value:"",type:"string"},greyScale:{value:null,type:"boolean?"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},maxValue:{value:void 0,type:"any"},minValue:{value:void 0,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:null,allowedValues:["bottom","top","left","right"],type:"string?"},renderTo:{value:null,type:"any"},rightToLeft:{value:null,type:"boolean?"},seriesGapPercent:{value:10,type:"number"},seriesGroups:{value:null,type:"array?"},serieType:{value:"area",type:"string"},showBorderLine:{value:null,type:"boolean?"},size:{value:null,type:"number?"},skipOverlappingPoints:{value:!0,type:"boolean"},titlePadding:{value:{bottom:{value:10,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},unitInterval:{value:null,type:"number?"},valueAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baselineValue:{value:0,type:"any"},customDraw:{value:!1,type:"boolean"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:void 0,type:"any"},minValue:{value:void 0,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"left",allowedValues:["left","right","top","bottom"],type:"string"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!1,type:"boolean"}},type:"object"},visible:{value:!1,type:"boolean"}},type:"object"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},toolTipFormatFunction:{value:null,type:"function?"},toolTipFormatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},type:{value:"auto",allowedValues:["auto","date","basic","linear"],type:"string"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!0,type:"boolean"}},type:"object"}}}get _legendLayout(){const e=this.legendLayout;return null!==e.height||null!==e.left||null!==e.top||null!==e.width||"vertical"===e.flow}_getFormatSettings(e,t){if(!e)return null;const i=e[t?t:"formatSettings"];return i?i.dateFormat||null!==i.decimalPlaces||i.decimalSeparator||i.negativeWithBrackets||i.prefix||i.sufix||i.thousandsSeparator?i:null:null}static get listeners(){return{click:"_clickHandler",down:"_downMoveHandler",mouseleave:"_mouseleaveHandler",move:"_moveHandler",resize:"_resizeHandler","document.move":"_downMoveHandler","document.up":"_documentUpHandler"}}static get requires(){return{"Smart.Utilities.Draw":"smart.draw.js"}}template(){return"<div></div>"}ready(){super.ready();const e=this;e._observeSeriesGroups(),e._isTouchDevice=Smart.Utilities.Core.isMobile,e._setDefaults(),e._createColorsCache(),e.refresh()}_observeSeriesGroups(){function e(e){t.context!==t&&e.newValue!==e.oldValue&&t.update()}const t=this;t._validateSeriesGroups(),t.seriesGroups=new Smart.ObservableArray(t.seriesGroups),t.seriesGroups.canNotify=!0;for(let r=0;r<t.seriesGroups.length;r++)t.seriesGroups[r].series=new Smart.ObservableArray(t.seriesGroups[r].series),t.seriesGroups[r].series.canNotify=!0,t.seriesGroups[r].series.notify(e);t.seriesGroups.notify(e)}_downMoveHandler(e){const t=this,i=e.originalEvent.target.closest(".smart-chart-range-selector");if(i){const r=i.firstElementChild,n=r.parentChart;t!==r&&t!==n||n["_onSliderMouse"+e.type.slice(0,1).toUpperCase()+e.type.slice(1)](e)}}_documentUpHandler(e){const t=this;t._draggingRangeSelector&&t._onSliderMouseUp(e)}_setDefaults(){const e=this;e.axisPadding=5,e.enableEvents=!0,e.enableSampling=!0,e._itemsToggleState=[],e._isToggleRefresh=!1,e._isSelectorRefresh=!1,e._sliders=[],e._selectorRange=[],e._rangeSelectorInstances={},e._resizeState={},e._isRangeSelectorInstance=e._isRangeSelectorInstance||!1,e._renderData={},e._smartPlot=null,e._animTickInt=50,e._seriesTypes=["line","stackedline","stackedline100","spline","stackedspline","stackedspline100","stepline","stackedstepline","stackedstepline100","area","stackedarea","stackedarea100","splinearea","stackedsplinearea","stackedsplinearea100","steparea","stackedsteparea","stackedsteparea100","rangearea","splinerangearea","steprangearea","column","stackedcolumn","stackedcolumn100","rangecolumn","scatter","stackedscatter","stackedscatter100","bubble","stackedbubble","stackedbubble100","pie","donut","candlestick","ohlc","waterfall","stackedwaterfall"],e.colorSchemes=[{name:"scheme01",colors:["#307DD7","#AA4643","#89A54E","#71588F","#4198AF"]},{name:"scheme02",colors:["#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8"]},{name:"scheme03",colors:["#E8601A","#FF9639","#F5BD6A","#599994","#115D6E"]},{name:"scheme04",colors:["#D02841","#FF7C41","#FFC051","#5B5F4D","#364651"]},{name:"scheme05",colors:["#25A0DA","#309B46","#8EBC00","#FF7515","#FFAE00"]},{name:"scheme06",colors:["#0A3A4A","#196674","#33A6B2","#9AC836","#D0E64B"]},{name:"scheme07",colors:["#CC6B32","#FFAB48","#FFE7AD","#A7C9AE","#888A63"]},{name:"scheme08",colors:["#3F3943","#01A2A6","#29D9C2","#BDF271","#FFFFA6"]},{name:"scheme09",colors:["#1B2B32","#37646F","#A3ABAF","#E1E7E8","#B22E2F"]},{name:"scheme10",colors:["#5A4B53","#9C3C58","#DE2B5B","#D86A41","#D2A825"]},{name:"scheme11",colors:["#993144","#FFA257","#CCA56A","#ADA072","#949681"]},{name:"scheme12",colors:["#105B63","#EEEAC5","#FFD34E","#DB9E36","#BD4932"]},{name:"scheme13",colors:["#BBEBBC","#F0EE94","#F5C465","#FA7642","#FF1E54"]},{name:"scheme14",colors:["#60573E","#F2EEAC","#BFA575","#A63841","#BFB8A3"]},{name:"scheme15",colors:["#444546","#FFBB6E","#F28D00","#D94F00","#7F203B"]},{name:"scheme16",colors:["#583C39","#674E49","#948658","#F0E99A","#564E49"]},{name:"scheme17",colors:["#142D58","#447F6E","#E1B65B","#C8782A","#9E3E17"]},{name:"scheme18",colors:["#4D2B1F","#635D61","#7992A2","#97BFD5","#BFDCF5"]},{name:"scheme19",colors:["#844341","#D5CC92","#BBA146","#897B26","#55591C"]},{name:"scheme20",colors:["#56626B","#6C9380","#C0CA55","#F07C6C","#AD5472"]},{name:"scheme21",colors:["#96003A","#FF7347","#FFBC7B","#FF4154","#642223"]},{name:"scheme22",colors:["#5D7359","#E0D697","#D6AA5C","#8C5430","#661C0E"]},{name:"scheme23",colors:["#16193B","#35478C","#4E7AC7","#7FB2F0","#ADD5F7"]},{name:"scheme24",colors:["#7B1A25","#BF5322","#9DA860","#CEA457","#B67818"]},{name:"scheme25",colors:["#0081DA","#3AAFFF","#99C900","#FFEB3D","#309B46"]},{name:"scheme26",colors:["#0069A5","#0098EE","#7BD2F6","#FFB800","#FF6800"]},{name:"scheme27",colors:["#FF6800","#A0A700","#FF8D00","#678900","#0069A5"]},{name:"scheme28",colors:["#3A43BA","#281E5D","#48AAAD","#0492C2","#1E456E","#59788D","#52B2C0","#82EDFD"]},{name:"scheme29",colors:["#003F5C","#58508D","#BC5090","#FF6361","#FFA600"]},{name:"scheme30",colors:["#16736F","#A2D56A","#1C515C","#62B773","#EEEF63","#1F313F","#309577"]},{name:"scheme31",colors:["#74CC66","#191A4D","#2D867A","#EEE3CD","#224D19","#0D261B","#5771C7","#B6D7E7","#206052","#6B5724","#C3AF4B","#603620","#536722","#B6E7B9","#34819D","#94ACDB"]},{name:"scheme32",colors:["#87C5FF","#5B5B60","#9BE076","#F7A384","#7479D3","#F13A80","#E4D388","#2BC6B2","#F45B14"]}]}_clickHandler(e){const t=this;if(!(t.disabled||t._isRangeSelectorInstance)){var i=e.pageX||e.clientX||e.screenX,r=e.pageY||e.clientY||e.screenY;const n=t.getBoundingClientRect();t._isTouchDevice&&(i=e.pageX,r=e.pageY),i-=n.left,r-=n.top,t._mouseX=i,t._mouseY=r,!isNaN(t._lastClickTs)&&100>new Date().valueOf()-t._lastClickTs||(this._hostClickTimer=setTimeout(function(){if(t._isTouchDevice||(t._cancelTooltipTimer(),t._hideToolTip(),t._unselect()),t._pointMarker&&t._pointMarker.element){var i=t.seriesGroups[t._pointMarker.gidx],r=i.series[t._pointMarker.sidx];e.stopImmediatePropagation(),t._raiseItemEvent("click",i,r,t._pointMarker.iidx)}},100),"HTML5"===t.renderEngine&&t._canvasClickHandler(i,r))}}_canvasClickHandler(e,t){const i=this,r=i.renderer._elements;let n;for(let i in r)if(r.hasOwnProperty(i)&&"0"!=i){const s=r[i];if(t>s.y&&t<s.y+s.height&&e>s.x&&e<s.x+s.width){n=s;break}}if(n&&n.purpose&&"legend-toggle"===n.purpose){const e=n.data;i._toggleSerie(e.groupIndex,e.seriesIndex,e.itemIndex)}}_mouseleaveHandler(){const e=this;if(!(e.disabled||e._isRangeSelectorInstance)){var t=e._mouseX,i=e._mouseY,r=e._plotRect;r&&t>=r.x&&t<=r.x+r.width&&i>=r.y&&i<=r.y+r.height||(e._cancelTooltipTimer(),e._hideToolTip(0),e._unselect())}}_moveHandler(e){const t=this;if(!t.disabled){if("touchmove"===e.originalEvent.type&&e.originalEvent.preventDefault(),t._isRangeSelectorInstance){const e=t.parentChart;null===e.xAxis.rangeSelector.renderTo&&(e._unselect(),e._hideToolTip())}else t.style.cursor="default";var i=e.pageX||e.clientX||e.screenX,r=e.pageY||e.clientY||e.screenY;const n=t.getBoundingClientRect();t._isTouchDevice&&(i=e.pageX,r=e.pageY),i-=n.left,r-=n.top,t.onmousemove(i,r)}}_resizeHandler(){const e=this,t=e.animation;e._isRangeSelectorInstance||(e.animation="none",e.refresh(),e.animation=t)}propertyChangedHandler(e,t,i){const r=this;switch(e){case"animation":case"theme":r._ttEl&&r._ttEl.box.setAttribute(e,i);break;case"seriesGroups":r._observeSeriesGroups();break;case"xAxis_rangeSelector_renderTo":if(null===i){const e=t.getElementsByClassName("smart-chart-range-selector")[0];e.parentElement.removeChild(e)}}this.refresh()}_initRenderer(){const e=this;e._draw=new Smart.Utilities.Draw(e.$.content,e.renderEngine),e.renderer=e._draw.renderer,e._smartPlot||(e._smartPlot=new Smart.Utilities.Plot(e.renderer))}_internalRefresh(){var e=this;if(e.offsetWidth||e.offsetHeight||e.getClientRects().length){e._stopAnimations(),e.renderer&&(e._isToggleRefresh||e._isUpdate)||(e._hideToolTip(0),e.$.content.innerHTML="",e._initRenderer());var t=e.renderer;if(t){var i=t.getRect();e._render({x:1,y:1,width:i.width,height:i.height}),this.$.fireEvent("refreshBegin",{instance:this}),t instanceof Smart.Utilities.HTML5Renderer&&t.refresh(),e._isUpdate=!1,this.$.fireEvent("refreshEnd",{instance:this})}}}saveAsPNG(e){return this._saveAsImage("png",e)}saveAsJPEG(e){return this._saveAsImage("jpeg",e)}saveAsPDF(e,t){return this._saveAsImage("pdf",e,t)}print(){return this._saveAsImage("print")}_saveAsImage(e,t,i){const r=this;return r._draw._widgetToImage(r,e,t,r._hasRangeSelector?r._selectorSaveAsImageCallback:void 0,i)}_selectorSaveAsImageCallback(e,t){var r=e;for(let b=0;b<r.seriesGroups.length;b++){var n=r._getXAxis(b);if(!n||!n.rangeSelector||!n.rangeSelector.visible||n.rangeSelector.renderTo)continue;var s=r._rangeSelectorInstances[b];if(!s)continue;var a=s.renderer.getRect(),l=s.renderer.getContainer().getElementsByTagName("canvas")[0],o=l.getContext("2d"),d=r._sliders[b],g="horizontal"===r.seriesGroups[b].orientation,u=g?"height":"width",p=g?"width":"height",h=g?"y":"x",y=g?"x":"y",m={};m[h]=d.startOffset+d.rect[h],m[y]=d.rect[y],m[u]=d.endOffset-d.startOffset,m[p]=d.rect[p];var c=n.rangeSelector.colorSelectedRange||"blue",f=n.rangeSelector.colorRangeLine||"grey",x=[];x.push(s.renderer.rect(m.x,m.y,m.width,m.height,{fill:c,opacity:.1}));const e=r.renderer;g?(x.push(s.renderer.line(e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(d.rect.y),e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(m.y),{stroke:f,opacity:.5})),x.push(s.renderer.line(e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(m.y+m.height),e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(d.rect.y+d.rect.height),{stroke:f,opacity:.5})),x.push(s.renderer.line(e._ptrnd(d.rect.x),e._ptrnd(m.y),e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(m.y),{stroke:f,opacity:.5})),x.push(s.renderer.line(e._ptrnd(d.rect.x),e._ptrnd(m.y+m.height),e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(m.y+m.height),{stroke:f,opacity:.5}))):(x.push(s.renderer.line(e._ptrnd(d.rect.x),e._ptrnd(d.rect.y),e._ptrnd(m.x),e._ptrnd(d.rect.y),{stroke:f,opacity:.5})),x.push(s.renderer.line(e._ptrnd(m.x+m.width),e._ptrnd(d.rect.y),e._ptrnd(d.rect.x+d.rect.width),e._ptrnd(d.rect.y),{stroke:f,opacity:.5})),x.push(s.renderer.line(e._ptrnd(m.x),e._ptrnd(d.rect.y),e._ptrnd(m.x),e._ptrnd(d.rect.y+d.rect.height),{stroke:f,opacity:.5})),x.push(s.renderer.line(e._ptrnd(m.x+m.width),e._ptrnd(d.rect.y),e._ptrnd(m.x+m.width),e._ptrnd(d.rect.y+d.rect.height),{stroke:f,opacity:.5}))),s.renderer.refresh();var _=o.getImageData(a.x,a.y,a.width,a.height);const i=t.getContext("2d"),v=r.getBoundingClientRect(),A=s.getBoundingClientRect();i.putImageData(_,A.left-v.left,A.top-v.top,1,1,a.width,a.height);for(let e=0;e<x.length;e++)s.renderer.removeElement(x[e]);s.renderer.refresh()}return!0}refresh(){this._internalRefresh()}update(){this._isUpdate=!0,this._internalRefresh()}clear(){var e=this;e.caption="",e.description="",e.refresh()}_validateSeriesGroups(){const e=this;Array.isArray(this.seriesGroups)||e.seriesGroups instanceof Smart.ObservableArray||e.error(e.localize("invalidSeriesGroups"));for(let r=0;r<this.seriesGroups.length;r++){var t=this.seriesGroups[r];t.type||e.error(e.localize("missingType")),Array.isArray(t.series)||t.series instanceof Smart.ObservableArray||e.error(e.localize("invalidSeries"))}}_render(e){var t=Math.max,r=this,n=r.renderer;r._colorsCache.clear(),!r._isToggleRefresh&&r._isUpdate&&r._renderData&&r._renderDataClone(),r._renderData=[],n.clear(),r._unselect(),r._hideToolTip(0);var i=r.backgroundImage;r.style.backgroundImage=void 0===i||null===i||""===i?"":-1===i.indexOf("(")?"url(\""+i+"\")":i,r._rect=e;var s=r.padding||{left:5,top:5,right:5,bottom:5},a=n.createClipRect(e),l=n.beginGroup();n.setClip(l,a);var o=n.rect(e.x,e.y,e.width-2,e.height-2);if(void 0===i||null===i||""===i?n.attr(o,{fill:r.backgroundColor||r._getThemeColor("background")}):n.attr(o,{fill:"transparent"}),!1!==r.showBorderLine){var d=this.borderLineWidth;(isNaN(d)||0>d||10<d)&&(d=1),n.attr(o,{"stroke-width":d,stroke:r.borderLineColor||r._getThemeColor("line")})}"function"==typeof r.drawBefore&&r.drawBefore(n,e);var g={x:s.left,y:s.top,width:e.width-s.left-s.right,height:e.height-s.top-s.bottom};r._paddedRect=g;var u=r.titlePadding||{left:2,top:2,right:2,bottom:2},p;r.caption&&0<r.caption.length&&(p=n.measureText(r.caption,0,{class:"smart-chart-title-text"}),n.text(r.caption,g.x+u.left,g.y+u.top,g.width-(u.left+u.right),p.height,0,{class:"smart-chart-title-text"},!0,"center","center"),g.y+=p.height,g.height-=p.height),r.description&&0<r.description.length&&(p=n.measureText(r.description,0,{class:"smart-chart-title-description"}),n.text(r.description,g.x+u.left,g.y+u.top,g.width-(u.left+u.right),p.height,0,{class:"smart-chart-title-description"},!0,"center","center"),g.y+=p.height,g.height-=p.height),(r.caption||r.description)&&(g.y+=u.bottom+u.top,g.height-=u.bottom+u.top);var m={x:g.x,y:g.y,width:g.width,height:g.height};r._plotRect=m,r._buildStats(m);var h=r._isPieOnlySeries(),c=r.seriesGroups,f={xAxis:{},valueAxis:{}},_;for(let t=0;t<c.length&&!h;t++){if("pie"===c[t].type||"donut"===c[t].type)continue;var b=r._getXAxis(t);b||r.error(r.localize("missingAxis",{index:t,axis:"xAxis"}));let e=b===r._getXAxis()?-1:t;f.xAxis[e]=0}var v=r.axisPadding;isNaN(v)&&(v=5);var A={left:0,right:0,leftCount:0,rightCount:0},S=[];for(let t=0;t<c.length;t++){const e=c[t];if("pie"===e.type||"donut"===e.type||!0===e.spider||!0===e.polar){S.push({width:0,position:0,xRel:0});continue}_="horizontal"===e.orientation;var b=r._getXAxis(t);let i=b===r._getXAxis()?-1:t;var C=r._getValueAxis(t),k=C===r._getValueAxis()?-1:t,I=_?b.axisSize:C.axisSize,M={x:0,y:m.y,width:m.width,height:m.height},F=_?r._getXAxis(t).position:C.position;I&&"auto"!==I||(_?(I=this._renderXAxis(t,M,!0,m).width,1==(1&f.xAxis[i])?I=0:0<I&&(f.xAxis[i]|=1)):(I=r._renderValueAxis(t,M,!0,m).width,1==(1&f.valueAxis[k])?I=0:0<I&&(f.valueAxis[k]|=1))),"left"!==F&&!0===r.rightToLeft&&(F="right"),"right"!==F&&(F="left"),0<A[F+"Count"]&&0<A[F]&&0<I&&(A[F]+=v),S.push({width:I,position:F,xRel:A[F]}),A[F]+=I,A[F+"Count"]++}var D=t(1,t(e.width,e.height)),T={top:0,bottom:0,topCount:0,bottomCount:0},O=[];for(let t=0;t<c.length;t++){const e=c[t];if("pie"===e.type||"donut"===e.type||!0===e.spider||!0===e.polar){O.push({height:0,position:0,yRel:0});continue}_="horizontal"===e.orientation;var C=this._getValueAxis(t),k=C===r._getValueAxis()?-1:t,b=r._getXAxis(t);let i=b===r._getXAxis()?-1:t,n=_?C.axisSize:b.axisSize;var F=_?C.position:b.position;n&&"auto"!==n||(_?(n=r._renderValueAxis(t,{x:0,y:0,width:D,height:0},!0,m).height,2==(2&f.valueAxis[k])?n=0:0<n&&(f.valueAxis[k]|=2)):(n=r._renderXAxis(t,{x:0,y:0,width:D,height:0},!0).height,2==(2&f.xAxis[i])?n=0:0<n&&(f.xAxis[i]|=2))),"top"!==F&&(F="bottom"),0<T[F+"Count"]&&0<T[F]&&0<n&&(T[F]+=v),O.push({height:n,position:F,yRel:T[F]}),T[F]+=n,T[F+"Count"]++}r._createAnimationGroup("series");const R=!1!==r.showLegend,L=r._legendLayout;var P=R?r._renderLegend(L?r._rect:g,!0):{width:0,height:0};if(!L||isNaN(this.legendLayout.left)&&isNaN(this.legendLayout.top)||(P={width:0,height:0}),g.height<T.top+T.bottom+P.height||g.width<A.left+A.right)return void n.endGroup();m.height-=T.top+T.bottom+P.height,m.x+=A.left,m.width-=A.left+A.right,m.y+=T.top;var G=[];if(!h)for(let e=0;e<c.length;e++){const t=c[e];if(!0===t.polar||!0===t.spider||"pie"===t.type||"donut"===t.type)continue;_="horizontal"===t.orientation;var V=r._getXAxis(e)===r._getXAxis()?-1:e,k=r._getValueAxis(e)===r._getValueAxis()?-1:e;let i={x:m.x,y:0,width:m.width,height:O[e].height};if(i.y="top"===O[e].position?m.y-O[e].yRel-O[e].height:m.y+m.height+O[e].yRel,_){if(4==(4&f.valueAxis[k]))continue;if(!r._isGroupVisible(e))continue;r._renderValueAxis(e,i,!1,m),f.valueAxis[k]|=4}else{if(G.push(i),4==(4&f.xAxis[V]))continue;if(!r._isGroupVisible(e))continue;r._renderXAxis(e,i,!1,m),f.xAxis[V]|=4}}if(R){const e=r._legendLayout,t=e?r._rect:g;var E=g.x+this.renderer._ptrnd((g.width-P.width)/2),B=m.y+m.height+T.bottom,I=g.width;let i=P.height;e&&(!isNaN(r.legendLayout.left)&&(E=r.legendLayout.left),!isNaN(r.legendLayout.top)&&(B=r.legendLayout.top),!isNaN(r.legendLayout.width)&&(I=r.legendLayout.width),!isNaN(r.legendLayout.height)&&(i=r.legendLayout.height)),E+I>t.x+t.width&&(I=t.x+t.width-E),B+i>t.y+t.height&&(i=t.y+t.height-B),r._renderLegend({x:E,y:B,width:I,height:i})}if(r._hasHorizontalLines=!1,!h)for(let e=0;e<c.length;e++){const t=c[e];if(!0===t.polar||!0===t.spider||"pie"===t.type||"donut"===t.type)continue;_="horizontal"===c[e].orientation;let i={x:m.x-S[e].xRel-S[e].width,y:m.y,width:S[e].width,height:m.height};"left"!==S[e].position&&(i.x=m.x+m.width+S[e].xRel);var V=r._getXAxis(e)===r._getXAxis()?-1:e,k=r._getValueAxis(e)===r._getValueAxis()?-1:e;if(_){if(G.push(i),8==(8&f.xAxis[V]))continue;if(!r._isGroupVisible(e))continue;r._renderXAxis(e,i,!1,m),f.xAxis[V]|=8}else{if(8==(8&f.valueAxis[k]))continue;if(!r._isGroupVisible(e))continue;r._renderValueAxis(e,i,!1,m),f.valueAxis[k]|=8}}if(!(0>=m.width||0>=m.height)){r._plotRect={x:m.x,y:m.y,width:m.width,height:m.height};for(let e=0;e<c.length;e++)this._drawPlotAreaLines(e,!0,{gridLines:!1,tickMarks:!1,alternatingBackground:!0}),this._drawPlotAreaLines(e,!1,{gridLines:!1,tickMarks:!1,alternatingBackground:!0});for(let e=0;e<c.length;e++)this._drawPlotAreaLines(e,!0,{gridLines:!0,tickMarks:!0,alternatingBackground:!1}),this._drawPlotAreaLines(e,!1,{gridLines:!0,tickMarks:!0,alternatingBackground:!1});var H=!1;for(let e=0;e<c.length&&!H;e++){const t=c[e];if(void 0!==t.annotations||"function"==typeof t.draw||"function"==typeof t.drawBefore){H=!0;break}}var j=n.beginGroup();if(r.clip&&!H){var z=n.createClipRect({x:m.x-2,y:m.y,width:m.width+4,height:m.height});n.setClip(j,z)}for(let t=0;t<c.length;t++){const i=c[t];var W=!1;for(var X in r._seriesTypes)if(r._seriesTypes[X]===i.type){W=!0;break}W||r.error(r.localize("invalidType",{type:i.type})),"function"==typeof i.drawBefore&&i.drawBefore(n,e,t,this),(!0===i.polar||!0===i.spider)&&-1===i.type.indexOf("pie")&&-1===i.type.indexOf("donut")&&r._renderSpiderAxis(t,m),r._renderAxisBands(t,m,!0),r._renderAxisBands(t,m,!1)}for(let t=0;t<c.length;t++){const i=c[t];if(r._isColumnType(i.type)?r._renderColumnSeries(t,m):-1!==i.type.indexOf("pie")||-1!==i.type.indexOf("donut")?r._renderPieSeries(t,m):-1!==i.type.indexOf("line")||-1!==i.type.indexOf("area")?r._renderLineSeries(t,m):-1!==i.type.indexOf("scatter")||-1!==i.type.indexOf("bubble")?r._renderScatterSeries(t,m):(-1!==i.type.indexOf("candlestick")||-1!==i.type.indexOf("ohlc"))&&r._renderCandleStickSeries(t,m,-1!==i.type.indexOf("ohlc")),i.annotations){this._moduleAnnotations||r.error(r.localize("missingReference",{files:"smartchart.annotations.js"}));for(let e=0;e<i.annotations.length;e++)r._renderAnnotation(t,i.annotations[e],m)}"function"==typeof i.draw&&i.draw(n,e,t,this)}if(n.endGroup(),r.disabled){var N=n.rect(e.x,e.y,e.width,e.height);n.attr(N,{fill:"#777777",opacity:.5,stroke:"#00FFFFFF"})}"function"==typeof r.draw&&r.draw(n,e),n.endGroup(),r._startAnimation("series"),r._credits&&r._credits();var U=!1;for(let e=0;e<r.seriesGroups.length&&!U;e++){var b=r._getXAxis(e);b&&b.rangeSelector&&b.rangeSelector.visible&&(U=!0,r._hasRangeSelector=!0)}if(U){this._moduleRangeSelector||r.error(r.localize("missingReference",{files:"smartchart.rangeselector.js"}));var Y=[];r._isSelectorRefresh||(r._rangeSelectorInstances={});for(let e=0;e<r.seriesGroups.length;e++){var Z=this._getXAxis(e);-1===Y.indexOf(Z)&&this._renderXAxisRangeSelector(e,G[e])&&Y.push(Z)}}}}_credits(){}_isPieOnlySeries(){var e=this.seriesGroups;if(0===e.length)return!1;for(let t=0;t<e.length;t++)if("pie"!==e[t].type&&"donut"!==e[t].type)return!1;return!0}_renderChartLegend(e,t,n,s){var a=this,l=a.renderer,o={x:t.x,y:t.y,width:t.width,height:t.height},i=3;o.width>=2*i&&(o.x+=i,o.width-=2*i),o.height>=2*i&&(o.y+=i,o.height-=2*i);var r={width:o.width,height:0},d=0,u=0,p=20,h=0,m=10,c=10,f=0;for(let y=0;y<e.length;y++){var _=e[y].css;_||(_="smart-chart-legend-text"),p=20;var b=e[y].text,v=l.measureText(b,0,{class:_});v.height>p&&(p=v.height),v.width>f&&(f=v.width),s?(0!=y&&(u+=p),u>o.height&&(u=0,d+=f+2*c+m,f=v.width,r.width=d+f)):(0!==d&&(d+=c),d+2*m+v.width>o.width&&v.width<o.width&&(d=0,u+=p,p=20,h=o.width,r.height=u+p));var A=!1;if(v.width>o.width){A=!0;var w=o.width,S=b,C=S.split(/\s+/);let e=[],t="";for(let i=0;i<C.length;i++){var k=t+(0<t.length?" ":"")+C[i],I=a.renderer.measureText(k,0,{class:_});I.width>w&&0<k.length&&0<t.length?(e.push({text:t}),t=C[i]):t=k,i+1===C.length&&e.push({text:t})}v.width=0;var M=0;for(let i=0;i<e.length;i++){var F=e[i].text,I=a.renderer.measureText(F,0,{class:_});v.width=Math.max(v.width,I.width),M+=v.height}v.height=M}var D=d+v.width<o.width&&u+v.height<t.height;if(a._legendLayout)var D=o.x+d+v.width<a._rect.x+a._rect.width&&o.y+u+v.height<a._rect.y+a._rect.height;if(!n&&D){var T=e[y].seriesIndex,O=e[y].groupIndex,R=e[y].itemIndex,L=e[y].fillColor,P=e[y].lineColor,G=a._isSerieVisible(O,T,R),V=l.beginGroup(),g=G?e[y].opacity:.1;if(A){var S=b,w=o.width,C=S.split(/\s+/),E=0;let i=[],t="";for(let e=0;e<C.length;e++){var k=t+(0<t.length?" ":"")+C[e],I=a.renderer.measureText(k,0,{class:_});I.width>w&&0<k.length&&0<t.length?(i.push({text:t,dy:E}),E+=I.height,t=C[e]):t=k,e+1===C.length&&i.push({text:t,dy:E})}for(let e=0;e<i.length;e++){var F=i[e].text;E=i[e].dy;var I=a.renderer.measureText(F,0,{class:_});s?a.renderer.text(F,o.x+d+1.5*m,o.y+u+E,v.width,p,0,{class:_},!1,"left","center"):a.renderer.text(F,o.x+d+1.5*m,o.y+u+E,v.width,p,0,{class:_},!1,"center","center")}let r=l.rect(o.x+d,o.y+u+m/2+E/2,m,m);s&&(u+=E),a.renderer.attr(r,{fill:L,"fill-opacity":g,stroke:P,"stroke-width":1,"stroke-opacity":e[y].opacity})}else{let t=l.rect(o.x+d,o.y+u+m/2,m,m);a.renderer.attr(t,{fill:L,"fill-opacity":g,stroke:P,"stroke-width":1,"stroke-opacity":e[y].opacity,purpose:"legend-toggle",data:e[y]});let i;i=s?a.renderer.text(b,o.x+d+1.5*m,o.y+u,v.width,v.height+m/2,0,{class:_},!1,"left","center"):a.renderer.text(b,o.x+d+1.5*m,o.y+u,v.width,p,0,{class:_},!1,"center","center"),l.attr(i,{purpose:"legend-toggle",data:e[y]})}a.renderer.endGroup(),a._setLegendToggleHandler(O,T,R,V)}s||(d+=v.width+2*m,h<d&&(h=d))}if(n)return r.height=this.renderer._ptrnd(u+p+5),r.width=this.renderer._ptrnd(h),r}isSerieVisible(e,t,i){return this._isSerieVisible(e,t,i)}_isSerieVisible(e,t,i){for(;this._itemsToggleState.length<e+1;)this._itemsToggleState.push([]);for(var r=this._itemsToggleState[e];r.length<t+1;)r.push(!!isNaN(i)||[]);var n=r[t];if(isNaN(i))return n;for(Array.isArray(n)||(r[t]=n=[]);n.length<i+1;)n.push(!0);return n[i]}isGroupVisible(e){return this._isGroupVisible(e)}_isGroupVisible(e){var t=!1,r=this.seriesGroups[e].series;if(!r)return t;for(let n=0;n<r.length;n++)if(this._isSerieVisible(e,n)){t=!0;break}return t}_toggleSerie(e,t,i,r){var n=!this._isSerieVisible(e,t,i);void 0!==r&&(n=r);var a=this.seriesGroups[e],l=a.series[t];if(this.$.fireEvent("toggle",{state:n,seriesGroup:a,serie:l,elementIndex:i}),isNaN(i))this._itemsToggleState[e][t]=n;else{var o=this._itemsToggleState[e][t];for(Array.isArray(o)||(o=[]);o.length<i;)o.push(!0);o[i]=n}this._isToggleRefresh=!0,this.update(),this._isToggleRefresh=!1}showSerie(e,t,i){this._toggleSerie(e,t,i,!0)}hideSerie(e,t,i){this._toggleSerie(e,t,i,!1)}_setLegendToggleHandler(e,t,i,r){var n=this.seriesGroups[e],a=n.series[t],s=a.enableSeriesToggle;if((void 0===s||null===s)&&(s=!1!==n.enableSeriesToggle),s){var l=this;this.renderer.addHandler(r,"click",function(){l._toggleSerie(e,t,i)})}}_renderLegend(e,t){var r=this,n=[];for(let p=0;p<r.seriesGroups.length;p++){var i=r.seriesGroups[p];if(!1!==i.showLegend)for(let e=0;e<i.series.length;e++){var a=i.series[e];if(!1===a.showLegend)continue;var s=r._getSerieSettings(p,e),l;if("pie"===i.type||"donut"===i.type){var o=r._getXAxis(p);const t=a.legendFormatSettings||i.legendFormatSettings||r._getFormatSettings(o)||r._getFormatSettings(a)||r._getFormatSettings(i);let g=a.legendFormatFunction||i.legendFormatFunction||o.formatFunction||a.formatFunction||i.formatFunction;var d=r._getDataLen(p);for(let o=0;o<d;o++){l=r._getDataValue(o,a.displayText,p),l=r._formatValue(l,t,g,p,e,o);let i=r._getColors(p,e,o);n.push({groupIndex:p,seriesIndex:e,itemIndex:o,text:l,css:a.displayTextClass,fillColor:i.fillColor,lineColor:i.lineColor,opacity:s.opacity})}continue}const t=a.legendFormatSettings||i.legendFormatSettings;let h=a.legendFormatFunction||i.legendFormatFunction;l=r._formatValue(a.displayText||a.dataField||"",t,h,p,e,NaN);let y=r._getSeriesColors(p,e);var g=this._get([a.legendFillColor,a.legendColor,y.fillColor]),u=this._get([a.legendLineColor,a.legendColor,y.lineColor]);n.push({groupIndex:p,seriesIndex:e,text:l,css:a.displayTextClass,fillColor:g,lineColor:u,opacity:s.opacity})}}return r._renderChartLegend(n,e,t,r._legendLayout&&"vertical"===r.legendLayout.flow)}_getInterval(e,t){if(!e)return t;var i=this._get([e.unitInterval,t]);return isNaN(e.step)||null===e.step||(i=e.step*t),i}_getOffsets(e,t,i,r,n,s,a,l,o){var d=this._getInterval(n[e],l),g=[];(""===e||n[e].visible&&"custom"!==n[e].visible)&&(g=this._generateIntervalValues(r,d,l,a,o));var u;if("labels"!==e){let e=a?s.left:0;if(!a&&1<l&&(e=s.left*(l+1)),1===g.length&&(e*=2),u=this._valuesToOffsets(g,t,r,i,s,!1,e),!a){var p=(s.left+s.right)*d/l;t.flip?u.unshift(u[0]+p):u.push(u[u.length-1]+p)}}else{let e=s.left;1===g.length&&(e*=2),u=this._valuesToOffsets(g,t,r,i,s,a,e)}var h=this._arraysToObjectsArray([g,u],["value","offset"]);if(t[e]&&t[e].custom){var y=this._objectsArraysToArray(t[e].custom,"value"),m=this._objectsArraysToArray(t[e].custom,"offset"),c=this._valuesToOffsets(y,t,r,i,s,a,s.left);for(let r=0;r<t[e].custom.length;r++)h.push({value:y[r],offset:isNaN(m[r])?c[r]:m[r]})}return h}_renderXAxis(e,t,i,r){var n=this,s=n._getXAxis(e),a=n.seriesGroups[e],l="horizontal"===a.orientation,o={width:0,height:0},d=n._getAxisSettings(s);if(!s||!d.visible||"spider"===a.type)return o;if(!n._isGroupVisible(e)||this._isPieGroup(e))return o;for(var g=n._alignValuesWithTicks(e);n._renderData.length<e+1;)n._renderData.push({});n.rightToLeft&&(s.flip=!0);var u=l?t.height:t.width,p=n._calculateXOffsets(e,u),h=p.axisStats,y=s.rangeSelector&&s.rangeSelector.visible,m=0;y&&(!this._moduleRangeSelector&&n.error(n.localize("missingReference",{files:"smartchart.rangeselector.js"})),m=this._selectorGetSize(s));var c=l&&"right"===s.position||!l&&"top"===s.position;!i&&y&&(l?(t.width-=m,"right"!==s.position&&(t.x+=m)):(t.height-=m,"top"===s.position&&(t.y+=m)));var f={rangeLength:p.rangeLength,itemWidth:p.itemWidth,intervalWidth:p.intervalWidth,data:p,settings:d,isMirror:c,rect:t};n._renderData[e].xAxis=f;var _=h.interval;if(isNaN(_))return o;l&&(d.title.angle-=90,d.labels.angle-=90);var b=this._getInterval(d.gridLines,_),v=this._getInterval(d.tickMarks,_),A=this._getInterval(d.labels,_),w=h.min,S=h.max,C=p.padding,k=!0===s.flip||n.rightToLeft,I={min:w,max:S},M;h.logAxis.enabled&&(I.min=h.logAxis.minPow,I.max=h.logAxis.maxPow),"date"===s.type?(d.gridLines.offsets=this._generateDTOffsets(w,S,u,C,b,_,h.dateTimeUnit,g,NaN,!1,k),d.tickMarks.offsets=this._generateDTOffsets(w,S,u,C,v,_,h.dateTimeUnit,g,NaN,!1,k),M=this._generateDTOffsets(w,S,u,C,A,_,h.dateTimeUnit,g,NaN,!0,k)):(d.gridLines.offsets=this._getOffsets("gridLines",s,u,h,d,C,g,_),d.tickMarks.offsets=this._getOffsets("tickMarks",s,u,h,d,C,g,_),M=this._getOffsets("labels",s,u,h,d,C,g,_));var F;n._elementRenderInfo&&n._elementRenderInfo.length>e&&(F=n._elementRenderInfo[e].xAxis);var D=[],T;d.labels.formatFunction&&(T=d.labels.formatFunction);const O=n._getFormatSettings(d.labels);var R;O&&(R=Object.assign({},O)),"date"===s.type&&(s.dateFormat&&!T?R?R.dateFormat=R.dateFormat||s.dateFormat:R={dateFormat:s.dateFormat}:!T&&(!R||R&&!R.dateFormat)&&(T=this._getDefaultDTFormatFn(s.baseUnit||"day")));for(let a=0;a<M.length;a++){var L=M[a].value,P=M[a].offset;if(!isNaN(P)){var x=void 0;"date"!==s.type&&h.useIndeces&&s.dataField&&(x=Math.round(L),L=n._getDataValue(x,s.dataField,e),(void 0===L||null===L)&&(L=""));var G=n._formatValue(L,R,T,e,void 0,x);(void 0===G||null===G||""===G.toString())&&(isNaN(x)&&(x=a),x>=h.filterRange.min&&x<=h.filterRange.max&&(G=h.useIndeces?(h.min+x).toString():void 0===L?"":L.toString()));var V={key:L,text:G,targetX:P,x:P};F&&F.itemOffsets[L]&&(V.x=F.itemOffsets[L].x,V.y=F.itemOffsets[L].y),D.push(V)}}var E=n._getAnimProps(e),B=E.enabled&&500>D.length?E.duration:0;!1===n.enableAxisTextAnimation&&(B=0);var H=n._renderAxis(l,c,d,{x:t.x,y:t.y,width:t.width,height:t.height},r,_,!1,!0,{items:D,renderData:f},i,B);return l?H.width+=m:H.height+=m,H}_animateAxisText(e,t){var r=e.items,i=e.textSettings;for(let l=0;l<r.length;l++){var n=r[l];if(n&&n.visible){var s=n.targetX,a=n.targetY;isNaN(n.x)||isNaN(n.y)||(s=n.x+(s-n.x)*t,a=n.y+(a-n.y)*t),n.element&&(this.renderer.removeElement(n.element),n.element=void 0),n.element=this.renderer.text(n.text,s,a,n.width,n.height,i.angle,{class:i.style},!1,i.halign,i.valign,i.textRotationPoint)}}}_getPolarAxisCoords(e,t){var i=Math.abs,r=Math.PI,n=this.seriesGroups[e],s=t.x+this._draw.getNum([n.offsetX,t.width/2]),a=t.y+this._draw.getNum([n.offsetY,t.height/2]),l=Math.min(t.width,t.height),o=n.radius;this._isPercent(o)&&(o=parseFloat(o)/100*l/2),isNaN(o)&&(o=.6*(l/2));var d=this._alignValuesWithTicks(e),g=this._get([n.startAngle,n.minAngle,0])-90;g=isNaN(g)?0:2*r*g/360;var u=this._get([n.endAngle,n.maxAngle,360])-90;if(u=isNaN(u)?2*r:2*r*u/360,g>u){var p=g;g=u,u=p}var h=this.renderer._rnd(i(g-u)/(2*r),.001,!0),y=2*r*o*h,m=this._calcGroupOffsets(e,t).xoffsets;if(m){var c=!(1e-5<i(i(u-g)-2*r));if(n.spider){const t=this._getXAxisStats(e,this._getXAxis(e),y);var f=t.interval;(isNaN(f)||0===f)&&(f=1);var x=(t.max-t.min)/f+(c?1:0);if(x=Math.round(x),2<x){var _=Math.cos(i(u-g)/2/x);_=this.renderer._rnd(_,.01),0===_&&(_=1);var b=o/_;b>o&&d&&(o=b)}}return o=this.renderer._ptrnd(o),{x:s,y:a,r:o,adjR:this._get([b,o]),itemWidth:m.itemWidth,rangeLength:m.rangeLength,valuesOnTicks:d,startAngle:g,endAngle:u,isClosedCircle:c,axisSize:y}}}_toPolarCoord(e,t,i,r){var n=Math.PI,s=Math.max,a=Math.abs(e.startAngle-e.endAngle)/(2*n),l=2*(i-t.x)*n*a/s(1,t.width)+e.startAngle,o=(t.height+t.y-r)*e.r/s(1,t.height),d=e.x+o*Math.cos(l),g=e.y+o*Math.sin(l);return{x:this.renderer._ptrnd(d),y:this.renderer._ptrnd(g)}}_renderSpiderAxis(e,t){var i=Math.sin,r=Math.cos,n=Math.abs,s=Math.PI,a=Math.min,l=Math.max,o=this,d=o._getXAxis(e),g=this._getAxisSettings(d);if(d&&g.visible){var u=o.seriesGroups[e],p=o._getPolarAxisCoords(e,t);if(p){var h=this.renderer._ptrnd(p.x),y=this.renderer._ptrnd(p.y),m=p.adjR,c=p.startAngle,f=p.endAngle;if(!(1>m)){var _=this.renderer._rnd(n(c-f)/(2*s),.001,!0),b=2*s*m*_,v=p.isClosedCircle,A=this._renderData[e].xoffsets;if(A.rangeLength){var w=A.axisStats.interval;for((isNaN(w)||1>w)&&(w=1);o._renderData.length<e+1;)o._renderData.push({});var S={rangeLength:A.rangeLength,itemWidth:A.itemWidth,data:A,rect:t,settings:g};o._renderData[e].xAxis=S,o._renderData[e].polarCoords=p;var C=!0;for(let t=0;t<e;t++){var k=o._renderData[t].polarCoords,I=o._getXAxis(t),M=!1;for(var F in p)if(p[F]!==k[F]){M=!0;break}M&&I===d||(C=!1)}var D=g.gridLines,T=g.tickMarks,O=g.labels,R=this._getInterval(D,w),L=this._getInterval(T,w),P=this._getInterval(O,w),G=o._alignValuesWithTicks(e),V=o.renderer,E=A.axisStats,B=E.min,H=E.max,j=this._getPaddingSize(A.axisStats,d,G,b,!0,v,!1),z=!0===d.flip||o.rightToLeft,W;"date"===d.type?(D.offsets=this._generateDTOffsets(B,H,b,j,R,w,d.baseUnit,!0,0,!1,z),T.offsets=this._generateDTOffsets(B,H,b,j,L,w,d.baseUnit,!0,0,!1,z),W=this._generateDTOffsets(B,H,b,j,P,w,d.baseUnit,!0,0,!0,z)):(g.gridLines.offsets=this._getOffsets("gridLines",d,b,E,g,j,!0,w),g.tickMarks.offsets=this._getOffsets("tickMarks",d,b,E,g,j,!0,w),W=this._getOffsets("labels",d,b,E,g,j,!0,w));var X;o._elementRenderInfo&&o._elementRenderInfo.length>e&&(X=o._elementRenderInfo[e].xAxis);var N=[],U=this._getDataLen(e);for(let t=0;t<W.length;t++){var Y=W[t].offset,x=W[t].value;if("date"!==d.type&&E.useIndeces&&d.dataField){var Z=Math.round(x);if(Z>=U)continue;x=o._getDataValue(Z,d.dataField),(void 0===x||null===x)&&(x="")}var q=o._formatValue(x,o._getFormatSettings(O.formatSettings),O.formatFunction,e,void 0,Z);(void 0===q||null===q||""===q.toString())&&(q=E.useIndeces?(E.min+t).toString():void 0===x||null===x?"":x.toString());var J={key:x,text:q,targetX:Y,x:Y};X&&X.itemOffsets[x]&&(J.x=X.itemOffsets[x].x,J.y=X.itemOffsets[x].y),N.push(J)}var K={stroke:D.color||o._getThemeColor("line"),fill:"none","stroke-width":D.width,"stroke-dasharray":D.dashStyle||""};if(!u.spider)if(1===_)V.circle(h,y,m,K);else{var $=180*(-c/s),Q=180*(-f/s);this.renderer.pieslice(h,y,0,m,a($,Q),l($,Q),void 0,K)}var ee=c;if(D.visible&&C){G||v||D.offsets.unshift({offset:-j.right});for(let e=0,t;e<D.offsets.length;e++){t=D.offsets[e].offset,G||(v?t+=j.right/2:t+=j.right);const n=ee+2*t*s*_/l(1,b);if(!(.01<n-f)){var te=this.renderer._ptrnd(h+m*r(n)),ie=this.renderer._ptrnd(y+m*i(n));V.line(h,y,te,ie,K)}}}if(T.visible&&C){var re={stroke:T.color||o._getThemeColor("line"),fill:"none","stroke-width":T.width,"stroke-dasharray":T.dashStyle||""};G||v||T.offsets.unshift({offset:-j.right});for(let e=0,t;e<T.offsets.length;e++){t=T.offsets[e].offset,G||(v?t+=j.right/2:t+=j.right);const n=ee+2*t*s*_/l(1,b);if(!(.01<n-f)){var ne={x:h+m*r(n),y:y+m*i(n)},se={x:h+(m+5)*r(n),y:y+(m+5)*i(n)};V.line(this.renderer._ptrnd(ne.x),this.renderer._ptrnd(ne.y),this.renderer._ptrnd(se.x),this.renderer._ptrnd(se.y),re)}}}var ae=[];if(u.spider){var le=[];le="date"===d.type?this._generateDTOffsets(B,H,b,j,w,w,d.baseUnit,!0,0,!1,z):this._getOffsets("",d,b,E,g,j,!0,w),G||v||le.unshift({offset:-j.right});for(let e=0,t;e<le.length;e++){t=le[e].offset,G||(v?t+=j.right/2:t+=j.right);const i=ee+2*t*s*_/l(1,b);.01<i-f||ae.push(i)}S.offsetAngles=ae}var oe=o._renderSpiderValueAxis(e,t,G?p.adjR:p.r,ae);if(oe||(oe=[]),u.spider){if(!G)for(let e=0;e<oe.length;e++)oe[e]=oe[e]*p.adjR/p.r;oe.push(m),this._renderSpiderLines(h,y,oe,p,ae,K)}if(C&&O.visible){S.polarLabels=[];for(let e=0;e<N.length;e++){let t=N[e].x,i=ee+2*t*s*_/l(1,b);i=(360-360*(i/(2*s)))%360,0>i&&(i=360+i);var de=V.measureText(N[e].text,0,{class:g.labels.style}),ge=(G?p.adjR:p.r)+(T.visible?7:2),ue=g.labels,pe;if(ue.autoRotate){var he=this._draw._ptRotate(h-de.width/2,y-ge-de.height,h,y,-i/180*s),ye=this._draw._ptRotate(h+de.width/2,y-ge,h,y,-i/180*s);de.width=n(he.x-ye.x),de.height=n(he.y-ye.y),pe={x:a(he.x,ye.x),y:a(he.y,ye.y)}}else pe=this._adjustTextBoxPosition(h,y,de,ge,i,!1,!1,!1);S.polarLabels.push({x:pe.x,y:pe.y,value:N[e].text}),V.text(N[e].text,pe.x,pe.y,de.width,de.height,ue.autoRotate?90-i:ue.angle,{class:ue.style},!1,ue.halign,ue.valign)}}}}}}}_renderSpiderLines(e,t,i,r,n,s){var a=this.renderer,l=r.isClosedCircle;for(let y=0;y<i.length;y++){var o=i[y],d=void 0,g=void 0;for(let r=0;r<n.length;r++){var u=n[r],p=this.renderer._ptrnd(e+o*Math.cos(u)),h=this.renderer._ptrnd(t+o*Math.sin(u));d&&a.line(d.x,d.y,p,h,s),d={x:p,y:h},g||(g={x:p,y:h})}g&&l&&a.line(d.x,d.y,g.x,g.y,s)}}_renderSpiderValueAxis(e,t,r,i){var n=Math.sin,s=Math.cos,a=Math.abs,l=Math.PI,o=Math.min,d=Math.max,g=this,u=this.seriesGroups[e],p=this._getPolarAxisCoords(e,t);if(p){var h=this.renderer._ptrnd(p.x),m=this.renderer._ptrnd(p.y);r=r||p.r;var c=p.startAngle,f=p.endAngle,_=this.renderer._rnd(a(c-f)/(2*l),.001,!0);if(!(1>r)){r=this.renderer._ptrnd(r);var b=this._getValueAxis(e);const t=this._getAxisSettings(b);if(b&&!1!==t.visible){var y=this._stats.seriesGroups[e].mu,v=t.labels,A=g._getFormatSettings(v),w=-1!==u.type.indexOf("stacked")&&-1!==u.type.indexOf("100");w&&!A&&(A={sufix:"%"});var S=this._get([v.step,v.unitInterval/y]);isNaN(S)&&(S=1),S=d(1,Math.round(S)),this._calcValueAxisItems(e,r,S);var C=t.gridLines,k=t.tickMarks,I=t.labels,M={stroke:C.color||g._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":C.dashStyle||""},F=this._renderData[e].valueAxis,D=F.items,T=c;if(D.length&&t.line.visible){isNaN(t.line.angle)||(T=2*l*t.line.angle/360);var O=h+s(T)*r,R=m+n(T)*r;if(-1===i.indexOf(T)){var L=Object.assign({},M);L["stroke-width"]=t.line.lineWidth,L.stroke=t.line.color||g._getThemeColor("line"),L["stroke-dasharray"]=t.line.dashStyle,this.renderer.line(h,m,O,R,L)}}D=D.reverse();var P=this.renderer;F.polarLabels=[];for(let e=0;e<D.length-1;e++){var G=D[e];if(isNaN(G))continue;var V=I.formatFunction?I.formatFunction(G):this._formatNumber(G,A),E=P.measureText(V,0,{class:I.style}),B=h+(!1===b.showTickMarks?2:3);let i=m-F.itemWidth*e-E.height/2;{var H=this._draw._ptRotate(B,i,h,m,T),j=this._draw._ptRotate(B+E.width,i+E.height,h,m,T);B=o(H.x,j.x),i=o(H.y,j.y),E.width=a(H.x-j.x),E.height=a(H.y-j.y)}B+=t.labels.textOffset.x,i+=t.labels.textOffset.y,F.polarLabels.push({x:B,y:i,value:V}),P.text(V,B,i,E.width,E.height,I.autoRotate?90+180*c/l:I.angle,{class:I.style},!1,I.halign,I.valign)}var z=!1!==b.valuesOnTicks,W=this._stats.seriesGroups[e],X=W.mu,N=!0===b.logarithmicScale;N&&(X=1);var U={min:W.min,max:W.max,logAxis:{enabled:!0===N,base:b.logarithmicScaleBase,minPow:W.minPow,maxPow:W.maxPow}};(C.visible||u.spider||b.alternatingBackgroundColor||b.alternatingBackgroundColor2)&&(C.offsets=this._getOffsets("gridLines",b,r,U,t,{left:0,right:0},z,X));var Y=[];if(C.visible||u.spider){let e={stroke:C.color||g._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":C.dashStyle||""};for(let t=0,i;t<C.offsets.length;t++)if(i=this.renderer._ptrnd(C.offsets[t].offset),i!==r){if(u.spider){Y.push(i);continue}if(1!==_){var Z=180*(-c/l),q=180*(-f/l);this.renderer.pieslice(h,m,0,i,o(Z,q),d(Z,q),void 0,e)}else P.circle(h,m,i,e)}}if(b.tickMarks&&(b.tickMarks.visible||b.showTickMarks)||(k.visible=!1),k.visible){k.offsets=this._getOffsets("tickMarks",b,r,U,t,{left:0,right:0},z,X);const e=2*k.size;let a={stroke:k.color||g._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":k.dashStyle||""};for(let t=0;t<k.offsets.length;t++){var J=k.offsets[t].offset,H={x:h+J*s(T)-e/2*n(T+l/2),y:m+J*n(T)-e/2*s(T+l/2)},j={x:h+J*s(T)+e/2*n(T+l/2),y:m+J*n(T)+e/2*s(T+l/2)};P.line(this.renderer._ptrnd(H.x),this.renderer._ptrnd(H.y),this.renderer._ptrnd(j.x),this.renderer._ptrnd(j.y),a)}}return Y}}}}_renderAxis(e,t,i,r,n,s,a,l,o,d,g){if(i.customDraw&&!d)return{width:NaN,height:NaN};var u=i.title,p=i.labels,y=i.tickMarks,m=i.padding,c=y.visible?y.size:0,f=2,x={width:0,height:0},_={width:0,height:0};e?x.height=_.height=r.height:x.width=_.width=r.width,!d&&t&&e&&(r.x-=r.width);var b=o.renderData,v=b.itemWidth;if(u.visible&&void 0!==u.text&&null!==u.text&&""!==u){var A=u.angle;let i=this.renderer.measureText(u.text,A,{class:u.style});_.width=i.width,_.height=i.height,d||this.renderer.text(u.text,r.x+u.offset.x+(e?t?-m.right-f+2*r.width-_.width:f+m.left:0),r.y+u.offset.y+(e?0:t?m.top+f:r.height-f-_.height-m.bottom),e?_.width:r.width,e?r.height:_.height,A,{class:u.style},!0,u.halign,u.valign,u.rotationPoint)}var S=0,C=l?-v/2:0;l&&!e&&(p.halign="center");var k=r.x,I=r.y,M=p.textOffset;M&&(!isNaN(M.x)&&(k+=M.x),!isNaN(M.y)&&(I+=M.y)),e?(k+=m.left+f+(0<_.width?_.width+f:0)+(t?r.width-_.width:0),I+=C):(k+=C,t?(I+=0<_.height?_.height+3*f:2*f,I+=c-(l?c:c/4)):I+=l?c:c/4,I+=m.top);var F=0,D=0,T=o.items;b.itemOffsets={},(this._isToggleRefresh||!this._isUpdate)&&(g=0);var O=!1,R=0;for(let u=0;u<T.length&&p.visible;u++,S+=v){if(!T[u]||isNaN(v))continue;var L=T[u].text;isNaN(T[u].targetX)||(S=T[u].targetX);let i=this.renderer.measureText(L,p.angle,{class:p.style});if(i.width>D&&(D=i.width),i.height>F&&(F=i.height),R+=e?F:D,!d){if(e&&S>r.height+2||!e&&S>r.width+2)continue;const i=e?k+(t?0===_.width?c:c-f:0):k+S;let n=e?I+S:I;b.itemOffsets[T[u].key]={x:i,y:n},O||isNaN(T[u].x)&&(isNaN(T[u].y)||!g)||(O=!0),T[u].targetX=i,T[u].targetY=n,T[u].width=e?r.width-m.left-m.right-2*f-c-(0<_.width?_.width+f:0):v,T[u].height=e?v:r.height-m.top-m.bottom-2*f-c-(0<_.height?_.height+f:0),T[u].visible=!0}}if(b.avgWidth=0===T.length?0:R/T.length,!d){var P={items:T,textSettings:p};if((isNaN(g)||!O)&&(g=0),this._animateAxisText(P,0===g?1:0),0!==g){var G=this;this._enqueueAnimation("series",void 0,void 0,g,function(e,t,i){G._animateAxisText(t,i)},P)}}if(x.width+=2*f+c+_.width+D+(e&&0<_.width?f:0),x.height+=2*f+c+_.height+F+(!e&&0<_.height?f:0),e?x.width+=m.left+m.right:x.height+=m.top+m.bottom,!d&&i.line.visible){var V={stroke:i.line.color||G._getThemeColor("line"),"stroke-width":i.line.width,"stroke-dasharray":i.line.dashStyle||""};if(e){let e=r.x+r.width+(t?m.left:-m.right);e=this.renderer._ptrnd(e),this.renderer.line(e,r.y,e,r.y+r.height,V)}else{let e=this.renderer._ptrnd(r.y+(t?r.height-m.bottom:m.top));this.renderer.line(this.renderer._ptrnd(r.x),e,this.renderer._ptrnd(r.x+r.width+1),e,V)}}return x.width=this.renderer._rup(x.width),x.height=this.renderer._rup(x.height),x}_drawPlotAreaLines(e,t,r){var n=Math.abs,i=this.seriesGroups[e],s="horizontal"!==i.orientation;if(!this._renderData||this._renderData.length<=e)return;var a=t?"valueAxis":"xAxis",l=this._renderData[e][a];if(!l)return;var o=this._renderData.axisDrawState;o||(o=this._renderData.axisDrawState={});var d="",g;t?(d="valueAxis_"+(i.valueAxis?e:"")+(s?"swap":""),g=this._getValueAxis(e)):(d="xAxis_"+(i.xAxis?e:"")+(s?"swap":""),g=this._getXAxis(e)),o=o[d]?o[d]:o[d]={},t||(s=!s);var u=l.settings;if(!u)return;if(u.customDraw)return;var p=u.gridLines,h=u.tickMarks,m=u.padding,c=l.rect,f=this._plotRect;if(!p||!h)return;var _=.5,b={};let v={stroke:p.color||self._getThemeColor("line"),"stroke-width":p.width,"stroke-dasharray":p.dashStyle||""};var A=t?c.y+c.height:c.x,w=p.offsets;t&&!g.flip&&(w=w.slice(0),w=w.reverse());let S;if(w&&0<w.length){var C=NaN;for(let e=0;e<w.length;e++)if(s?(S=this.renderer._ptrnd(c.y+w[e].offset),S<c.y-_&&(S=this.renderer._ptrnd(c.y)),S>c.y+c.height&&(S=c.y+c.height)):(S=this.renderer._ptrnd(c.x+w[e].offset),S>c.x+c.width+_&&(S=this.renderer._ptrnd(c.x+c.width))),!isNaN(S)&&(isNaN(C)||!(2>n(S-C)))){if(C=S,r.gridLines&&!1!==p.visible&&!0!==o.gridLines&&(s?this.renderer.line(this.renderer._ptrnd(f.x),S,this.renderer._ptrnd(f.x+f.width),S,v):this.renderer.line(S,this.renderer._ptrnd(f.y),S,this.renderer._ptrnd(f.y+f.height),v)),b[S]=!0,r.alternatingBackground&&(p.alternatingBackgroundColor||p.alternatingBackgroundColor2)&&!0!==o.alternatingBackground){var k=0==e%2?p.alternatingBackgroundColor2:p.alternatingBackgroundColor;if(0<e&&k){var I;I=s?this.renderer.rect(this.renderer._ptrnd(f.x),A,this.renderer._ptrnd(f.width-1),S-A,v):this.renderer.rect(A,this.renderer._ptrnd(f.y),S-A,this.renderer._ptrnd(f.height),v),this.renderer.attr(I,{"stroke-width":0,fill:k,opacity:p.alternatingBackgroundOpacity||1})}}A=S}}if(v={stroke:h.color||self._getThemeColor("line"),"stroke-width":h.width,"stroke-dasharray":h.dashStyle||""},r.tickMarks&&h.visible&&!0!==o.tickMarks){var M=h.size;let e=h.offsets;var C=NaN;for(let r=0;r<e.length;r++)if(s?(S=this.renderer._ptrnd(c.y+e[r].offset),S<c.y-_&&(S=this.renderer._ptrnd(c.y)),S>c.y+c.height&&(S=c.y+c.height)):(S=this.renderer._ptrnd(c.x+e[r].offset),S>c.x+c.width+_&&(S=this.renderer._ptrnd(c.x+c.width))),!isNaN(S)&&(isNaN(C)||!(2>n(S-C)))){if(b[S-1]?S--:b[S+1]&&S++,s){if(S>c.y+c.height+_)break;}else if(S>c.x+c.width+_)break;C=S;var F=l.isMirror?M:-M;if(s){var D=c.x+c.width+("right"===g.position?m.left:-m.right);t||(D=c.x+(l.isMirror?m.left:-m.right+c.width)),this.renderer.line(D,S,D+F,S,v)}else{var T=c.y+(l.isMirror?c.height:0);T+=l.isMirror?-m.bottom:m.top,T=this.renderer._ptrnd(T),this.renderer.line(S,T,S,T-F,v)}}}o.tickMarks=o.tickMarks||r.tickMarks,o.gridLines=o.gridLines||r.gridLines,o.alternatingBackground=o.alternatingBackground||r.alternatingBackground}_calcValueAxisItems(e,t,r){var n=Math.pow,s=this._stats.seriesGroups[e];if(!s||!s.isValid)return!1;var i=this.seriesGroups[e],a=this._getValueAxis(e),l=!1!==a.valuesOnTicks,o=s.intervals,d=t/o,g=s.min,u=s.mu,p=!0===a.logarithmicScale,h=a.logarithmicScaleBase||10,y=-1!==i.type.indexOf("stacked")&&-1!==i.type.indexOf("100");for(p&&(u=isNaN(a.unitInterval)?1:a.unitInterval),l||(o=Math.max(o-1,1));this._renderData.length<e+1;)this._renderData.push({});this._renderData[e].valueAxis={};var m=this._renderData[e].valueAxis;m.itemWidth=m.intervalWidth=d,m.items=[];var c=m.items;for(let a=0;a<=o;a++){var f=0;if(f=p?y?s.max/n(h,o-a):g*n(h,a):l?g+a*u:g+(a+.5)*u,0!=a%r){c.push(NaN);continue}c.push(f)}return m.rangeLength=p&&!y?s.intervals:s.intervals*u,!0!==a.flip&&(c=c.reverse()),!0}_getDecimalPlaces(e,t,i){var r=0;isNaN(i)&&(i=10);for(let a=0;a<e.length;a++){var n=t===void 0?e[a]:e[a][t];if(!isNaN(n)){var s=n.toString();for(let e=0;e<s.length;e++)if(("0">s[e]||"9"<s[e])&&(r=s.length-(e+1),0<=r))return Math.min(r,i);for(0<r&&(n*=Math.pow(10,r));Math.round(n)!==n&&r<i;)r++,n*=10}}return r}_renderValueAxis(e,t,i,r){var n=this.seriesGroups[e],s="horizontal"===n.orientation,a=this._getValueAxis(e);a||this.error(this.localize("missingAxis",{index:e,axis:"valueAxis"}));var l={width:0,height:0};if(!this._isGroupVisible(e)||this._isPieOnlySeries()||"spider"===n.type)return l;var o=!1!==a.valuesOnTicks,d=this._stats.seriesGroups[e],g=d.mu,u=!0===a.logarithmicScale,p=a.logarithmicScaleBase||10;if(u&&(g=isNaN(a.unitInterval)?1:a.unitInterval),0===g&&(g=1),isNaN(g))return l;var h=this._getAxisSettings(a),y=h.title,m=h.labels,c=a.labels||{},f=this._get([a.horizontalTextAlignment,c.horizontalAlignment]);f||0!==m.angle||(m.halign=s?"center":"right"===a.position?"left":"right");var x=this._get([m.step,m.unitInterval/g]);if(isNaN(x)&&(x=1),x=Math.max(1,Math.round(x)),!this._calcValueAxisItems(e,s?t.width:t.height,x)||!h.visible)return l;s||(y.angle=this.rightToLeft?90:-90,"centercenter"===y.rotationPoint&&("top"===y.valign?y.rotationPoint="rightcenter":"bottom"===y.valign&&(y.rotationPoint="leftcenter")));var _=this._renderData[e].valueAxis,b=this._getFormatSettings(m),v=-1!==n.type.indexOf("stacked")&&-1!==n.type.indexOf("100");v&&!b&&(b={sufix:"%"}),m.formatFunction||b&&null!==b.decimalPlaces&&void 0!==b.decimalPlaces||(b=b||{},b.decimalPlaces=this._getDecimalPlaces([d.min,d.max,g],void 0,3));var A=h.gridLines,w=s?t.width:t.height,S=!0===a.flip;a.flip=!S;var C={min:d.min,max:d.max,logAxis:{enabled:!0===u,base:p,minPow:d.minPow,maxPow:d.maxPow}};(A.visible||a.alternatingBackgroundColor||a.alternatingBackgroundColor2)&&(A.offsets=this._getOffsets("gridLines",a,w,C,h,{left:0,right:0},o,g));var k=h.tickMarks;k.visible&&(k.offsets=this._getOffsets("tickMarks",a,w,C,h,{left:0,right:0},o,g));const I=this._getOffsets("labels",a,w,C,h,{left:0,right:0},o,g,!o);a.flip=S;var M=[],F;this._elementRenderInfo&&this._elementRenderInfo.length>e&&(F=this._elementRenderInfo[e].valueAxis);for(let n=0;n<I.length;n++){var D=I[n].value;if(isNaN(I[n].offset)){M.push(void 0);continue}var T=m.formatFunction?m.formatFunction(D):isNaN(D)?D:this._formatNumber(D,b),O={key:D,text:T};F&&F.itemOffsets[D]&&(O.x=F.itemOffsets[D].x,O.y=F.itemOffsets[D].y),O.targetX=I[n].offset,isNaN(O.targetX)||M.push(O)}var R=s&&"top"===a.position||!s&&"right"===a.position||!s&&this.rightToLeft&&"left"!==a.position,L=this._getAnimProps(e),P=L.enabled&&500>M.length?L.duration:0;return!1===this.enableAxisTextAnimation&&(P=0),_.settings=h,_.isMirror=R,_.rect=t,this._renderAxis(!s,R,h,t,r,g,u,!0,{items:M,renderData:_},i,P)}_objectsArraysToArray(e,t){var r=[];if(!Array.isArray(e))return r;for(let n=0;n<e.length;n++)r.push(e[n][t]);return r}_arraysToObjectsArray(e,t){var r=[];if(e.length!==t.length)return r;for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)r.length<=i&&r.push({}),r[i][t[n]]=e[n][i];return r}_valuesToOffsets(e,t,r,n,i,s,a){var l=[];if(!t||!Array.isArray(e))return l;var o=r.logAxis.base,d=r.logAxis.enabled?"logarithmic":"linear",g=t.flip,u=n,p=0,h=0;i&&!isNaN(i.left)&&(p=i.left),i&&!isNaN(i.right)&&(h=i.right),u=n-p-h,n=u;for(let y=0,m;y<e.length;y++)m=this._smartPlot.scale(e[y],{min:r.min.valueOf(),max:r.max.valueOf(),type:d,base:o},{min:0,max:s?n:u,flip:g},{}),isNaN(m)?l.push(NaN):(!isNaN(a)&&(m+=a),m<=n+p+h+1?l.push(this.renderer._ptrnd(m)):l.push(NaN));return l}_generateIntervalValues(e,t,r,i,n){var s=Math.pow,a=[],l=e.min,o=e.max;if(e.logAxis&&e.logAxis.enabled&&(l=e.logAxis.minPow,o=e.logAxis.maxPow),void 0===l||null===l||void 0===o||null===o)return a;if(l===o)return e.logAxis&&e.logAxis.enabled?[s(e.logAxis.base,l)]:[l];var d=1;1>r&&(d=1e6,l*=d,o*=d,r*=d);for(let s=l;s<=o;s+=r)a.push(s/d+(n?r/2:0));if(t>r){var g=[],u=Math.round(t/r);for(let e=0;e<a.length;e++)0==e%u&&g.push(a[e]);a=g}if(e.logAxis&&e.logAxis.enabled)for(let t=0;t<a.length;t++)a[t]=s(e.logAxis.base,a[t]);return a}_generateDTOffsets(e,t,r,i,n,s,a,l,o,d,g){a||(a="day");var u=[];if(e>t)return u;if(e===t)return d?u.push({offset:l?r/2:i.left,value:e}):l&&u.push({offset:r/2,value:e}),u;var p=r-i.left-i.right,h=e,y=i.left,m=y;s=Math.max(s,1);var c=s,f=Math.min(1,s);for(1<s&&"millisecond"!==a&&(s=1);this.renderer._ptrnd(m)<=this.renderer._ptrnd(i.left+p+(l?0:i.right));){u.push({offset:m,value:h});var x=new Date(h.valueOf());if("millisecond"===a)x.setMilliseconds(h.getMilliseconds()+s);else if("second"===a)x.setSeconds(h.getSeconds()+s);else if("minute"===a)x.setMinutes(h.getMinutes()+s);else if("hour"===a){var _=x.valueOf();x.setHours(h.getHours()+s),_===x.valueOf()&&x.setHours(h.getHours()+s+1)}else"day"===a?x.setDate(h.getDate()+s):"month"===a?x.setMonth(h.getMonth()+s):"year"===a&&x.setFullYear(h.getFullYear()+s);h=x,m=y+(h.valueOf()-e.valueOf())*f/(t.valueOf()-e.valueOf())*p}if(g)for(let e=0;e<u.length;e++)u[e].offset=r-u[e].offset;if(1<c&&"millisecond"!==a){var b=[];for(let e=0;e<u.length;e+=c)b.push({offset:u[e].offset,value:u[e].value});u=b}if(!l&&!d&&1<u.length){var b=[{offset:0,value:void 0}];for(let e=1;e<u.length;e++)b.push({offset:u[e-1].offset+(u[e].offset-u[e-1].offset)/2,value:void 0});var v=b.length;1<v?b.push({offset:b[v-1].offset+(b[v-1].offset-b[v-2].offset)}):b.push({offset:r,value:void 0}),u=b}if(n>s){var b=[],A=Math.round(n/c);for(let e=0;e<u.length;e++)0==e%A&&b.push({offset:u[e].offset,value:u[e].value});u=b}return u}_hasStackValueReversal(e,t){var r=this.seriesGroups[e],i=-1!==r.type.indexOf("stacked");if(!i)return!1;var n=-1!==r.type.indexOf("waterfall"),s=this._getDataLen(e),a=0,l=!1,o=[];for(let i=0;i<r.series.length;i++)o[i]=this._isSerieVisible(e,i);for(let p=0;p<s;p++){var d=void 0;n||(l=!1);for(let i=0;i<r.series.length;i++){if(!o[i])continue;const n=this._getDataValueAsNumber(p,r.series[i].dataField,e);if(!isNaN(n)){if(r.series[i].summary){var g=this._getDataValue(p,r.series[i].summary,e);if(void 0!==g)continue}var u=l?0>n:n<t;if(l=!0,void 0===d&&(d=u),u!==d)return!0;d=u,a+=n}}}return!1}_getValueAxis(e){var t=void 0===e||null===e?this.valueAxis:this.seriesGroups[e].valueAxis||this.valueAxis;return t||(t=this.valueAxis={}),t}_buildStats(e){var t=Math.min,r=Math.max,n={seriesGroups:[]};this._stats=n;for(let W=0;W<this.seriesGroups.length;W++){var s=this.seriesGroups[W];n.seriesGroups[W]={};var a=this._getXAxis(W),l=this._getValueAxis(W),o=this._getXAxisStats(W,a,"horizontal"===s.orientation?e.height:e.width);let X=n.seriesGroups[W];X.isValid=!0;var i="horizontal"===s.orientation?e.width:e.height,d=!0===l.logarithmicScale,g=l.logarithmicScaleBase;isNaN(g)&&(g=10);var u=-1!==s.type.indexOf("stacked"),h=u&&-1!==s.type.indexOf("100"),y=-1!==s.type.indexOf("range"),m=-1!==s.type.indexOf("waterfall");m&&!this._moduleWaterfall&&self.error(self.localize("missingReference",{files:"smartchart.waterfall.js"})),h&&(X.psums=[],X.nsums=[]);var c=NaN,f=NaN,x=NaN,_=NaN,b=l?l.baselineValue:NaN;isNaN(b)&&(b=d&&!h?1:0);var v=!1;0!==b&&u&&(v=this._hasStackValueReversal(W,b),v&&(b=0)),u&&m&&(v=this._hasStackValueReversal(W,b));var A=this._getDataLen(W),w=0,S=NaN,C=[];if(m)for(let e=0;e<s.series.length;e++)C.push(NaN);var k=NaN;for(let e=0;e<A&&X.isValid;e++){if(a.rangeSelector&&a.rangeSelector.visible){var I=a.dataField?this._getDataValue(e,a.dataField,W):e;if(I&&o.isDateTime&&(I=this._castAsDate(I,a.dateFormat)),o.useIndeces&&(I=e),I&&(I.valueOf()<o.min.valueOf()||I.valueOf()>o.max.valueOf()))continue}var M=l.minValue,F=l.maxValue;l.baselineValue&&(M=isNaN(M)?b:t(b,M),F=isNaN(F)?b:r(b,F));var D=0,T=0;for(let i=0;s.series&&i<s.series.length;i++)if(this._isSerieVisible(W,i)){var O=NaN,R=NaN,L=NaN;if(-1!==s.type.indexOf("candle")||-1!==s.type.indexOf("ohlc")){var P=["Open","Low","Close","High"];for(var G in P){var V=this._getDataValueAsNumber(e,s.series[i]["dataField"+P[G]],W);isNaN(V)||(L=isNaN(R)?V:t(L,V),R=isNaN(R)?V:r(R,V))}}else if(y){var E=this._getDataValueAsNumber(e,s.series[i].dataFieldFrom,W),B=this._getDataValueAsNumber(e,s.series[i].dataFieldTo,W);R=r(E,B),L=t(E,B)}else{if(O=this._getDataValueAsNumber(e,s.series[i].dataField,W),m){if(this._isSummary(W,e)){var H=this._getDataValue(e,s.series[i].summary,W);if(void 0!==H)continue}u?(!isNaN(k)&&(O+=k),k=O):(isNaN(C[i])?C[i]=O:O+=C[i],C[i]=O)}if(isNaN(O)||d&&0>=O)continue;L=R=O}(isNaN(F)||R>F)&&(!!isNaN(l.maxValue)||R<=l.maxValue)&&(F=R),(isNaN(M)||L<M)&&(!!isNaN(l.minValue)||L>=l.minValue)&&(M=L),isNaN(O)||!u||m||(O>b?D+=O:O<b&&(T+=O))}if(h||(!isNaN(l.maxValue)&&(D=t(l.maxValue,D)),!isNaN(l.minValue)&&(T=r(l.minValue,T))),d&&h)for(let t=0;t<s.series.length;t++){if(!this._isSerieVisible(W,t)){S=.01;continue}var O=this._getDataValueAsNumber(e,s.series[t].dataField,W);if(isNaN(O)||0>=O){S=.01;continue}var j=0===D?0:O/D;(isNaN(S)||j<S)&&(S=j)}var p=D-T;w<p&&(w=p),h&&(X.psums[e]=D,X.nsums[e]=T),(F>f||isNaN(f))&&(f=F),(M<c||isNaN(c))&&(c=M),(D>x||isNaN(x))&&(x=D),(T<_||isNaN(_))&&(_=T)}h&&(x=0===x?0:r(x,-_),_=0===_?0:t(_,-x)),c===f&&(!isNaN(l.minValue)&&isNaN(l.maxValue)?(c=l.minValue,f=d?c*g:c+1):isNaN(l.minValue)&&!isNaN(l.maxValue)&&(f=l.maxValue,c=d?f/g:f-1)),c===f&&(0===c?(c=-1,f=1):0>c?f=0:d?1===c&&(c/=g,f*=g):c=0);var z={gmin:c,gmax:f,gsumP:x,gsumN:_,gbase:b,isLogAxis:d,logBase:g,minPercent:S,gMaxRange:w,isStacked:u,isStacked100:h,isWaterfall:m,hasStackValueReversal:v,valueAxis:l,valueAxisSize:i};z.isStacked&&(0>z.gsumN&&(z.gmin=t(z.gmin,z.gbase+z.gsumN)),0<z.gsumP&&(z.gmax=r(z.gmax,z.gbase+z.gsumP))),X.context=z}this._mergeCommonValueAxisStats();for(let t=0,i;t<n.seriesGroups.length;t++)if(i=n.seriesGroups[t],i.isValid){var W=this._calcOutputGroupStats(i.context);for(let e in W)i[e]=W[e];delete i.context}}_mergeCommonValueAxisStats(){var e={};for(let r=0;r<this.seriesGroups.length;r++)if(this._isGroupVisible(r)&&!this.seriesGroups[r].valueAxis){var t=this._stats.seriesGroups[r].context;e.gbase=t.gbase,(isNaN(e.gmin)||t.gmin<e.gmin)&&(e.gmin=t.gmin),(isNaN(e.gmax)||t.gmax>e.gmax)&&(e.gmax=t.gmax),(isNaN(e.gsumP)||t.gsumP>e.gsumP)&&(e.gsumP=t.gsumP),(isNaN(e.gsumN)||t.gsumN<e.gsumN)&&(e.gsumN=t.gsumN),(isNaN(e.logBase)||t.logBase<e.logBase)&&(e.logBase=t.logBase),(isNaN(e.minPercent)||t.minPercent<e.minPercent)&&(e.minPercent=t.minPercent),0<e.gsumN&&(e.gmin=Math.min(e.gmin,e.gbase+e.gsumN)),0<e.gsumP&&(e.gmax=Math.max(e.gmax,e.gbase+e.gsumP))}for(let t=0;t<this.seriesGroups.length;t++)if(!this.seriesGroups[t].valueAxis){var i=this._stats.seriesGroups[t].context;for(var r in e)i[r]=e[r]}}_calcOutputGroupStats(e){var t=Math.pow,i=Math.max,r=e.gmin,n=e.gmax,s=e.gsumP,a=e.gsumN,l=e.gbase,o=e.isLogAxis,d=e.logBase,g=e.minPercent,u=e.gMaxRange,h=e.isStacked,y=e.isStacked100,m=e.isWaterfall,c=e.hasStackValueReversal,f=e.valueAxis,x=e.valueAxisSize,_=e.valueAxis.unitInterval;_||(_=this._calcInterval(r,n,i(x/80,2))),r===n&&(r=l,n=2*n);var b=NaN,v=0,A=0;if(o){if(y){b=0;var w=1;for(v=A=this._draw.log(100,d);w>g;)w/=d,v--,b++;r=t(d,v)}else h&&!m&&(n=i(n,s)),A=this.renderer._rnd(this._draw.log(n,d),1,!0),n=t(d,A),v=this.renderer._rnd(this._draw.log(r,d),1,!1),r=t(d,v);_=d}r<a&&(a=r),n>s&&(s=n);var S=r,C=n;if(o||0==Math.abs(C-S)%_||(S=this.renderer._rnd(r,_,!1),C=this.renderer._rnd(n,_,!0)),y&&100<C&&(C=100),y&&!o&&(C=0<C?100:0,S=0>S?-100:0,_=f.unitInterval,(isNaN(_)||0>=_||100<=_)&&(_=10),0!=100%_))for(;1<=_&&0!=100%_;_--);if(isNaN(C)||isNaN(S)||isNaN(_))return{};if(isNaN(b)&&(b=parseInt(((C-S)/(0===_?1:_)).toFixed())),o&&!y&&(b=A-v,u=t(d,b)),1>b)return{};var k={min:S,max:C,logarithmic:o,logBase:d,base:o?S:l,minPow:v,maxPow:A,sumP:s,sumN:a,mu:_,maxRange:u,intervals:b,hasStackValueReversal:c};return k}_getDataLen(e){var t=this.dataSource;return void 0!==e&&null!==e&&-1!==e&&this.seriesGroups[e].dataSource&&(t=this.seriesGroups[e].dataSource),t?t.length:0}_getDataValue(e,t,i){var r=this.dataSource;return void 0!==i&&null!==i&&-1!==i&&(r=this.seriesGroups[i].dataSource||r),!r||0>e||e>r.length-1?void 0:"function"==typeof t?t(e,r):t&&""!==t?r[e][t]:r[e]}_getDataValueAsNumber(e,t,i){var r=this._getDataValue(e,t,i);return this._isDate(r)?r.valueOf():("number"!=typeof r&&(r=parseFloat(r)),"number"!=typeof r&&(r=void 0),r)}_isPieGroup(e){var t=this.seriesGroups[e];return!!(t&&t.type)&&(-1!==t.type.indexOf("pie")||-1!==t.type.indexOf("donut"))}_renderPieSeries(e,t){var r=this._getDataLen(e),i=this.seriesGroups[e],n=this._calcGroupOffsets(e,t).offsets;for(let x=0;x<i.series.length;x++){var a=i.series[x];if(!a.customDraw){var s=this._getSerieSettings(e,x),l=this._getAnimProps(e,x),o=l.enabled&&5e3>r&&!this._isToggleRefresh&&l.duration;this._isTouchDevice&&this.renderer instanceof Smart.Utilities.HTML5Renderer&&(o=0);var d=this._get([a.minAngle,a.startAngle]);(isNaN(d)||0>d||360<d)&&(d=0);var g=this._get([a.maxAngle,a.endAngle]);(isNaN(g)||0>g||360<g)&&(g=360);var u={rect:t,minAngle:d,maxAngle:g,groupIndex:e,serieIndex:x,settings:s,items:[]};for(let t=0;t<r;t++){var p=n[x][t];if(p.visible){var h=p.fromAngle,y=p.toAngle,m=this.renderer.pieslice(p.x,p.y,p.innerRadius,p.outerRadius,h,0===o?y:h,p.centerOffset);this._setRenderInfo(e,x,t,{element:m});var c={displayValue:p.displayValue,itemIndex:t,visible:p.visible,x:p.x,y:p.y,innerRadius:p.innerRadius,outerRadius:p.outerRadius,fromAngle:h,toAngle:y,centerOffset:p.centerOffset};u.items.push(c)}}this._animatePieSlices(u,0);var f=this;this._enqueueAnimation("series",void 0,void 0,o,function(e,t,i){f._animatePieSlices(t,i)},u)}}}_sliceSortFunction(e,t){return e.fromAngle-t.fromAngle}_animatePieSlices(e,t){var r;this._elementRenderInfo&&this._elementRenderInfo.length>e.groupIndex&&this._elementRenderInfo[e.groupIndex].series&&this._elementRenderInfo[e.groupIndex].series.length>e.serieIndex&&(r=this._elementRenderInfo[e.groupIndex].series[e.serieIndex]);var n=this._getLabelsSettings(e.groupIndex,e.serieIndex,NaN),s=n.visible,a=[];for(let n=0;n<e.items.length;n++){const s=e.items[n];if(!s.visible)continue;let d=s.fromAngle;var l=s.fromAngle+t*(s.toAngle-s.fromAngle);if(r&&r[s.displayValue]){var i=r[s.displayValue].fromAngle,o=r[s.displayValue].toAngle;d=i+(d-i)*t,l=o+(l-o)*t}a.push({index:n,from:d,to:l})}r&&a.sort(this._sliceSortFunction);var d=NaN;for(let o=0;o<a.length;o++){const i=e.items[a[o].index];var g=this._getRenderInfo(e.groupIndex,e.serieIndex,i.itemIndex);let y=a[o].from;var l=a[o].to;r&&(!isNaN(d)&&y>d&&(y=d),d=l,o==a.length-1&&l!==a[0].from&&(l=e.maxAngle+a[0].from));var u=this.renderer.pieSlicePath(i.x,i.y,i.innerRadius,i.outerRadius,y,l,i.centerOffset);this.renderer.attr(g.element,{d:u});var p=this._getColors(e.groupIndex,e.serieIndex,i.itemIndex,"radialGradient",i.outerRadius),h=e.settings;g.colors=p,g.settings=h,this.renderer.attr(g.element,{fill:p.fillColor,stroke:p.lineColor,"stroke-width":h.stroke,"fill-opacity":h.opacity,"stroke-opacity":h.opacity,"stroke-dasharray":"none"}),s&&this._showPieLabel(e.groupIndex,e.serieIndex,i.itemIndex,n,void 0,g.colors.lineColor),1===t&&this._installHandlers(g.element,"pieslice",e.groupIndex,e.serieIndex,i.itemIndex)}}_showPieLabel(e,t,i,r,n){var a=Math.pow,l=this._renderData[e].offsets[t][i];if(l.elementInfo.labelElement&&this.renderer.removeElement(l.elementInfo.labelElement),r||(r=this._getLabelsSettings(e,t,NaN)),!!r.visible){var o=l.fromAngle,d=l.toAngle,u=Math.abs(o-d);360<u&&(o=0,d=360);var p=u/2+o;p%=360;var h=2*(p*Math.PI)/360,y;!0===r.autoRotate&&(y=90>p||270<p?360-p:180-p);var m=r.linesEnabled,c=this._showLabel(e,t,i,{x:0,y:0,width:0,height:0},"center","center",!0,!1,!1,y),f=r.radius||l.outerRadius+Math.max(c.width,c.height);this._isPercent(f)&&(f=parseFloat(f)/100*Math.min(this._plotRect.width,this._plotRect.height)/2),f+=l.centerOffset,isNaN(n)&&(n=0),f+=n;var x=this.seriesGroups[e],g=x.series[t],s=this._draw.getNum([g.offsetX,x.offsetX,this._plotRect.width/2]),_=this._draw.getNum([g.offsetY,x.offsetY,this._plotRect.height/2]),b=this._plotRect.x+s,v=this._plotRect.y+_,A=this._adjustTextBoxPosition(b,v,c,f,p,l.outerRadius>f,!1!==r.linesAngles,!0===r.autoRotate);const S={},C=A.x<b?0:c.width/2,k=Math.sqrt(a(A.x-b,2)+a(A.y-v,2))+C<l.outerRadius?arguments[5]:void 0;if(l.elementInfo.labelElement=this._showLabel(e,t,i,{x:A.x,y:A.y,width:c.width,height:c.height},"left","top",!1,!1,!1,y,S,k),f>l.outerRadius+n+5&&!1!==m){var w={lineColor:l.elementInfo.colors.lineColor,stroke:l.elementInfo.settings.stroke,opacity:l.elementInfo.settings.opacity,dashStyle:l.elementInfo.settings.dashStyle};l.elementInfo.labelArrowPath=this._updateLebelArrowPath(l.elementInfo.labelArrowPath,b,v,f,l.outerRadius+n,h,!1!==r.linesAngles,w,S)}}}_updateLebelArrowPath(e,t,i,r,n,s,a,l,o){var d=Math.sin,g=Math.cos,u=Math.abs;const p=this.renderer;var h=p._ptrnd(t+(r-0)*g(s)),y=p._ptrnd(i-(r-0)*d(s)),m=p._ptrnd(t+(n+2)*g(s)),c=p._ptrnd(i-(n+2)*d(s)),f=[];f.push({x:o.x+o.width/2,y:o.y}),f.push({x:o.x+o.width/2,y:o.y+o.height}),f.push({x:o.x,y:o.y+o.height/2}),f.push({x:o.x+o.width,y:o.y+o.height/2}),a||(f.push({x:o.x,y:o.y}),f.push({x:o.x+o.width,y:o.y}),f.push({x:o.x+o.width,y:o.y+o.height}),f.push({x:o.x,y:o.y+o.height})),f=f.sort(function(e,r){return p._ptdist(e.x,e.y,t,i)-p._ptdist(r.x,r.y,t,i)}),f=f.sort(function(e,r){return u(e.x-t)+u(e.y-i)-(u(r.x-t)+u(r.y-i))});for(let d=0;d<f.length;d++)f[d].x=p._ptrnd(f[d].x),f[d].y=p._ptrnd(f[d].y);h=f[0].x,y=f[0].y;var x="M "+h+","+y+" L"+m+","+c;return a&&(x="M "+h+","+y+" L"+m+","+y+" L"+m+","+c),e?p.attr(e,{d:x}):e=p.path(x,{}),p.attr(e,{fill:"none",stroke:l.lineColor,"stroke-width":l.stroke,"stroke-opacity":l.opacity,"stroke-dasharray":"none"}),e}_adjustTextBoxPosition(e,t,i,r,n,s,l,o){var d=Math.sin,g=Math.cos,u=Math.PI,p=2*(n*u)/360;let m=this.renderer._ptrnd(e+r*g(p)),c=this.renderer._ptrnd(t-r*d(p));if(o){var f=i.width,_=i.height,h=Math.atan(_/f)%(2*u),b=p%(2*u),a=0;b<=h?a=f/2*g(p):b>=h&&b<u-h?a=_/2*d(p):b>=u-h&&b<u+h?a=f/2*g(p):b>=u+h&&b<2*u-h?a=_/2*d(p):b>=2*u-h&&b<2*u&&(a=f/2*g(p)),r+=Math.abs(a)+3;let n=this.renderer._ptrnd(e+r*g(p)),s=this.renderer._ptrnd(t-r*d(p));return n-=i.width/2,s-=i.height/2,{x:n,y:s}}return s?(m-=i.width/2,c-=i.height/2):l?90<=n&&270>n?(c-=i.height/2,m-=i.width):c-=i.height/2:0<=n&&45>n||315<=n&&360>n?c-=i.height/2:45<=n&&135>n?(c-=i.height,m-=i.width/2):135<=n&&225>n?(c-=i.height/2,m-=i.width):225<=n&&315>n&&(m-=i.width/2),{x:m,y:c}}_isColumnType(e){return-1!==e.indexOf("column")||-1!==e.indexOf("waterfall")}_getColumnGroupsCount(e){var t=0;e=e||"vertical";var r=this.seriesGroups;for(let s=0;s<r.length;s++){var n=r[s].orientation||"vertical";this._isColumnType(r[s].type)&&n===e&&t++}return this.columnSeriesOverlap&&(t=1),t}_getColumnGroupIndex(e){var t=0,r=this.seriesGroups[e].orientation||"vertical";for(let a=0;a<e;a++){var n=this.seriesGroups[a],s=n.orientation||"vertical";this._isColumnType(n.type)&&s===r&&t++}return t}_renderAxisBands(e,t,r){var i=Math.sin,n=Math.cos,s=Math.PI,a=Math.min,l=Math.round,o=r?this._getXAxis(e):this._getValueAxis(e),d=this.seriesGroups[e],g=r?void 0:d.bands;if(!g){for(let t=0;t<e;t++){var u=r?this._getXAxis(t):this._getValueAxis(t);if(u===o)return}g=o.bands}if(Array.isArray(g)){var p=t,h="horizontal"===d.orientation;h&&(p={x:t.y,y:t.x,width:t.height,height:t.width}),this._calcGroupOffsets(e,p);for(let o=0;o<g.length;o++){var y=g[o],m=y.minValue,c=y.maxValue,f=r?this.getXAxisDataPointOffset(m,e):this.getValueAxisDataPointOffset(m,e),x=r?this.getXAxisDataPointOffset(c,e):this.getValueAxisDataPointOffset(c,e);if(!(isNaN(f)||isNaN(x))){var _=Math.abs(f-x),b;if(d.polar||d.spider){var v=this._renderData[e],A=v.polarCoords;if(!r){var w=this._toPolarCoord(A,t,t.x,v.baseOffset),S=this._toPolarCoord(A,t,t.x,f),C=this._toPolarCoord(A,t,t.x,x),I=this.renderer._ptdist(w.x,w.y,S.x,S.y),M=this.renderer._ptdist(w.x,w.y,C.x,C.y),F=l(360*-A.startAngle/(2*s)),D=l(360*-A.endAngle/(2*s));if(F>D){const e=F;F=D,D=e}if(d.spider){var T=v.xAxis.offsetAngles;let e="";var O=[M,I],R=T;for(var L in A.isClosedCircle&&(R=T.slice(0),R.push(R[0])),O){for(let t=0;t<R.length;t++){var k=0===L?t:T.length-t-1,P=A.x+O[L]*n(R[k]),G=A.y+O[L]*i(R[k]);e+=""==e?"M ":" L",e+=this.renderer._ptrnd(P)+","+this.renderer._ptrnd(G)}if(0===L){var P=A.x+O[1]*n(R[k]),G=A.y+O[1]*i(R[k]);e+=" L"+this.renderer._ptrnd(P)+","+this.renderer._ptrnd(G)}}e+=" Z",b=this.renderer.path(e)}else b=this.renderer.pieslice(A.x,A.y,I,M,F,D)}else if(d.spider){const t=this.getPolarDataPointOffset(m,this._stats.seriesGroups[e].max,e),i=this.getPolarDataPointOffset(c,this._stats.seriesGroups[e].max,e);let r="M "+A.x+","+A.y;r+=" L "+t.x+","+t.y,r+=" L "+i.x+","+i.y,b=this.renderer.path(r)}else{var V={},E={x:a(f,x),y:t.y,width:_,height:t.height};this._columnAsPieSlice(V,t,A,E),b=V.element}}else{var B={x:a(f,x),y:p.y,width:_,height:p.height};if(r||(B={x:p.x,y:a(f,x),width:p.width,height:_}),h){let e=B.x;B.x=B.y,B.y=e,e=B.width,B.width=B.height,B.height=e}b=0===_||1===_?this.renderer.line(this.renderer._ptrnd(B.x),this.renderer._ptrnd(B.y),this.renderer._ptrnd(B.x+(h?0:B.width)),this.renderer._ptrnd(B.y+(h?B.height:0))):this.renderer.rect(B.x,B.y,B.width,B.height)}var H=y.color||this._getThemeColor("band"),j=y.lineColor||H,z=y.lineWidth;isNaN(z)&&(z=1);var W=y.opacity;(isNaN(W)||0>W||1<W)&&(W=1),this.renderer.attr(b,{fill:H,"fill-opacity":W,stroke:j,"stroke-opacity":W,"stroke-width":z,"stroke-dasharray":y.dashStyle})}}}}_getColumnGroupWidth(e,t,i){var r=Math.max,n=this.seriesGroups[e],s=-1!==n.type.indexOf("stacked"),a=this._getColumnGroupsCount(n.orientation);(isNaN(a)||0===a)&&(a=1);var l=1<=t.rangeLength?t.itemWidth:.9*i,o=n.columnsMinWidth;isNaN(o)&&(o=1),isNaN(n.columnsMaxWidth)||(o=Math.min(n.columnsMaxWidth,o)),o>l&&0<t.length&&(l=r(l,.9*i/t.length));var d=o;if(!s){var g=n.seriesGapPercent;(isNaN(g)||0>g)&&(g=10),g/=100;var u=o;u*=1+g,d+=n.series.length*u}var p=r(l/a,d);return{requiredWidth:d,availableWidth:l,targetWidth:p}}_getColumnSerieWidthAndOffset(e,t){var i=Math.round,r=Math.max,n=this.seriesGroups[e],s="horizontal"===n.orientation,a=this._plotRect;s&&(a={x:a.y,y:a.x,width:a.height,height:a.width});var l=this._calcGroupOffsets(e,a);if(l&&0!==l.xoffsets.length){var o=this._getColumnGroupsCount(n.orientation);("candlestick"===n.type||"ohlc"===n.type)&&(o=1);var d=this._getColumnGroupIndex(e),g=this._getColumnGroupWidth(e,l.xoffsets,s?a.height:a.width),u=0,p=g.targetWidth;(!0===this.columnSeriesOverlap||i(p)>i(g.availableWidth/o))&&(o=1,d=0),u-=p*o/2,u+=p*d;var h=n.columnsGapPercent;0>=h&&(h=0),(isNaN(h)||100<=h)&&(h=25),h/=100;var y=p*h;y+g.requiredWidth>g.targetWidth&&(y=r(0,g.targetWidth-g.requiredWidth)),i(p)>i(g.availableWidth)&&(y=0),p-=y,u+=y/2;var m=n.seriesGapPercent;(isNaN(m)||0>m)&&(m=10);var c=-1!==n.type.indexOf("stacked"),f=p;c||(f/=n.series.length);var x=this._get([n.seriesGap,p*m/100/(n.series.length-1)]);(!0===n.polar||!0===n.spider||c||1>=n.series.length)&&(x=0);var _=x*(n.series.length-1);1<n.series.length&&_>p-1*n.series.length&&(_=p-1*n.series.length,x=_/r(1,n.series.length-1));var b=f-_/n.series.length,v=0,A=n.columnsMaxWidth;!isNaN(A)&&b>A&&(v=b-A,b=A);var w=0;if(!c){var S=(p-b*n.series.length-_)/2,C=r(0,t);w=S+b*t+C*x}else w=v/2;return{width:b,offset:u+w}}}_renderColumnSeries(e,t){var i=this.seriesGroups[e];if(i.series&&0!==i.series.length){var r="horizontal"===i.orientation,n=t;r&&(n={x:t.y,y:t.x,width:t.height,height:t.width});var a=this._calcGroupOffsets(e,n);if(a&&0!==a.xoffsets.length){var l;(!0===i.polar||!0===i.spider)&&(l=this._getPolarAxisCoords(e,n));var o={groupIndex:e,rect:t,vertical:!r,seriesCtx:[],renderData:a,polarAxisCoords:l,columnGroupWidth:this._getColumnGroupWidth(e,a.xoffsets,r?n.height:n.width)},d=this._getGroupGradientType(e);for(let t=0;t<i.series.length;t++){var g=i.series[t];if(!g.customDraw){var s=this._getAnimProps(e,t),u=s.enabled&&!this._isToggleRefresh&&100>a.xoffsets.length?s.duration:0,p=this._getColumnSerieWidthAndOffset(e,t),h=this._isSerieVisible(e,t),y=this._getSerieSettings(e,t),m=this._getColors(e,t,NaN,this._getGroupGradientType(e),4),c=[];if("function"==typeof g.colorFunction&&!l)for(let r=a.xoffsets.first;r<=a.xoffsets.last;r++)c.push(this._getColors(e,t,r,d,4));var f={seriesIndex:t,serieColors:m,itemsColors:c,settings:y,columnWidth:p.width,xAdjust:p.offset,isVisible:h};o.seriesCtx.push(f)}}this._animColumns(o,0===u?1:0);var x=this;this._enqueueAnimation("series",void 0,void 0,u,function(e,t,i){x._animColumns(t,i)},o)}}}_getPercent(e,t,i,r){return isNaN(e)&&(e=t),isNaN(i)||isNaN(e)||!(e<i)||(e=i),isNaN(r)||isNaN(e)||!(e>r)||(e=r),isNaN(e)?NaN:e}_getColumnVOffsets(e,t,r,i,n,s){var a=Math.abs,l=Math.min,o=Math.max,d=this.seriesGroups[t],g=this._getPercent(d.columnsTopWidthPercent,100,0,100),u=this._getPercent(d.columnsBottomWidthPercent,100,0,100);0===g&&0===u&&(u=100);var p=this._getPercent(d.columnsNeckHeightPercent,NaN,0,100)/100,h=this._getPercent(d.columnsNeckWidthPercent,100,0,100)/100,y=[],m=NaN;for(let a=0;a<r.length;a++){var c=r[a],f=c.seriesIndex,x=e.offsets[f][i].from,_=e.offsets[f][i].to,b=e.xoffsets.data[i],v=c.isVisible,A;v||(_=x);var w=this._elementRenderInfo;if(v&&w&&w.length>t&&w[t].series.length>f){var S=e.xoffsets.xvalues[i];A=w[t].series[f][S],!A||isNaN(A.from)||isNaN(A.to)||(x=A.from+(x-A.from)*s,_=A.to+(_-A.to)*s,b=A.xoffset+(b-A.xoffset)*s)}A||(_=x+(_-x)*(n?1:s)),isNaN(x)&&(x=isNaN(m)?e.baseOffset:m),m=!isNaN(_)&&n?_:x,isNaN(_)&&(_=x);var C={from:x,to:_,xOffset:b};(100!==g||100!==u)&&(C.funnel=!0,C.toWidthPercent=g,C.fromWidthPercent=u),y.push(C)}if(n&&1<y.length&&!(this._elementRenderInfo&&this._elementRenderInfo.length>t)){var k=0,I=0,M=-Infinity,F=1/0,D=1/0,T=-Infinity;for(let e=0;e<y.length;e++){var c=r[e];c.isVisible&&(y[e].to>=y[e].from?(I+=y[e].to-y[e].from,D=l(D,y[e].from),T=o(T,y[e].to)):(k+=y[e].from-y[e].to,M=o(M,y[e].from),F=l(F,y[e].to)))}var O=k,R=I;k*=s,I*=s;var L=0,P=0;for(let e=0;e<y.length;e++)if(y[e].to>=y[e].from){let t=y[e].to-y[e].from;t+P>I&&(t=o(0,I-P),y[e].to=y[e].from+t),(100!==g||100!==u)&&(y[e].funnel=!0,y[e].fromWidthPercent=!isNaN(p)&&R*p>=P?100*h:a(y[e].from-D)/R*(g-u)+u,y[e].toWidthPercent=!isNaN(p)&&R*p>=0+(P+t)?100*h:a(y[e].to-D)/R*(g-u)+u),P+=t}else{let t=y[e].from-y[e].to;t+L>k&&(t=o(0,k-L),y[e].to=y[e].from-t),(100!==g||100!==u)&&(y[e].funnel=!0,y[e].fromWidthPercent=!isNaN(p)&&O*p>=L?100*h:a(y[e].from-M)/O*(g-u)+u,y[e].toWidthPercent=!isNaN(p)&&O*p>=0+(L+t)?100*h:a(y[e].to-M)/O*(g-u)+u),L+=t}}return y}_columnAsPieSlice(e,t,i,r){var n=Math.PI,s=this._toPolarCoord(i,t,r.x,r.y),a=this._toPolarCoord(i,t,r.x,r.y+r.height),l=this.renderer._ptdist(i.x,i.y,a.x,a.y),o=this.renderer._ptdist(i.x,i.y,s.x,s.y),d=t.width,g=180*Math.abs(i.startAngle-i.endAngle)/n,u=-((r.x-t.x)*g)/d,p=-((r.x+r.width-t.x)*g)/d,h=i.startAngle;if(h=360*h/(2*n),u-=h,p-=h,e)if(void 0!==e.element&&null!==e.element){var y=this.renderer.pieSlicePath(i.x,i.y,l,o,p,u,0);y+=" Z",this.renderer.attr(e.element,{d:y})}else e.element=this.renderer.pieslice(i.x,i.y,l,o,p,u,0);return{fromAngle:p,toAngle:u,innerRadius:l,outerRadius:o}}_setRenderInfo(e,t,i,r){this._renderData[e].offsets[t][i].elementInfo=r}_getRenderInfo(e,t,i){return this._renderData[e].offsets[t][i].elementInfo||{}}_animColumns(e,t){var r=Math.abs,n=this,s=e.groupIndex,a=this.seriesGroups[s],l=e.renderData,o=-1!==a.type.indexOf("waterfall"),i=this._getXAxis(s),d=-1!==a.type.indexOf("stacked"),g=e.polarAxisCoords,u=-1;for(let i=0;i<a.series.length;i++)if(this._isSerieVisible(s,i)){u=i;break}var p=NaN,h=NaN;for(let i=0;i<e.seriesCtx.length;i++){var y=e.seriesCtx[i];(isNaN(p)||p>y.xAdjust)&&(p=y.xAdjust),(isNaN(h)||h<y.xAdjust+y.columnWidth)&&(h=y.xAdjust+y.columnWidth)}var m=r(h-p),c=this._get([a.columnsGapPercent,25])/100;(0>isNaN(c)||1<=c)&&(c=.25);var f=c*m,_=e.renderData.xoffsets,b=-1,v={},A=!0===a.skipOverlappingPoints;for(let p=_.first;p<=_.last;p++){var w=_.data[p];if(!isNaN(w)){if(-1!==b&&r(w-b)<m-1+f&&A)continue;else b=w;var S=this._getColumnVOffsets(l,s,e.seriesCtx,p,d,t),C=!1;if(o)for(let e=0;e<a.series.length;e++)a.series[e].summary&&_.xvalues[p][a.series[e].summary]&&(C=!0);for(let h=0;h<e.seriesCtx.length;h++){var y=e.seriesCtx[h],k=y.seriesIndex,I=a.series[k],M=S[h].from,F=S[h].to,D=S[h].xOffset,T=(e.vertical?e.rect.x:e.rect.y)+y.xAdjust,O=y.settings;let m=0===y.itemsColors.length?y.serieColors:y.itemsColors[p-l.xoffsets.first];var R=this._isSerieVisible(s,k);if(R){var w=this.renderer._ptrnd(T+D),L={x:w,width:y.columnWidth};S[h].funnel&&(L.fromWidthPercent=S[h].fromWidthPercent,L.toWidthPercent=S[h].toWidthPercent);var P=!0;e.vertical?(L.y=M,L.height=F-M,0>L.height&&(L.y+=L.height,L.height=-L.height,P=!1)):(L.x=M<F?M:F,L.width=r(M-F),P=0>M-F,L.y=w,L.height=y.columnWidth);var G=M-F;if(!isNaN(G)){G=r(G);var V=void 0,E=n._getRenderInfo(s,k,p),B=E.element,H=E.labelElement,j=void 0===B||null===B;if(H&&(n.renderer.removeElement(H),H=void 0),!!g){var z={element:B};V=this._columnAsPieSlice(z,e.rect,g,L),B=z.element,m=this._getColors(s,k,void 0,"radialGradient",V.outerRadius)}else if(S[h].funnel){var W=this._getTrapezoidPath(Object.assign({},L),e.vertical,P);j?B=this.renderer.path(W,{}):this.renderer.attr(B,{d:W})}else j?B=this.renderer.rect(L.x,L.y,e.vertical?L.width:0,e.vertical?0:L.height):!0===e.vertical?this.renderer.attr(B,{x:L.x,y:L.y,height:G}):this.renderer.attr(B,{x:L.x,y:L.y,width:G});if(1>G&&(1!==t||g)?this.renderer.attr(B,{display:"none"}):this.renderer.attr(B,{display:"block"}),j&&this.renderer.attr(B,{fill:m.fillColor,"fill-opacity":O.opacity,"stroke-opacity":O.opacity,stroke:m.lineColor,"stroke-width":O.stroke,"stroke-dasharray":O.dashStyle}),H&&this.renderer.removeElement(H),!R||0===G&&1>t){E={element:B,labelElement:H},n._setRenderInfo(s,k,p,E);continue}if(o&&!1!==this._get([I.showWaterfallLines,a.showWaterfallLines])){if(!d||d&&h===u){var X=d?-1:h;if(1===t&&!isNaN(l.offsets[h][p].from)&&!isNaN(l.offsets[h][p].to)){var N=v[X];if(void 0!==N&&null!==N){var U={x:N.x,y:this.renderer._ptrnd(N.y)},Y={x:w,y:U.y},Z=a.columnsTopWidthPercent/100;isNaN(Z)?Z=1:(1<Z||0>Z)&&(Z=1);var q=a.columnsBottomWidthPercent/100;isNaN(q)?q=1:(1<q||0>q)&&(q=1);var J=e.vertical?L.width:L.height;if(U.x=U.x-J/2+J/2*Z,C){let e=J*Z/2;Y.x=Y.x+J/2-(i.flip?-e:e)}else{let e=J*q/2;Y.x=Y.x+J/2-(i.flip?-e:e)}e.vertical||(this._swapXY([U]),this._swapXY([Y])),this.renderer.line(U.x,U.y,Y.x,Y.y,{stroke:N.color,"stroke-width":O.stroke,"stroke-opacity":O.opacity,"fill-opacity":O.opacity,"stroke-dasharray":O.dashStyle})}}}1===t&&0!==G&&(v[d?-1:h]={y:F,x:e.vertical?L.x+L.width:L.y+L.height,color:m.lineColor})}if(g){var J=this._showLabel(s,k,p,L,void 0,void 0,!0),K=V.outerRadius+10;const e=this._adjustTextBoxPosition(g.x,g.y,J,K,(V.fromAngle+V.toAngle)/2,!0,!1,!1);H=this._showLabel(s,k,p,{x:e.x,y:e.y},void 0,void 0,!1,!1,!1)}else H=this._showLabel(s,k,p,L,void 0,void 0,!1,!1,P);E={element:B,labelElement:H},n._setRenderInfo(s,k,p,E),1===t&&this._installHandlers(B,"column",s,k,p)}}}}}}_getTrapezoidPath(e,t,i){var r="",n=e.fromWidthPercent/100,s=e.toWidthPercent/100;if(!t){var a=e.width;e.width=e.height,e.height=a,a=e.x,e.x=e.y,e.y=a}var l=e.x+e.width/2,o=[{x:l-e.width*(i?s:n)/2,y:e.y+e.height},{x:l-e.width*(i?n:s)/2,y:e.y},{x:l+e.width*(i?n:s)/2,y:e.y},{x:l+e.width*(i?s:n)/2,y:e.y+e.height}];t||this._swapXY(o),r+="M "+this.renderer._ptrnd(o[0].x)+","+this.renderer._ptrnd(o[0].y);for(let n=1;n<o.length;n++)r+=" L "+this.renderer._ptrnd(o[n].x)+","+this.renderer._ptrnd(o[n].y);return r+=" Z",r}_swapXY(e){for(let r=0;r<e.length;r++){var t=e[r].x;e[r].x=e[r].y,e[r].y=t}}_renderCandleStickSeries(e,t,i){var r=this,n=r.seriesGroups[e];if(n.series&&0!==n.series.length){var a="horizontal"===n.orientation,l=t;a&&(l={x:t.y,y:t.x,width:t.height,height:t.width});var o=r._calcGroupOffsets(e,l);if(o&&0!==o.xoffsets.length){var d;(n.polar||n.spider)&&(d=r._getPolarAxisCoords(e,l));var g=r._getGroupGradientType(e),u=[];for(let t=0;t<n.series.length;t++)u[t]=r._getColumnSerieWidthAndOffset(e,t);for(let l=0;l<n.series.length;l++)if(this._isSerieVisible(e,l)){var p=r._getSerieSettings(e,l),h=n.series[l];if(!h.customDraw){var s="function"==typeof h.colorFunction?void 0:r._getColors(e,l,NaN,g),y={rect:t,inverse:a,groupIndex:e,seriesIndex:l,symbolType:h.symbolType,symbolSize:h.symbolSize,"fill-opacity":p.opacity,"stroke-opacity":p.opacity,"stroke-width":p.stroke,"stroke-dasharray":p.dashStyle,gradientType:g,colors:s,renderData:o,polarAxisCoords:d,columnsInfo:u,isOHLC:i,items:[],self:r},m=r._getAnimProps(e,l),c=m.enabled&&!r._isToggleRefresh&&5e3>o.xoffsets.length?m.duration:0;r._animCandleStick(y,0),r._enqueueAnimation("series",void 0,void 0,c,function(e,t,i){r._animCandleStick(t,i)},y)}}}}}_animCandleStick(e,t){var r=Math.abs,i=Math.min,n=["Open","Low","Close","High"],s=e.columnsInfo[e.seriesIndex].width,a=e.self.seriesGroups[e.groupIndex],l=e.renderData.xoffsets,o=-1,d=r(l.data[l.last]-l.data[l.first]);d*=t;var g=NaN,u=NaN;for(let i=0;i<e.columnsInfo.length;i++){var p=e.columnsInfo[i];(isNaN(g)||g>p.offset)&&(g=p.offset),(isNaN(u)||u<p.offset+p.width)&&(u=p.offset+p.width)}var h=r(u-g),m=!1!==a.skipOverlappingPoints;for(let g=l.first;g<=l.last;g++){var c=l.data[g];if(!isNaN(c)&&!(-1!==o&&r(c-o)<h&&m)){var f=r(l.data[g]-l.data[l.first]);if(f>d)break;o=c;var _=e.items[g]=e.items[g]||{};for(let t in n){var b=e.self._getDataValueAsNumber(g,a.series[e.seriesIndex]["dataField"+n[t]],e.groupIndex);if(isNaN(b))break;var v=e.renderData.offsets[e.seriesIndex][g][n[t]];if(isNaN(v))break;_[n[t]]=v}if(c+=e.inverse?e.rect.y:e.rect.x,e.polarAxisCoords){var A=this._toPolarCoord(e.polarAxisCoords,this._plotRect,c,v);c=A.x,v=A.y}for(var w in c=this.renderer._ptrnd(c),n)_[w]=this.renderer._ptrnd(_[w]);var S=e.colors;if(S||(S=e.self._getColors(e.groupIndex,e.seriesIndex,g,e.gradientType)),!e.isOHLC){var C=_.lineElement;C||(C=e.inverse?this.renderer.line(_.Low,c,_.High,c):this.renderer.line(c,_.Low,c,_.High),this.renderer.attr(C,{fill:S.fillColor,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:S.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),_.lineElement=C);var k=_.stickElement;if(c-=s/2,!k){var I=S.fillColor;_.Close<=_.Open&&S.fillColorAlt&&(I=S.fillColorAlt),k=e.inverse?this.renderer.rect(i(_.Open,_.Close),c,r(_.Close-_.Open),s):this.renderer.rect(c,i(_.Open,_.Close),s,r(_.Close-_.Open)),this.renderer.attr(k,{fill:I,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:S.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),_.stickElement=k}1===t&&this._installHandlers(k,"column",e.groupIndex,e.seriesIndex,g)}else{var M="M"+c+","+_.Low+" L"+c+","+_.High+" M"+(c-s/2)+","+_.Open+" L"+c+","+_.Open+" M"+(c+s/2)+","+_.Close+" L"+c+","+_.Close;e.inverse&&(M="M"+_.Low+","+c+" L"+_.High+","+c+" M"+_.Open+","+(c-s/2)+" L"+_.Open+","+c+" M"+_.Close+","+c+" L"+_.Close+","+(c+s/2));var C=_.lineElement;C||(C=this.renderer.path(M,{}),this.renderer.attr(C,{fill:S.fillColor,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:S.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),_.lineElement=C),1===t&&this._installHandlers(C,"column",e.groupIndex,e.seriesIndex,g)}}}}_renderScatterSeries(e,t,n){var a=Math.max,i=this.seriesGroups[e];if(i.series&&0!==i.series.length){var l=-1!==i.type.indexOf("bubble"),o="horizontal"===i.orientation,d=t;o&&(d={x:t.y,y:t.x,width:t.height,height:t.width});var g=this._calcGroupOffsets(e,d);if(g&&0!==g.xoffsets.length){var u=d.width,p;(i.polar||i.spider)&&(p=this._getPolarAxisCoords(e,d),u=2*p.r);var h=this._getGroupGradientType(e);n||(n="to");for(let r=0;r<i.series.length;r++){var m=this._getSerieSettings(e,r),c=i.series[r];if(!c.customDraw){var s=c.dataField,f="function"==typeof c.colorFunction,_=this._getColors(e,r,NaN,h),b=NaN,v=NaN;if(l)for(let t=g.xoffsets.first;t<=g.xoffsets.last;t++){var A=this._getDataValueAsNumber(t,c.radiusDataField||c.sizeDataField,e);"number"!=typeof A&&this.error(this.localize("invalidRadiusDataField",{index:t})),isNaN(A)||((isNaN(b)||A<b)&&(b=A),(isNaN(v)||A>v)&&(v=A))}var w=c.minRadius||c.minSymbolSize;isNaN(w)&&(w=u/50);var S=c.maxRadius||c.maxSymbolSize;isNaN(S)&&(S=u/25),w>S&&(S=w);var C=c.radius;C=isNaN(C)&&!isNaN(c.symbolSize)?"circle"===c.symbolType?c.symbolSize/2:c.symbolSize:5;var k=this._getAnimProps(e,r),I=k.enabled&&!this._isToggleRefresh&&5e3>g.xoffsets.length?k.duration:0,M={groupIndex:e,seriesIndex:r,symbolType:c.symbolType,symbolSize:c.symbolSize,"fill-opacity":m.opacity,"stroke-opacity":m.opacity,"stroke-width":m.stroke,"stroke-width-symbol":m.strokeSymbol,"stroke-dasharray":m.dashStyle,items:[],polarAxisCoords:p},F=void 0;for(let u=g.xoffsets.first;u<=g.xoffsets.last;u++){var A=this._getDataValueAsNumber(u,s,e);if("number"==typeof A){var D=g.xoffsets.data[u],T=g.xoffsets.xvalues[u],O=g.offsets[r][u][n];if(!(O<d.y||O>d.y+d.height)&&!(isNaN(D)||isNaN(O))){if(o){var R=D;D=O,O=R+t.y}else D+=t.x;if(!(!f&&F&&this.enableSampling&&1>this.renderer._ptdist(F.x,F.y,D,O))){F={x:D,y:O};var L=C;if(l){var P=this._getDataValueAsNumber(u,c.radiusDataField||c.sizeDataField,e);if("number"!=typeof P)continue;L=w+(S-w)*(P-b)/a(1,v-b),isNaN(L)&&(L=w)}g.offsets[r][u].radius=L;var G=NaN,V=NaN,E=0,B=this._elementRenderInfo;if(void 0!==T&&null!==T&&B&&B.length>e&&B[e].series.length>r){var H=B[e].series[r][T];if(H&&!isNaN(H.to)){if(G=H.to,V=H.xoffset,E=C,o){var R=V;V=G,G=R+t.y}else V+=t.x;l&&(E=w+(S-w)*(H.valueRadius-b)/a(1,v-b),isNaN(E)&&(E=w))}}f&&(_=this._getColors(e,r,u,h)),M.items.push({from:E,to:L,itemIndex:u,fill:_.fillColor,stroke:_.lineColor,x:D,y:O,xFrom:V,yFrom:G})}}}}this._animR(M,0);var j=this;this._enqueueAnimation("series",void 0,void 0,I,function(e,t,i){j._animR(t,i)},M)}}}}}_animR(e,t){var n=e.items,s=e.symbolType||"circle",a=e.symbolSize;for(let r=0;r<n.length;r++){var l=n[r],o=l.x,d=l.y,g=Math.round((l.to-l.from)*t+l.from);if(isNaN(l.yFrom)||(d=l.yFrom+(d-l.yFrom)*t),isNaN(l.xFrom)||(o=l.xFrom+(o-l.xFrom)*t),e.polarAxisCoords){var i=this._toPolarCoord(e.polarAxisCoords,this._plotRect,o,d);o=i.x,d=i.y}o=this.renderer._ptrnd(o),d=this.renderer._ptrnd(d),g=this.renderer._ptrnd(g);var u=this._getRenderInfo(e.groupIndex,e.seriesIndex,n[r].itemIndex),p=u.element,h=u.labelElement;"circle"===s?(!p&&(p=this.renderer.circle(o,d,g),this.renderer.attr(p,{fill:l.fill,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:l.stroke,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]})),this.renderer.attr(p,{r:g,cy:d,cx:o})):(p&&this.renderer.removeElement(p),p=this._drawSymbol(s,o,d,l.fill,e["fill-opacity"],l.stroke,e["stroke-opacity"]||e["fill-opacity"],e["stroke-width-symbol"],e["stroke-dasharray"],a||g)),h&&this.renderer.removeElement(h),h=this._showLabel(e.groupIndex,e.seriesIndex,l.itemIndex,{x:o-g,y:d-g,width:2*g,height:2*g}),1<=t&&this._installHandlers(p,"circle",e.groupIndex,e.seriesIndex,l.itemIndex),this._setRenderInfo(e.groupIndex,e.seriesIndex,n[r].itemIndex,{element:p,labelElement:h})}}_showMultiSeriesToolTip(e){var t=this,i="<div style='text-align:left'>",r="";for(let x=0;x<t.seriesGroups.length;x++)if(!t._isPieGroup(x)){var n=t._getXAxis(x),s=t._getValueAxis(x),a=t.seriesGroups[x],l=this._getAxisSettings(n),o=this._getFormatSettings(l,"toolTipFormatSettings"),d=l.toolTipFormatFunction,g=t._getDataValue(e,n.dataField,x);(n.dataField===void 0||null===n.dataField||""===n.dataField)&&(g=e),"date"===n.type&&(g=t._castAsDate(g,(o?o.dateFormat:void 0)||n.dateFormat)),d||o||"date"!==n.type||(d=this._getDefaultDTFormatFn(n.baseUnit||"day"));var u=n.displayText||n.dataField||"";""!==u&&(u+=": ");var p=u+t._formatValue(g,o,d,x,void 0,e);r!==p&&(""!==r&&(i+="<br />"),i+=p+"<br /><br />",r=p);for(let r=0;r<a.series.length;r++){var h=a.series[r];if(!1!==a.showToolTips&&!1!==h.showToolTips&&t._isSerieVisible(x,r)){var y=t._get([t._getFormatSettings(h,"toolTipFormatSettings"),t._getFormatSettings(a,"toolTipFormatSettings"),t._getFormatSettings(s,"toolTipFormatSettings"),t._getFormatSettings(t,"toolTipFormatSettings")]),m=t._get([h.toolTipFormatFunction,a.toolTipFormatFunction,s.toolTipFormatFunction,t.toolTipFormatFunction]),c=t._getFormattedValue(x,r,e,y,m),f=t._getColors(x,r,e);i+="<span style=\"color:"+f.lineColor+";\">"+c+"</span><br />\n"}}}var x=this._get([t.toolTipClass,"smart-chart-tooltip-text"]),_=this._get([t.toolTipBackground,t._getThemeColor("background")]),b=this._get([t.toolTipLineColor,t._getThemeColor("line")]),v=this._get([t.toolTipOpacity,1]);i+="</div>";var A=this.getItemCoord(t._ttEl.gidx,t._ttEl.sidx,t._ttEl.iidx);t._createTooltip(A,t.seriesGroups[t._ttEl.gidx],i,{css:x,fill:_,stroke:b,fillOpacity:v,symbolSize:3})}_showToolTip(e,i,r,n,s){var a=this,l=a._getXAxis(r),o=a._getValueAxis(r);if(!(a._ttEl&&r===a._ttEl.gidx&&n===a._ttEl.sidx&&s===a._ttEl.iidx)){var d=a.seriesGroups[r],g=d.series[n],u=a.enableCrosshairs;a._pointMarker?(e=parseInt(a._pointMarker.x+5),i=parseInt(a._pointMarker.y-5)):u=!1;var p=u&&!1===a.showToolTips;if(e=this.renderer._ptrnd(e),i=this.renderer._ptrnd(i),!1!==d.showToolTips&&!1!==g.showToolTips){a._ttEl||(a._ttEl={}),a._ttEl.sidx=n,a._ttEl.gidx=r,a._ttEl.iidx=s;var h=0;for(let e=0;e<a.seriesGroups.length;e++)for(let t=0;t<a.seriesGroups[e].series.length;t++)h++;if(u){var m=this.renderer._ptrnd(a._pointMarker.x),c=this.renderer._ptrnd(a._pointMarker.y),f=a.crosshairsColor||a._getThemeColor("line");if(d.polar||d.spider){var _=this._getPolarAxisCoords(r,this._plotRect),b=this.renderer._ptdist(m,c,_.x,_.y);if(b>_.r)return;var v=Math.atan2(c-_.y,m-_.x),A=Math.cos(v)*_.r+_.x,w=Math.sin(v)*_.r+_.y;a._ttEl.vLine?a.renderer.attr(a._ttEl.vLine,{x1:_.x,y1:_.y,x2:A,y2:w}):a._ttEl.vLine=a.renderer.line(_.x,_.y,A,w,{stroke:f,"stroke-width":a.crosshairsLineWidth||1,"stroke-dasharray":a.crosshairsDashStyle||""})}else a._ttEl.vLine&&a._ttEl.hLine?(a.renderer.attr(a._ttEl.vLine,{x1:m,x2:m}),a.renderer.attr(a._ttEl.hLine,{y1:c,y2:c})):(a._ttEl.vLine=a.renderer.line(m,a._plotRect.y,m,a._plotRect.y+a._plotRect.height,{stroke:f,"stroke-width":a.crosshairsLineWidth||1,"stroke-dasharray":a.crosshairsDashStyle||""}),a._ttEl.hLine=a.renderer.line(a._plotRect.x,c,a._plotRect.x+a._plotRect.width,c,{stroke:f,"stroke-width":a.crosshairsLineWidth||1,"stroke-dasharray":a.crosshairsDashStyle||""}))}if(a.showToolTipsOnAllSeries&&!a._isPieGroup(r)&&1<h)return void a._showMultiSeriesToolTip(s);var S=a._get([a._getFormatSettings(g,"toolTipFormatSettings"),a._getFormatSettings(d,"toolTipFormatSettings"),a._getFormatSettings(o,"toolTipFormatSettings"),a._getFormatSettings(a,"toolTipFormatSettings")]),C=a._get([g.toolTipFormatFunction,d.toolTipFormatFunction,o.toolTipFormatFunction,a.toolTipFormatFunction]),k=a._getColors(r,n,s),I=a._getDataValue(s,l.dataField,r);(void 0===l.dataField||null===l.dataField||""===l.dataField)&&(I=s),"date"===l.type&&(I=a._castAsDate(I,(S?S.dateFormat:void 0)||l.dateFormat));var M="";if("function"==typeof C){var F={},D=0;for(var T in g)0===T.indexOf("dataField")&&(F[T.substring(9,T.length).toLowerCase()]=a._getDataValue(s,g[T],r),D++);0===D?F=a._getDataValue(s,void 0,r):1===D&&(F=F[""]),M=C(F,s,g,d,I,l)}else{M=a._getFormattedValue(r,n,s,S,C);var O=this._getAxisSettings(l),R=a._getFormatSettings(O,"toolTipFormatSettings"),L=O.toolTipFormatFunction;L||R||"date"!==l.type||(L=this._getDefaultDTFormatFn(l.baseUnit||"day"));var P=a._formatValue(I,R,L,r,n,s);if(!a._isPieGroup(r)){var G=l.displayText||l.dataField||"";M=0<G.length?G+": "+P+"<br>"+M:P+"<br>"+M}else I=a._getDataValue(s,g.displayText||g.dataField,r),P=a._formatValue(I,R,L,r,n,s),M=P+": "+M}if(!p&&!1!==a.showToolTips){var t=this._get([g.toolTipClass,d.toolTipClass,a.toolTipClass,"smart-chart-tooltip-text"]),V=this._get([g.toolTipBackground,d.toolTipBackground,a.toolTipBackground,a._getThemeColor("background")]),E=this._get([g.toolTipLineColor,d.toolTipLineColor,a.toolTipLineColor,k.lineColor,a._getThemeColor("line")]),B=this._get([g.toolTipOpacity,d.toolTipOpacity,a.toolTipOpacity,1]),H=this.getItemCoord(r,n,s);H.y=Math.min(Math.max(H.y,this._plotRect.y),this._plotRect.y+this._plotRect.y+this._plotRect.height);var j=0;a._pointMarker&&a._pointMarker.element&&(j=g.symbolSizeSelected,isNaN(j)&&(j=g.symbolSize),(isNaN(j)||50<j||0>j)&&(j=d.symbolSize),(isNaN(j)||50<j||0>j)&&(j=8)),a._createTooltip(H,d,M,{css:t,fill:V,stroke:E,fillOpacity:B,symbolSize:j})}}}}_fitTooltip(e,t,r,n,s){var a={},l=2+s/2,o=7;if(t.x-r.width-o-l>e.x&&t.y+t.height/2-r.height/2>e.y&&t.y+t.height/2+r.height/2<e.y+e.height&&(a.left={arrowLocation:"right",x:t.x-r.width-o-l,y:t.y+t.height/2-r.height/2,width:r.width+o,height:r.height}),t.x+t.width+r.width+o+l<e.x+e.width&&t.y+t.height/2-r.height/2>e.y&&t.y+t.height/2+r.height/2<e.y+e.height&&(a.right={arrowLocation:"left",x:t.x+t.width+l,y:t.y+t.height/2-r.height/2,width:r.width+o,height:r.height}),t.y-r.height-l-o>e.y&&t.x+t.width/2-r.width/2>e.x&&t.x+t.width/2+r.width/2<e.x+e.width&&(a.top={arrowLocation:"bottom",x:t.x+t.width/2-r.width/2,y:t.y-r.height-l-o,width:r.width,height:r.height+o}),t.y+t.height+r.height+o+l<e.y+e.height&&t.x+t.width/2-r.width/2>e.x&&t.x+t.width/2+r.width/2<e.x+e.width&&(a.bottom={arrowLocation:"top",x:t.x+t.width/2-r.width/2,y:t.y+t.height+l,width:r.width,height:r.height+o}),t.width>t.height||(-1!==n.type.indexOf("stackedcolumn")||-1!==n.type.indexOf("stackedwaterfall"))&&"horizontal"!==n.orientation){if(a.left)return a.left;if(a.right)return a.right}else{if(a.top)return a.top;if(a.bottom)return a.bottom}for(var d in a)if(a[d])return a[d];return{arrowLocation:""}}_createTooltip(e,t,i,r){var n=Math.max;const s=this,a=t.type;let l=s._ttEl.box;if(!l){l=s._ttEl.box=document.createElement("div"),l.className="smart-chart-tooltip",l.setAttribute("animation",s.animation),l.setAttribute("theme",s.theme);const e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div");e.id="arrowOuterDiv",e.className="smart-chart-tooltip-arrow-outer",t.id="arrowInnerDiv",t.className="smart-chart-tooltip-arrow-inner",i.id="contentDiv",i.className="smart-chart-tooltip-content",l.appendChild(i),l.appendChild(e),l.appendChild(t),document.body.appendChild(l)}if(!i||0===i.length)return void l.classList.add("smart-visibility-hidden");l.classList.add("smart-visibility-hidden");const o=l.firstElementChild,d=l.children[1],g=l.children[2];g.style.opacity=d.style.opacity=r.fillOpacity,o.style.backgroundColor=r.fill,o.style.borderColor=r.stroke,o.style.opacity=r.fillOpacity;const u="<span class=\""+r.css+"\">"+i+"</span>";o.innerHTML=u;const p=s._measureHtml(u),h=s._plotRect;if(p.width>h.width||p.height>h.height)return;var m={width:p.width,height:p.height};let c="";var f=s._isColumnType(a);let _=n(e.x,h.x),b=n(e.y,h.y);if(-1!==a.indexOf("pie")||-1!==a.indexOf("donut")){var v=(e.fromAngle+e.toAngle)/2;v*=Math.PI/180;var A=!isNaN(e.innerRadius)&&0<e.innerRadius?(e.innerRadius+e.outerRadius)/2:.75*e.outerRadius;_=e.x=e.center.x+Math.cos(v)*A,b=e.y=e.center.y-Math.sin(v)*A,e.width=e.height=1}else f&&(t.polar||t.spider)&&(e.width=e.height=1);var w=this._fitTooltip(this._plotRect,e,m,t,r.symbolSize);""!==w.arrowLocation&&(c=w.arrowLocation,_=w.x,b=w.y,m.width=w.width,m.height=w.height),"top"===c||"bottom"===c?(m.height+=7,_-=7/2,"bottom"===c&&(b-=7)):("left"===c||"right"===c)&&(m.width+=7,b-=7/2,"right"===c&&(_-=7)),_+m.width>h.x+h.width&&(c="",_=h.x+h.width-m.width),b+m.height>h.y+h.height&&(c="",b=h.y+h.height-m.height);let S={x:0,y:0},C={x:0,y:0};o.style.width=p.width+"px",o.style.height=p.height+"px",d.style["margin-top"]=d.style["margin-left"]=0,g.style["margin-top"]=g.style["margin-left"]=0,o.style["margin-top"]=o.style["margin-left"]=0;var k="7px solid transparent";"left"===c?(S={x:0,y:(p.height-7)/2},C={x:7,y:0},o.style["margin-left"]="7px",d.style["margin-left"]="0px",d.style["margin-top"]=S.y+"px",d.style["border-left"]="",d.style["border-right"]="7px solid "+r.stroke,d.style["border-top"]=k,d.style["border-bottom"]=k,g.style["margin-left"]="1px",g.style["margin-top"]=S.y+"px",g.style["border-left"]="",g.style["border-right"]="7px solid "+r.fill,g.style["border-top"]=k,g.style["border-bottom"]=k):"right"===c?(S={x:m.width-7,y:(p.height-7)/2},C={x:0,y:0},d.style["margin-left"]=S.x+"px",d.style["margin-top"]=S.y+"px",d.style["border-left"]="7px solid "+r.stroke,d.style["border-right"]="",d.style["border-top"]=k,d.style["border-bottom"]=k,g.style["margin-left"]=S.x-1+"px",g.style["margin-top"]=S.y+"px",g.style["border-left"]="7px solid "+r.fill,g.style["border-right"]="",g.style["border-top"]=k,g.style["border-bottom"]=k):"top"===c?(S={x:m.width/2-7/2,y:0},C={x:0,y:7},o.style["margin-top"]=C.y+"px",d.style["margin-left"]=S.x+"px",d.style["border-top"]="",d.style["border-bottom"]="7px solid "+r.stroke,d.style["border-left"]=k,d.style["border-right"]=k,g.style["margin-left"]=S.x+"px",g.style["margin-top"]="1px",g.style["border-top"]="",g.style["border-bottom"]="7px solid "+r.fill,g.style["border-left"]=k,g.style["border-right"]=k):"bottom"===c?(S={x:m.width/2-7/2,y:m.height-7},C={x:0,y:0},d.style["margin-left"]=S.x+"px",d.style["margin-top"]=S.y+"px",d.style["border-top"]="7px solid "+r.stroke,d.style["border-bottom"]="",d.style["border-left"]=k,d.style["border-right"]=k,g.style["margin-left"]=S.x+"px",g.style["margin-top"]=S.y-1+"px",g.style["border-top"]="7px solid "+r.fill,g.style["border-bottom"]="",g.style["border-left"]=k,g.style["border-right"]=k):void 0;""===c?(d.classList.add("smart-hidden"),g.classList.add("smart-hidden")):(d.classList.remove("smart-hidden"),g.classList.remove("smart-hidden")),l.style.width=m.width+"px",l.style.height=m.height+"px";const I=s.getBoundingClientRect();l.style.left=_+I.left+"px",l.style.top=b+I.top+"px",l.classList.remove("smart-visibility-hidden")}_measureHtml(e){const t=this;let i=t._measureDiv;i||(t._measureDiv=i=document.createElement("div"),i.className="smart-chart-tooltip",i.style.position="absolute",i.style.visibility="hidden",i.style.left=0,i.style.top=0,t.appendChild(i)),i.innerHTML=e;const r={width:i.offsetWidth+2,height:i.offsetHeight+2};return Smart.Utilities.Core.Browser.Firefox&&(r.height+=3),r}_hideToolTip(){this._ttEl&&(this._ttEl.box&&this._ttEl.box.classList.add("smart-visibility-hidden"),this._hideCrosshairs(),this._ttEl.gidx=void 0)}_hideCrosshairs(){this._ttEl&&(this._ttEl.vLine&&(this.renderer.removeElement(this._ttEl.vLine),this._ttEl.vLine=void 0),this._ttEl.hLine&&(this.renderer.removeElement(this._ttEl.hLine),this._ttEl.hLine=void 0))}_get(e){return this._draw.getByPriority(e)}_getAxisSettings(e){if(!e)return{};var t=this,i=e.gridLines||{},r={visible:t._get([i.visible,!0]),color:t._get([i.color,t._getThemeColor("line")]),unitInterval:i.unitInterval,step:i.step,dashStyle:i.dashStyle,width:t._get([i.lineWidth,1]),offsets:[],alternatingBackgroundColor:e.alternatingBackgroundColor,alternatingBackgroundColor2:e.alternatingBackgroundColor2,alternatingBackgroundOpacity:e.alternatingBackgroundOpacity},n=e.tickMarks||{},s={visible:t._get([n.visible,e.showTickMarks,!0]),color:t._get([n.color,e.tickMarksColor,t._getThemeColor("line")]),unitInterval:t._get([n.unitInterval,n.interval,e.tickMarksInterval]),step:t._get([n.step,e.tickMarksStep]),dashStyle:t._get([n.dashStyle,e.tickMarksDashStyle]),width:t._get([n.lineWidth,1]),size:t._get([n.size,4]),offsets:[]},a=e.title||{},l={visible:t._get([a.visible,!0]),text:t._get([e.description,a.text]),style:t._get([e.descriptionClass,a["class"],"smart-chart-axis-description"]),halign:t._get([e.horizontalDescriptionAlignment,a.horizontalAlignment,"center"]),valign:t._get([e.verticalDescriptionAlignment,a.verticalAlignment,"center"]),angle:0,rotationPoint:t._get([a.rotationPoint,"centercenter"]),offset:t._get([a.offset,{x:0,y:0}])},o=e.line||{},d={visible:t._get([o.visible,!0]),color:t._get([o.color,r.color,t._getThemeColor("line")]),dashStyle:t._get([o.dashStyle,r.dashStyle,""]),width:t._get([o.lineWidth,1]),angle:t._get([o.angle,NaN])},g=e.padding||{};g={left:g.left||0,right:g.right||0,top:g.top||0,bottom:g.bottom||0};var u=this._getAxisLabelsSettings(e),p={visible:this._get([e.visible,!0]),customDraw:this._get([e.customDraw,!1]),gridLines:r,tickMarks:s,line:d,title:l,labels:u,padding:g,toolTipFormatFunction:this._get([e.toolTipFormatFunction,e.formatFunction,u.formatFunction]),toolTipFormatSettings:this._get([t._getFormatSettings(e,"toolTipFormatSettings"),t._getFormatSettings(e),t._getFormatSettings(u)])};return p}_getAxisLabelsSettings(e){var t=this,i=e.labels||{},r={visible:t._get([e.showLabels,i.visible,!0]),unitInterval:t._get([i.unitInterval,i.interval,e.labelsInterval]),step:t._get([i.step,e.labelsStep]),angle:t._get([e.textRotationAngle,i.angle,0]),style:t._get([e["class"],i["class"],"smart-chart-axis-text"]),halign:t._get([e.horizontalTextAlignment,i.horizontalAlignment,"center"]),valign:t._get([e.verticalTextAlignment,i.verticalAlignment,"center"]),textRotationPoint:t._get([e.textRotationPoint,i.rotationPoint,"auto"]),textOffset:t._get([e.textOffset,i.offset,{x:0,y:0}]),autoRotate:t._get([e.labelsAutoRotate,i.autoRotate,!1]),formatSettings:t._get([t._getFormatSettings(e),t._getFormatSettings(i),void 0]),formatFunction:t._get([e.formatFunction,i.formatFunction,void 0])};return r}_getLabelsSettings(e,t,r,i){var n=this.seriesGroups[e],a=n.series[t],s=isNaN(r)?void 0:this._getDataValue(r,a.dataField,e),l=i||["Visible","Offset","Angle","HorizontalAlignment","VerticalAlignment","Class","BackgroundColor","BorderColor","BorderOpacity","Padding","Opacity","BackgroundOpacity","LinesAngles","LinesEnabled","AutoRotate","Radius"],o={};for(let y=0;y<l.length;y++){var d=l[y],g="labels"+d,u="label"+d,p=d.substring(0,1).toLowerCase()+d.substring(1),h=void 0;n.labels&&"object"==typeof n.labels&&(h=n.labels[p]),a.labels&&"object"==typeof a.labels&&void 0!==a.labels[p]&&null!==a.labels[p]&&(h=a.labels[p]),h=this._get([a[g],a[u],h,n[g],n[u]]),o[p]="function"==typeof h?h(s,r,a,n):h}o["class"]=o["class"]||"smart-chart-label-text",o.visible=this._get([o.visible,a.showLabels,n.showLabels,void 0!==a.labels&&null!==a.labels||void 0,void 0!==n.labels&&null!==n.labels||void 0]);var y=o.padding||1;return o.padding={left:this._get([y.left,isNaN(y)?1:y]),right:this._get([y.right,isNaN(y)?1:y]),top:this._get([y.top,isNaN(y)?1:y]),bottom:this._get([y.bottom,isNaN(y)?1:y])},o}_showLabel(e,t,i,r,n,s,a,l,o,d,g){var u=Math.max,p={width:0,height:0},m;if(!isNaN(i)){var c=this._getLabelsSettings(e,t,i);if(!c.visible)return a?p:void 0;if(0>r.width||0>r.height)return a?p:void 0;var f=c.angle;isNaN(d)||(f=d);var _=c.offset||{},b={x:_.x,y:_.y};isNaN(b.x)&&(b.x=0),isNaN(b.y)&&(b.y=0),n=n||c.horizontalAlignment||"center",s=s||c.verticalAlignment||"center";var v=this._getFormattedValue(e,t,i,void 0,void 0,!0),A=r.width,w=r.height;if(!0===l&&"center"!==n&&(n="right"===n?"left":"right"),!0===o&&"center"!==s&&"middle"!==s&&(s="top"===s?"bottom":"top",b.y*=-1),p=this.renderer.measureText(v,f,{class:c["class"]}),a)return p;var h=0,S=0;0<A&&(""===n||"center"===n?h+=(A-p.width)/2:"right"===n&&(h+=A-p.width)),0<w&&(""===s||"center"===s?S+=(w-p.height)/2:"bottom"===s&&(S+=w-p.height)),h+=r.x+b.x,S+=r.y+b.y;var C=this._plotRect;h<=C.x&&(h=C.x+2),S<=C.y&&(S=C.y+2);var k={width:u(p.width,1),height:u(p.height,1)};S+k.height>=C.y+C.height&&(S=C.y+C.height-(m?(k.height+m.height)/2:k.height)-2),h+k.width>=C.x+C.width&&(h=C.x+C.width-k.width-2);var I=c.backgroundColor,M=c.borderColor,F=c.padding,D;(I||M)&&(D=this.renderer.beginGroup(),this.renderer.rect(h-F.left,S-F.top,p.width+F.left+F.right,p.height+F.bottom+F.bottom,{fill:I||"transparent","fill-opacity":c.backgroundOpacity||1,stroke:M||"transparent","stroke-opacity":c.borderOpacity,"stroke-width":1}));var T=this.renderer.text(v,h,S,p.width,p.height,f,{class:c["class"],opacity:c.opacity||1},!1,"center","center",void 0,arguments[11]);return g&&(g.x=h-F.left,g.y=S-F.top,g.width=p.width+F.left+F.right,g.height=p.height+F.bottom+F.bottom),D&&this.renderer.endGroup(),D||T}}_getAnimProps(e,t){var i=this.seriesGroups[e],r=isNaN(t)?void 0:i.series[t],n=this.hasAnimation;i.animation&&(n="none"!==i.animation),r&&r.animation&&(n="none"!==r.animation);var s=this.animationDuration;isNaN(s)&&(s=1e3);var a=i.animationDuration;if(isNaN(a)||(s=a),r){var l=r.animationDuration;isNaN(l)||(s=l)}return 5e3<s&&(s=1e3),{enabled:n,duration:s}}_isColorTransition(e,t,i,r){if(r-1<i.xoffsets.first)return!1;var n=this._getColors(e,t,r,this._getGroupGradientType(e)),s=this._getColors(e,t,r-1,this._getGroupGradientType(e));return n.fillColor!==s.fillColor}_renderLineSeries(e,t){var r=Math.max,n=this.seriesGroups[e];if(n.series&&0!==n.series.length){var s=-1!==n.type.indexOf("area"),i=-1!==n.type.indexOf("stacked"),a=i&&-1!==n.type.indexOf("100"),l=-1!==n.type.indexOf("spline"),o=-1!==n.type.indexOf("step"),d=-1!==n.type.indexOf("range"),g=!0===n.polar||!0===n.spider;if(g&&(o=!1),!(o&&l)){var u="horizontal"===n.orientation,p=!0===this._getXAxis(e).flip,h=t;u&&(h={x:t.y,y:t.x,width:t.height,height:t.width});var y=this._calcGroupOffsets(e,h);if(y&&0!==y.xoffsets.length){this._linesRenderInfo||(this._linesRenderInfo={}),this._linesRenderInfo[e]={};for(let t=n.series.length-1;0<=t;t--){var m=this._getSerieSettings(e,t),c={groupIndex:e,rect:h,serieIndex:t,swapXY:u,isArea:s,isSpline:l,isRange:d,isPolar:g,settings:m,segments:[],pointsLength:0},f=this._isSerieVisible(e,t);if(!f){this._linesRenderInfo[e][t]=c;continue}var _=n.series[t];if(!_.customDraw){var b="function"==typeof _.colorFunction,v=y.xoffsets.first,A=v,w=this._getColors(e,t,NaN,this._getGroupGradientType(e)),S;do{var C=[],k=[],I=[],M=0,F=0,D=NaN,T=NaN,O=NaN;if(1>y.xoffsets.length)continue;var R=this._getAnimProps(e,t),L=R.enabled&&!this._isToggleRefresh&&1e4>y.xoffsets.length&&R.duration,P=v;S=!1;var G=void 0;for(let l=v;l<=y.xoffsets.last;l++){v=l;var V=y.xoffsets.data[l],E=y.xoffsets.xvalues[l];if(!isNaN(V)&&(V=r(V,1),M=V,F=y.offsets[t][l].to,!(!b&&G&&this.enableSampling&&1>this.renderer._ptdist(G.x,G.y,M,F)))){G={x:M,y:F};var B=y.offsets[t][l].from;if(isNaN(F)||isNaN(B))if("connect"===_.emptyPointsDisplay)continue;else if("zero"===_.emptyPointsDisplay)isNaN(F)&&(F=y.baseOffset),isNaN(B)&&(B=y.baseOffset);else{S=!0;break}if(b&&this._isColorTransition(e,t,y,v)&&1<C.length){v--;break}var H=this._elementRenderInfo;if(H&&H.length>e&&H[e].series.length>t){var j=H[e].series[t][E],O=this.renderer._ptrnd(j?j.to:void 0),z=this.renderer._ptrnd(h.x+(j?j.xoffset:void 0));I.push(u?{y:z,x:O,index:l}:{x:z,y:O,index:l})}A=l,2>m.stroke&&(1>=F-h.y&&(F=h.y+1),1>=B-h.y&&(B=h.y+1),1>=h.y+h.height-F&&(F=h.y+h.height-1),1>=h.y+h.height-B&&(B=h.y+h.height-1)),!s&&a&&(F<=h.y&&(F=h.y+1),F>=h.y+h.height&&(F=h.y+h.height-1),B<=h.y&&(B=h.y+1),B>=h.y+h.height&&(B=h.y+h.height-1)),V=r(V,1),M=V+h.x,!0===n.skipOverlappingPoints&&!isNaN(D)&&1>=Math.abs(D-M)||(o&&!isNaN(D)&&!isNaN(T)&&T!==F&&C.push(u?{y:M,x:this.renderer._ptrnd(T)}:{x:M,y:this.renderer._ptrnd(T)}),C.push(u?{y:M,x:this.renderer._ptrnd(F),index:l}:{x:M,y:this.renderer._ptrnd(F),index:l}),k.push(u?{y:M,x:this.renderer._ptrnd(B),index:l}:{x:M,y:this.renderer._ptrnd(B),index:l}),D=M,T=F,isNaN(O)&&(O=F))}}if(0===C.length){v++;continue}var W=C[C.length-1].index;b&&(w=this._getColors(e,t,W,this._getGroupGradientType(e)));var X=h.x+y.xoffsets.data[P],N=h.x+y.xoffsets.data[A];if(s&&!0===n.alignEndPointsWithIntervals&&(X>h.x&&(X=h.x),N<h.x+h.width&&(N=h.x+h.width),p)){var U=X;X=N,N=U}N=this.renderer._ptrnd(N),X=this.renderer._ptrnd(X);var Y=y.baseOffset;O=this.renderer._ptrnd(O);var Z=this.renderer._ptrnd(F)||Y;d&&(C=C.concat(k.reverse())),c.pointsLength+=C.length;var q={lastItemIndex:W,colorSettings:w,pointsArray:C,pointsStart:I,left:X,right:N,pyStart:O,pyEnd:Z,yBase:Y,labelElements:[],symbolElements:[]};c.segments.push(q)}while(v<y.xoffsets.first+y.xoffsets.length-1||S);this._linesRenderInfo[e][t]=c}}var J=this._linesRenderInfo[e],K=[];for(let e in J)K.push(J[e]);K=K.sort(function(e,t){return e.serieIndex-t.serieIndex}),s&&i&&K.reverse();for(let e=0;e<K.length;e++){var c=K[e];this._animateLine(c,0===L?1:0);var $=this;this._enqueueAnimation("series",void 0,void 0,L,function(e,t,i){$._animateLine(t,i)},c)}}}}}_animateLine(e,t){var r=e.settings,n=e.groupIndex,s=e.serieIndex,i=this.seriesGroups[n],a=i.series[s],l=this._getSymbol(n,s),o=this._getLabelsSettings(n,s,NaN,["Visible"]).visible,d=!0;e.isPolar&&!isNaN(i.endAngle)&&360!==Math.round(Math.abs((isNaN(i.startAngle)?0:i.startAngle)-i.endAngle))&&(d=!1),!1===a.endPointsConnect&&(d=!1);var g=0;for(let i=0;i<e.segments.length;i++){var u=e.segments[i],p=this._calculateLine(n,e.pointsLength,g,u.pointsArray,u.pointsStart,u.yBase,t,e.isArea,e.swapXY);if(g+=u.pointsArray.length,""!==p){var h=p.split(" "),y=p;y=""===y?"M 0 0":this._buildLineCmd(p,e.isRange,u.left,u.right,u.pyStart,u.pyEnd,u.yBase,e.isArea,e.isPolar,d,e.isSpline,e.swapXY);var m=u.colorSettings;if(u.pathElement?this.renderer.attr(u.pathElement,{d:y}):(u.pathElement=this.renderer.path(y,{"stroke-width":r.stroke,stroke:m.lineColor,"stroke-opacity":r.opacity,"fill-opacity":r.opacity,"stroke-dasharray":r.dashStyle,fill:e.isArea?m.fillColor:"none"}),this._installHandlers(u.pathElement,"path",n,s,u.lastItemIndex)),u.labelElements){for(let e=0;e<u.labelElements.length;e++)this.renderer.removeElement(u.labelElements[e]);u.labelElements=[]}if(u.symbolElements){for(let e=0;e<u.symbolElements.length;e++)this.renderer.removeElement(u.symbolElements[e]);u.symbolElements=[]}if(u.pointsArray.length===h.length&&("none"!==l||o)){var c=a.symbolSize,f=this._plotRect;for(let e=0;e<h.length;e++){var x=h[e].split(",");if(x={x:parseFloat(x[0]),y:parseFloat(x[1])},!(x.x<f.x||x.x>f.x+f.width||x.y<f.y||x.y>f.y+f.height)){if("none"!==l){var _=this._getColors(n,s,u.pointsArray[e].index,this._getGroupGradientType(n)),b=this._drawSymbol(l,x.x,x.y,_.fillColorSymbol,r.opacity,_.lineColorSymbol,r.opacity,r.strokeSymbol,void 0,c);u.symbolElements.push(b)}if(o&&(x=this._adjustLineLabelPosition(n,s,u.pointsArray[e].index,x),x)){var v=this._showLabel(n,s,u.pointsArray[e].index,{x:x.x,y:x.y,width:0,height:0});u.labelElements.push(v)}}}}if(1===t&&"none"!==l)for(let e=0;e<u.symbolElements.length;e++)isNaN(u.pointsArray[e].index)||this._installHandlers(u.symbolElements[e],"symbol",n,s,u.pointsArray[e].index)}}}_adjustLineLabelPosition(e,t,i,r){var n=this._showLabel(e,t,i,{width:0,height:0},"","",!0);if(n){var s={x:r.x-n.width/2,y:0,y:r.y-1.5*n.height};return s}}_calculateLine(e,t,i,r,n,s,a,l,o){var d=this.seriesGroups[e],g;(!0===d.polar||!0===d.spider)&&(g=this._getPolarAxisCoords(e,this._plotRect));var u="",p=r.length;if(!l&&0===n.length){p=t*a-i}for(let d=0;d<p+1&&d<r.length;d++){0<d&&(u+=" ");var h=r[d].y,m=r[d].x,c=l?s:h,f=m;if(n&&n.length>d&&(c=n[d].y,f=n[d].x,(isNaN(c)||isNaN(f))&&(c=h,f=m)),p<=r.length&&0<d&&d===p&&(f=r[d-1].x,c=r[d-1].y),o?(m=this.renderer._ptrnd((m-c)*(l?a:1)+c),h=this.renderer._ptrnd(h)):(m=this.renderer._ptrnd((m-f)*a+f),h=this.renderer._ptrnd((h-c)*a+c)),g){var _=this._toPolarCoord(g,this._plotRect,m,h);m=_.x,h=_.y}u+=m+","+h}return u}_buildLineCmd(e,t,i,r,n,s,a,l,o,d,g,u){var p=e,h=u?a+","+i:i+","+a,y=u?a+","+r:r+","+a;!l||o||t||(p=h+" "+e+" "+y),g&&(p=this._getBezierPoints(p));var m=p.split(" ");if(0===m.length)return"";if(1===m.length){var c=m[0].split(",");return"M "+m[0]+" L"+(parseFloat(c[0])+1)+","+(parseFloat(c[1])+1)}var f=m[0].replace("M","");return l&&!o?t?p="M "+f+" L "+f+(g?"":" L "+f+" ")+p:p="M "+h+" L "+f+" "+p:!g&&(p="M "+f+" L "+f+" "+p),(o&&d||t)&&(p+=" Z"),p}_getSerieSettings(e,t){var i=this.seriesGroups[e],r=-1!==i.type.indexOf("area"),n=-1!==i.type.indexOf("line"),s=i.series[t],a=s.dashStyle||i.dashStyle||"",l=s.opacity||i.opacity;(isNaN(l)||0>l||1<l)&&(l=1);var o=s.lineWidth;isNaN(o)&&"auto"!==o&&(o=i.lineWidth),("auto"===o||isNaN(o)||0>o||15<o)&&(r?o=2:n?o=3:o=1);var d=s.lineWidthSymbol;return isNaN(d)&&(d=1),{stroke:o,strokeSymbol:d,opacity:l,dashStyle:a}}_getColors(e,t,r,n,s){var a=this.seriesGroups[e],l=a.series[t],o=this._get([l.useGradientColors,a.useGradientColors,!1]),d=this._getSeriesColors(e,t,r);d.fillColor||(d.fillColor=c,d.fillColorSelected=this.renderer.adjustColor(c,1.1),d.fillColorAlt=this.renderer.adjustColor(c,4),d.fillColorAltSelected=this.renderer.adjustColor(c,3),d.lineColor=d.symbolColor=this.renderer.adjustColor(c,.9),d.lineColorSelected=d.symbolColorSelected=this.renderer.adjustColor(c,.9));var g=[[0,1.4],[100,1]],u=[[0,1],[25,1.1],[50,1.4],[100,1]];let p=NaN;if(isNaN(s)||(p=2===s?g:u),o){var h={};for(var y in d)h[y]=d[y];if(d=h,"verticalLinearGradient"===n||"horizontalLinearGradient"===n){var i="verticalLinearGradient"===n?p||g:p||u,m=["fillColor","fillColorSelected","fillColorAlt","fillColorAltSelected"];for(let e in m){var c=d[m[e]];c&&(d[m[e]]=this.renderer._toLinearGradient(c,"verticalLinearGradient"===n,i))}}else if("radialGradient"===n){var f;let i=g;("pie"===a.type||"donut"===a.type||a.polar)&&void 0!==r&&null!==r&&this._renderData[e]&&this._renderData[e].offsets[t]&&(f=this._renderData[e].offsets[t][r],i=[[0,1.3],[90,1.2],[100,1]]),d.fillColor=this.renderer._toRadialGradient(d.fillColor,i,f),d.fillColorSelected=this.renderer._toRadialGradient(d.fillColorSelected,i,f)}}return d}_installHandlers(e,t,i,r,n){if(!this.enableEvents)return!1;var a=this,l=this.seriesGroups[i],o=this.seriesGroups[i].series[r],s=-1!==l.type.indexOf("line")||-1!==l.type.indexOf("area");s||!1===l.enableSelection||!1===o.enableSelection||this.renderer.addHandler(e,"mousemove",function(t){var e=a._selected;if(!(e&&e.isLineType&&"click"===e.linesUnselectMode&&(e.group!==i||e.series!==r))){var s=t.pageX||t.clientX||t.screenX,l=t.pageY||t.clientY||t.screenY;const e=a.getBoundingClientRect();s-=e.left,l-=e.top,a._ttEl&&a._ttEl.gidx===i&&a._ttEl.sidx===r&&a._ttEl.iidx===n||a._startTooltipTimer(i,r,n)}}),!1===l.enableSelection||!1===o.enableSelection||this.renderer.addHandler(e,"mouseover",function(){var s=a._selected;s&&s.isLineType&&"click"===s.linesUnselectMode&&(s.group!==i||s.series!==r)||a._select(e,t,i,r,n,n)}),this.renderer.addHandler(e,"click",function(i){(clearTimeout(a._hostClickTimer),a._lastClickTs=new Date().valueOf(),!(s&&"symbol"!==t&&"pointMarker"!==t))&&(a._isColumnType(l.type)&&a._unselect(),isNaN(n)||(i.stopImmediatePropagation(),a._raiseItemEvent("click",l,o,n)))})}_getHorizontalOffset(e,t,i,r){var n=this._plotRect,s=this._getDataLen(e);if(0===s)return{index:void 0,value:i};var a=this._calcGroupOffsets(e,this._plotRect);if(0===a.xoffsets.length)return{index:void 0,value:void 0};var l=i,o=r,d=this.seriesGroups[e],g;(d.polar||d.spider)&&(g=this._getPolarAxisCoords(e,n));var u,p,h,y;for(let s=a.xoffsets.first;s<=a.xoffsets.last;s++){var m=a.xoffsets.data[s],c=a.offsets[t][s].to,f=0;if(g){var x=this._toPolarCoord(g,n,m+n.x,c);m=x.x,c=x.y,f=this.renderer._ptdist(l,o,m,c)}else if("horizontal"===d.orientation){m+=n.y;var _=c;c=m,m=_,f=this.renderer._ptdist(l,o,m,c)}else m+=n.x,f=Math.abs(l-m);(isNaN(u)||u>f)&&(u=f,p=s,h=m,y=c)}return{index:p,value:a.xoffsets.data[p],polarAxisCoords:g,x:h,y:y}}onmousemove(e,t){var r=Math.abs;if(this._mouseX===e&&this._mouseY===t)return;if(this._mouseX=e,this._mouseY=t,!this._selected)return;var n=this._selected.group,a=this._selected.series,l=this.seriesGroups[n],o=l.series[a];let s=this._plotRect;if(this.renderer&&(s=this.renderer.getRect(),s.x+=5,s.y+=5,s.width-=10,s.height-=10),e<s.x||e>s.x+s.width||t<s.y||t>s.y+s.height)return this._hideToolTip(),void this._unselect();var d="horizontal"===l.orientation;if(s=this._plotRect,-1!==l.type.indexOf("line")||-1!==l.type.indexOf("area")){var g=this._getHorizontalOffset(n,this._selected.series,e,t),u=g.index;if(void 0===u||null===u)return;if(this._selected.item!==u){for(var i=this._linesRenderInfo[n][a].segments,p=0;u>i[p].lastItemIndex;)if(p++,p>=i.length)return;var h=i[p].pathElement,m=i[p].lastItemIndex;this._unselect(!1),this._select(h,"path",n,a,u,m)}var c=this._getSymbol(this._selected.group,this._selected.series);"none"===c&&(c="circle");var f=this._calcGroupOffsets(n,s),_=f.offsets[this._selected.series][u].to,b=_;-1!==l.type.indexOf("range")&&(b=f.offsets[this._selected.series][u].from);var v=d?e:t;if(t=!isNaN(b)&&r(v-b)<r(v-_)?b:_,isNaN(t))return;if(e=g.value,d){var A=e;e=t,t=A+s.y}else e+=s.x;if(g.polarAxisCoords&&(e=g.x,t=g.y),t=this.renderer._ptrnd(t),e=this.renderer._ptrnd(e),this._pointMarker&&this._pointMarker.element&&(this.renderer.removeElement(this._pointMarker.element),this._pointMarker.element=void 0),isNaN(e)||isNaN(t))return;var w=this._getSeriesColors(n,a,u),S=this._getSerieSettings(n,a),C=o.symbolSizeSelected;isNaN(C)&&(C=o.symbolSize),(isNaN(C)||50<C||0>C)&&(C=l.symbolSize),(isNaN(C)||50<C||0>C)&&(C=8),(this.showToolTips||this.enableCrosshairs)&&(this._pointMarker={type:c,x:e,y:t,gidx:n,sidx:a,iidx:u},this._pointMarker.element=this._drawSymbol(c,e,t,w.fillColorSymbolSelected,S.opacity,w.lineColorSymbolSelected,S.opacity,S.strokeSymbol,S.dashStyle,C),this._installHandlers(this._pointMarker.element,"pointMarker",n,a,u)),this._startTooltipTimer(n,this._selected.series,u)}}_drawSymbol(e,t,i,r,n,s,a,l,o,d){let g=d||6,u=g/2,p,h;switch(e){case"none":return;case"circle":p=this.renderer.circle(t,i,g/2);break;case"square":--g,u=g/2,p=this.renderer.rect(t-u,i-u,g,g);break;case"diamond":h="M "+(t-u)+","+i+" L"+t+","+(i-u)+" L"+(t+u)+","+i+" L"+t+","+(i+u)+" Z",p=this.renderer.path(h);break;case"triangle_up":case"triangle":h="M "+(t-u)+","+(i+u)+" L "+(t+u)+","+(i+u)+" L "+t+","+(i-u)+" Z",p=this.renderer.path(h);break;case"triangle_down":h="M "+(t-u)+","+(i-u)+" L "+t+","+(i+u)+" L "+(t+u)+","+(i-u)+" Z",p=this.renderer.path(h);break;case"triangle_left":h="M "+(t-u)+","+i+" L "+(t+u)+","+(i+u)+" L "+(t+u)+","+(i-u)+" Z",p=this.renderer.path(h);break;case"triangle_right":h="M "+(t-u)+","+(i-u)+" L "+(t-u)+","+(i+u)+" L "+(t+u)+","+i+" Z",p=this.renderer.path(h);break;default:p=this.renderer.circle(t,i,g);}return this.renderer.attr(p,{fill:r,"fill-opacity":n,stroke:s,"stroke-width":l,"stroke-opacity":a,"stroke-dasharray":o||""}),"circle"!==e&&(this.renderer.attr(p,{r:g/2}),"square"!==e&&this.renderer.attr(p,{x:t,y:i})),p}_getSymbol(e,t){var i=["circle","square","diamond","triangle_up","triangle_down","triangle_left","triangle_right"],r=this.seriesGroups[e],n=r.series[t],s;return(void 0!==n.symbolType&&null!==n.symbolType&&(s=n.symbolType),(void 0===s||null===s)&&(s=r.symbolType),"default"===s)?i[t%i.length]:void 0!==s&&null!==s?s:"none"}_startTooltipTimer(e,t,i,r,n,s,a){this._cancelTooltipTimer();var l=this,o=this.toolTipShowDelay;(isNaN(o)||1e4<o||0>o)&&(o=500),(this._ttEl||!0===this.enableCrosshairs&&!1===this.showToolTips)&&(o=0),isNaN(s)||(o=s),clearTimeout(this._tttimerHide),isNaN(r)&&(r=l._mouseX),isNaN(n)&&(n=l._mouseY-3),0===o&&l._showToolTip(r,n,e,t,i),this._tttimer=setTimeout(function(){0!==o&&l._showToolTip(r,n,e,t,i);var s=l.toolTipHideDelay;isNaN(a)||(s=a),isNaN(s)&&(s=4e3),l._tttimerHide=setTimeout(function(){l._hideToolTip(),l._unselect()},s)},o)}_cancelTooltipTimer(){clearTimeout(this._tttimer)}_getGroupGradientType(e){var t=this.seriesGroups[e];if(-1!==t.type.indexOf("area"))return"horizontal"===t.orientation?"horizontalLinearGradient":"verticalLinearGradient";return this._isColumnType(t.type)||-1!==t.type.indexOf("candle")?t.polar?"radialGradient":"horizontal"===t.orientation?"verticalLinearGradient":"horizontalLinearGradient":-1!==t.type.indexOf("scatter")||-1!==t.type.indexOf("bubble")||this._isPieGroup(e)?"radialGradient":void 0}_select(e,t,i,r,n,a){if(this._selected)if(this._selected.item!==n||this._selected.series!==r||this._selected.group!==i)this._unselect();else return;var l=this.seriesGroups[i],o=l.series[r];if(!1!==l.enableSelection&&!1!==o.enableSelection){var s=-1!==l.type.indexOf("line")&&-1===l.type.indexOf("area");this._selected={element:e,type:t,group:i,series:r,item:n,iidxBase:a,isLineType:s,linesUnselectMode:o.linesUnselectMode||l.linesUnselectMode};var d=this._getColors(i,r,a||n,this._getGroupGradientType(i)),g=d.fillColorSelected;s&&(g="none");var u=this._getSerieSettings(i,r),p="symbol"===t?d.lineColorSymbolSelected:d.lineColorSelected;g="symbol"===t?d.fillColorSymbolSelected:g;var h="symbol"===t?1:u.stroke;this.renderer.getAttr(e,"fill")===d.fillColorAlt&&(g=d.fillColorAltSelected),this.renderer.attr(e,{stroke:p,fill:g,"stroke-width":h}),(-1!==l.type.indexOf("pie")||-1!==l.type.indexOf("donut"))&&this._applyPieSelect(),this._raiseItemEvent("mouseover",l,o,n)}}_applyPieSelect(){var e=this;e._createAnimationGroup("animPieSlice");var t=this._selected;if(t){var i=this.getItemCoord(t.group,t.series,t.item);if(i){var r=this._getRenderInfo(t.group,t.series,t.item);this._enqueueAnimation("animPieSlice",void 0,void 0,300,function(i,r,n){var s=r.coord,a=s.selectedRadiusChange*n,l=e.renderer.pieSlicePath(s.center.x,s.center.y,0===s.innerRadius?0:s.innerRadius+a,s.outerRadius+a,s.fromAngle,s.toAngle,s.centerOffset);e.renderer.attr(r.element.element,{d:l}),e._showPieLabel(t.group,t.series,t.item,void 0,a,r.element.colors.lineColor)},{element:r,coord:i}),e._startAnimation("animPieSlice")}}}_applyPieUnselect(){this._stopAnimations();var e=this._selected;if(e){var t=this.getItemCoord(e.group,e.series,e.item);if(t&&t.center){var i=this.renderer.pieSlicePath(t.center.x,t.center.y,t.innerRadius,t.outerRadius,t.fromAngle,t.toAngle,t.centerOffset);this.renderer.attr(e.element,{d:i}),this._showPieLabel(e.group,e.series,e.item,void 0,0,this._getRenderInfo(e.group,e.series,e.item).colors.lineColor)}}}_unselect(){var e=this;if(e._selected){var t=e._selected.group,i=e._selected.series,r=e._selected.item,n=e._selected.iidxBase,a=e._selected.type,l=e.seriesGroups[t],o=l.series[i],s=-1!==l.type.indexOf("line")&&-1===l.type.indexOf("area"),d=e._getColors(t,i,n||r,e._getGroupGradientType(t)),g=d.fillColor;s&&(g="none");var u=e._getSerieSettings(t,i),p="symbol"===a?d.lineColorSymbol:d.lineColor;g="symbol"===a?d.fillColorSymbol:g,this.renderer.getAttr(e._selected.element,"fill")===d.fillColorAltSelected&&(g=d.fillColorAlt);var h="symbol"===a?1:u.stroke;e.renderer.attr(e._selected.element,{stroke:p,fill:g,"stroke-width":h}),(-1!==l.type.indexOf("pie")||-1!==l.type.indexOf("donut"))&&this._applyPieUnselect(),e._selected=void 0,isNaN(r)||e._raiseItemEvent("mouseout",l,o,r)}e._pointMarker&&(e._pointMarker.element&&(e.renderer.removeElement(e._pointMarker.element),e._pointMarker.element=void 0),e._pointMarker=void 0,e._hideCrosshairs())}_raiseItemEvent(e,t,i,r){for(var n=i[e]||t[e],s=0;s<this.seriesGroups.length&&!(this.seriesGroups[s]===t);s++);if(s!==this.seriesGroups.length){var a={event:e,seriesGroup:t,serie:i,elementIndex:r,elementValue:this._getDataValue(r,i.dataField,s)};n&&"function"==typeof n&&n(a),this.$.fireEvent(e,a)}}_calcInterval(e,t,i){var r=Math.abs,n=r(t-e),s=n/i,a=.1,l=[1,2,3,4,5,10,15,20,25,50,100];1>s&&(l=[.5,.25,.125,.1],a=10);var o=0;do{o=0,1<=s?a*=10:a/=10;for(let e=1;e<l.length&&r(l[o]*a-s)>r(l[e]*a-s);e++)o=e}while(o==l.length-1);return l[o]*a}_renderDataClone(){if(this._renderData&&!this._isToggleRefresh){var e=this._elementRenderInfo=[];if(!this._isSelectorRefresh)for(let i=0;i<this._renderData.length;i++){for(;e.length<=i;)e.push({});var t=e[i],r=this._renderData[i];if(r.offsets){if(r.valueAxis)for(let e in t.valueAxis={itemOffsets:{}},r.valueAxis.itemOffsets)t.valueAxis.itemOffsets[e]=r.valueAxis.itemOffsets[e];if(r.xAxis)for(let e in t.xAxis={itemOffsets:{}},r.xAxis.itemOffsets)t.xAxis.itemOffsets[e]=r.xAxis.itemOffsets[e];t.series=[];var n=t.series,a=this._isPieGroup(i);for(let e=0;e<r.offsets.length;e++){n.push({});for(let t=0;t<r.offsets[e].length;t++)if(!a)n[e][r.xoffsets.xvalues[t]]={value:r.offsets[e][t].value,valueRadius:r.offsets[e][t].valueRadius,xoffset:r.xoffsets.data[t],from:r.offsets[e][t].from,to:r.offsets[e][t].to};else{var l=r.offsets[e][t];n[e][l.displayValue]={value:l.value,x:l.x,y:l.y,fromAngle:l.fromAngle,toAngle:l.toAngle}}}}}}}getPolarDataPointOffset(e,t,i){var r=this._renderData[i];if(!r)return{x:NaN,y:NaN};var n=this.getValueAxisDataPointOffset(t,i),s=this.getXAxisDataPointOffset(e,i),a=this._toPolarCoord(r.polarCoords,r.xAxis.rect,s,n);return{x:a.x,y:a.y}}_getDataPointOffsetDiff(e,t,i,r,n,s,a){var l=this._getDataPointOffset(e,i,r,n,s,a),o=this._getDataPointOffset(t,i,r,n,s,a);return Math.abs(l-o)}_getXAxisRenderData(e){if(!(e>=this._renderData.length)){var t=this.seriesGroups[e],r=this._renderData[e].xAxis;if(r){if(void 0===t.xAxis||null===t.xAxis)for(let t=0;t<=e;t++)if(void 0===this.seriesGroups[t].xAxis||null===this.seriesGroups[t].xAxis){r=this._renderData[t].xAxis;break}return r}}}getXAxisDataPointOffset(e,t){var i=this.seriesGroups[t];if(isNaN(e))return NaN;const r=this._getXAxisRenderData(t);if(!r)return NaN;var n=r.data.axisStats,s=n.min.valueOf(),a=n.max.valueOf(),l=a-s;if(0===l&&(l=1),e.valueOf()>a||e.valueOf()<s)return NaN;var o=this._getXAxis(t),d="horizontal"===i.orientation?"height":"width",g="horizontal"===i.orientation?"y":"x",u=(e.valueOf()-s)/l,p=r.rect[d]-r.data.padding.left-r.data.padding.right;if(i.polar||i.spider){var h=this._renderData[t].polarCoords;h.isClosedCircle&&(p=r.data.axisSize)}return this._plotRect[g]+r.data.padding.left+p*(o.flip?1-u:u)}getValueAxisDataPointOffset(e,t){var i=this._getValueAxis(t);if(!i)return NaN;var r=this._renderData[t];if(!r)return NaN;var n=!0===i.flip,s=r.logBase,a=r.scale,l=r.gbase,o=r.baseOffset;return this._getDataPointOffset(e,l,s,a,o,n)}_getDataPointOffset(e,t,i,r,n,s){var a;return isNaN(e)&&(e=t),a=isNaN(i)?(e-t)*r:(this._draw.log(e,i)-this._draw.log(t,i))*r,a=s?n+a:n-a,a}_calcGroupOffsets(e,t){for(var r=Math.abs,n=this.seriesGroups[e];this._renderData.length<e+1;)this._renderData.push({});if(null!==this._renderData[e]&&void 0!==this._renderData[e].offsets)return this._renderData[e];if(this._isPieGroup(e))return this._calcPieSeriesGroupOffsets(e,t);var i=this._getValueAxis(e);if(!i||!n.series||0===n.series.length)return this._renderData[e];var s=!0===i.flip,a=!0===i.logarithmicScale,l=i.logarithmicScaleBase||10,o=[],d=-1!==n.type.indexOf("stacked"),g=d&&-1!==n.type.indexOf("100"),u=-1!==n.type.indexOf("range"),p=this._isColumnType(n.type),m=-1!==n.type.indexOf("waterfall"),c=this._getDataLen(e),x=n.baselineValue||i.baselineValue||0;g&&(x=0);var _=this._stats.seriesGroups[e];if(_&&_.isValid){var b=_.hasStackValueReversal;if(b&&(x=0),m&&d){if(b)return;x=_.base}x>_.max&&(x=_.max),x<_.min&&(x=_.min);var v=g||a?_.maxRange:_.max-_.min,A=_.min,w=_.max,S=t.height/(a?_.intervals:v),C=0;g?0>A*w?(v/=2,C=-(v+x)*S):C=-x*S:C=-(x-A)*S,s?C=t.y-C:C+=t.y+t.height;var I=[],M=[],F=[],D;a&&(D=this._draw.log(w,l)-this._draw.log(x,l),d&&(D=_.intervals,x=g?0:A),!s&&(C=t.y+D/_.intervals*t.height)),C=this.renderer._ptrnd(C);var T=0>A*w?t.height/2:t.height,O=[],R=[],L=d&&(p||a),P=[];o=Array(n.series.length);for(let e=0;e<n.series.length;e++)o[e]=Array(c);for(let t=0;t<c;t++){!m&&d&&(R=[]);for(let i=0;i<n.series.length;i++){!d&&a&&(O=[]);var G=n.series[i],V=G.dataField,E=G.dataFieldFrom,B=G.dataFieldTo,H=G.radiusDataField||G.sizeDataField;o[i][t]={};var z=this._isSerieVisible(e,i);if(-1!==n.type.indexOf("candle")||-1!==n.type.indexOf("ohlc")){var W=["Open","Close","High","Low"];for(var X in W){var f="dataField"+W[X];G[f]&&(o[i][t][W[X]]=this._getDataPointOffset(this._getDataValueAsNumber(t,G[f],e),x,a?l:NaN,S,C,s))}continue}if(d)for(;R.length<=t;)R.push(0);var N=NaN;u&&(N=this._getDataValueAsNumber(t,E,e),isNaN(N)&&(N=x));var U=NaN;U=u?this._getDataValueAsNumber(t,B,e):this._getDataValueAsNumber(t,V,e);var Y=this._getDataValueAsNumber(t,H,e);if(d&&(R[t]+=z?U:0),z||(U=NaN),isNaN(U)||a&&0>=U){o[i][t]={from:void 0,to:void 0};continue}var Z;d&&(L?Z=U>=x?I:M:U=R[t]);var q=S*(U-x);if(u&&(q=S*(U-N)),d&&L&&(P[t]?q=S*U:(P[t]=!0,q=S*(U-x))),a){for(;O.length<=t;)O.push({p:{value:0,height:0},n:{value:0,height:0}});var j=u||u?N:x,J=U>j?O[t].p:O[t].n;J.value+=U,g?(U=100*(J.value/(_.psums[t]+_.nsums[t])),q=(this._draw.log(U,l)-_.minPow)*S):(q=this._draw.log(J.value,l)-this._draw.log(j,l),q*=S),q-=J.height,J.height+=q}var K=C;if(u){var $=0;$=a?(this._draw.log(N,l)-this._draw.log(x,l))*S:(N-x)*S,K+=s?$:-$}if(d){if(g&&!a){var Q=_.psums[t]-_.nsums[t];U>x?(q=_.psums[t]/Q*T,0!==_.psums[t]&&(q*=U/_.psums[t])):(q=_.nsums[t]/Q*T,0!==_.nsums[t]&&(q*=U/_.nsums[t]))}L&&(isNaN(Z[t])&&(Z[t]=K),K=Z[t])}isNaN(F[t])&&(F[t]=0);var ee=F[t];q=r(q);var te=q;if(1<=q){const e=this.renderer._ptrnd(q)-1;q=.5<r(q-e)?Math.round(q):e}if(ee+=q-te,d||(ee=0),.5<r(ee)&&(0<ee?(q-=1,ee-=1):(q+=1,ee+=1)),F[t]=ee,i==n.series.length-1&&g){var ie=0;for(let e=0;e<i;e++)ie+=r(o[e][t].to-o[e][t].from);if(ie+=q,ie<T)if(.5<q)q=this.renderer._ptrnd(q+T-ie);else for(var re=i-1,ne;0<=re;){if(ne=r(o[re][t].to-o[re][t].from),1<ne){o[re][t].from>o[re][t].to&&(o[re][t].from+=T-ie);break}re--}}s&&(q*=-1);var se=U<x;u&&(se=N>U);var ae=isNaN(N)?U:{from:N,to:U};se?(L&&(Z[t]+=q),o[i][t]={from:K,to:K+q,value:ae,valueRadius:Y}):(L&&(Z[t]-=q),o[i][t]={from:K,to:K-q,value:ae,valueRadius:Y})}}var le=this._renderData[e];return le.baseOffset=C,le.gbase=x,le.logBase=a?l:NaN,le.scale=S,le.offsets=m?this._applyWaterfall(o,c,e,C,x,a?l:NaN,S,s,d):o,le.xoffsets=this._calculateXOffsets(e,t.width),this._renderData[e]}}_isPercent(e){return"string"==typeof e&&0<e.length&&e.indexOf("%")===e.length-1}_calcPieSeriesGroupOffsets(e,t){var i=this,r=this._getDataLen(e),n=this.seriesGroups[e],a=this._renderData[e]={},l=a.offsets=[];for(let a=0;a<n.series.length;a++){var o=n.series[a],s=this._get([o.minAngle,o.startAngle]);(isNaN(s)||0>s||360<s)&&(s=0);var d=this._get([o.maxAngle,o.endAngle]);(isNaN(d)||0>d||360<d)&&(d=360);var g=d-s,u=o.initialAngle||0;u<s&&(u=s),u>d&&(u=d);var p=o.centerOffset||0,h=this._draw.getNum([o.offsetX,n.offsetX,t.width/2]),m=this._draw.getNum([o.offsetY,n.offsetY,t.height/2]),c=Math.min(t.width,t.height)/2,f=u,_=o.radius;i._isPercent(_)&&(_=parseFloat(_)/100*c),isNaN(_)&&(_=.4*c);var b=o.innerRadius;i._isPercent(b)&&(b=parseFloat(b)/100*c),(isNaN(b)||b>=_)&&(b=0);var v=o.selectedRadiusChange;i._isPercent(v)&&(v=parseFloat(v)/100*(_-b)),isNaN(v)&&(v=.1*(_-b)),l.push([]);var A=0,w=0;for(let t=0;t<r;t++){var S=this._getDataValueAsNumber(t,o.dataField,e);isNaN(S)||!this._isSerieVisible(e,a,t)&&!0!==o.hiddenPointsDisplay||(0<S?A+=S:w+=S)}var C=A-w;0==C&&(C=1);for(let n=0;n<r;n++){var S=this._getDataValueAsNumber(n,o.dataField,e);if(isNaN(S)){l[a].push({});continue}var k=o.displayText||o.displayField,I=this._getDataValue(n,k,e);(I===void 0||null===I)&&(I=n);var M=0,F=this._isSerieVisible(e,a,n);(F||!0===o.hiddenPointsDisplay)&&(M=Math.abs(S)/C*g);var D=t.x+h,x=t.y+m,y=p;"function"==typeof p&&(y=p({seriesIndex:a,seriesGroupIndex:e,itemIndex:n})),isNaN(y)&&(y=0);var T={key:e+"_"+a+"_"+n,value:S,displayValue:I,x:D,y:x,fromAngle:f,toAngle:f+M,centerOffset:y,innerRadius:b,outerRadius:_,selectedRadiusChange:v,visible:F};l[a].push(T),f+=M}}return a}_isPointSeriesOnly(){for(let t=0;t<this.seriesGroups.length;t++){var e=this.seriesGroups[t];if(-1===e.type.indexOf("line")&&-1===e.type.indexOf("area")&&-1===e.type.indexOf("scatter")&&-1===e.type.indexOf("bubble"))return!1}return!0}_hasColumnSeries(){var e=["column","ohlc","candlestick","waterfall"];for(let r=0;r<this.seriesGroups.length;r++){var t=this.seriesGroups[r];for(var i in e)if(-1!==t.type.indexOf(e[i]))return!0}return!1}_alignValuesWithTicks(e){var t=this._isPointSeriesOnly(),i=this.seriesGroups[e],r=this._getXAxis(e),n=void 0===r.valuesOnTicks||null===r.valuesOnTicks?t:!1!==r.valuesOnTicks;return r.logarithmicScale&&(n=!0),void 0===e||null===e?n:void 0===i.valuesOnTicks||null===i.valuesOnTicks?n:i.valuesOnTicks}_getYearsDiff(e,t){return t.getFullYear()-e.getFullYear()}_getMonthsDiff(e,t){return 12*(t.getFullYear()-e.getFullYear())+t.getMonth()-e.getMonth()}_getDateDiff(e,t,i,r){var n=0;switch("year"!==i&&"month"!==i&&(n=t.valueOf()-e.valueOf()),i){case"year":n=this._getYearsDiff(e,t);break;case"month":n=this._getMonthsDiff(e,t);break;case"day":n/=86400000;break;case"hour":n/=3600000;break;case"minute":n/=60000;break;case"second":n/=1e3;break;case"millisecond":}return"year"!==i&&"month"!==i&&!1!==r&&(n=this.renderer._rnd(n,1,!0)),n}_getBestDTUnit(e,t,r,n,s){var a="day",l=t.valueOf()-e.valueOf();a=1e3>l?"second":36e5>l?"minute":864e5>l?"hour":2592e6>l?"day":31104e6>l?"month":"year";var o=[{key:"year",cnt:l/31536000000},{key:"month",cnt:l/2592000000},{key:"day",cnt:l/86400000},{key:"hour",cnt:l/3600000},{key:"minute",cnt:l/60000},{key:"second",cnt:l/1e3},{key:"millisecond",cnt:l}],d=-1;for(let i=0;i<o.length;i++)if(o[i].key===a){d=i;break}for(var g=-1,u=-1;d<o.length&&!(o[d].cnt/100>n);d++){var p=this._estAxisInterval(e,t,r,n,o[d].key,s),h=this._getDTIntCnt(e,t,p,o[d].key);(-1===g||g<h)&&(g=h,u=d)}return a=o[u].key,a}_getXAxisStats(e,t,i){var r=Math.pow,n=Math.max,s=this._getDataLen(e),a="date"===t.type||"time"===t.type;if(a&&!this._autoDateFormats){this._autoDateFormats||(this._autoDateFormats=[]);var l=this._testXAxisDateFormat();l&&this._autoDateFormats.push(l)}var o=a?this._castAsDate(t.minValue,t.dateFormat):this._castAsNumber(t.minValue),d=a?this._castAsDate(t.maxValue,t.dateFormat):this._castAsNumber(t.maxValue);if(this._selectorRange&&this._selectorRange[e]){var g=this._selectorRange[e].min;isNaN(g)||(o=a?this._castAsDate(g,t.dateFormat):this._castAsNumber(g));var u=this._selectorRange[e].max;isNaN(u)||(d=a?this._castAsDate(u,t.dateFormat):this._castAsNumber(u))}var p=o,h=d,y=t.type===void 0||null===t.type||"auto"===t.type,m=y||"basic"===t.type,c=0,f=0,x,_;for(let r=0;r<s&&t.dataField;r++){var b=this._getDataValue(r,t.dataField,e);b=a?this._castAsDate(b,t.dateFormat):this._castAsNumber(b),isNaN(b)||(a?c++:f++,(isNaN(x)||b<x)&&(x=b),(isNaN(_)||b>=_)&&(_=b))}y&&(!a&&f===s||a&&c===s)&&(m=!1),m&&(x=0,_=n(0,s-1)),isNaN(p)&&(p=x),isNaN(h)&&(h=_),a?(!this._isDate(p)&&(p=this._isDate(h)?h:new Date),!this._isDate(h)&&(h=this._isDate(p)?p:new Date)):(isNaN(p)&&(p=0),isNaN(h)&&(h=m?n(0,s-1):p)),(x===void 0||null===x)&&(x=p),(_===void 0||null===_)&&(_=h);var v=t.rangeSelector&&t.rangeSelector.visible;if(v){var A=v.minValue||p;A&&a&&(A=this._castAsDate(A,v.dateFormat||t.dateFormat));var w=v.maxValue||h;w&&a&&(w=this._castAsDate(w,v.dateFormat||t.rangeSelector)),p<A&&(p=A),h<A&&(h=w),p>w&&(p=A),h>w&&(h=w)}var S,C;a&&(S=t.baseUnit,!S&&(S=this._getBestDTUnit(p,h,e,i)),C="hour"===S||"minute"===S||"second"===S||"millisecond"===S);var k=!0===t.logarithmicScale,I=t.logarithmicScaleBase;(isNaN(I)||1>=I)&&(I=10);var M=t.unitInterval;k?M=1:(isNaN(M)||0>=M)&&(M=this._estAxisInterval(p,h,e,i,S));var F={min:p,max:h},D=this.seriesGroups[e];if(k){p||(p=1,h&&p>h&&(p=h)),h||(h=p),F={min:p,max:h};var T=this.renderer._rnd(this._draw.log(p,I),1,!1),O=this.renderer._rnd(this._draw.log(h,I),1,!0);h=r(I,O),p=r(I,T)}else!a&&(D.polar||D.spider)&&(p=this.renderer._rnd(p,M,!1),h=this.renderer._rnd(h,M,!0));return{min:p,max:h,logAxis:{enabled:k,base:I,minPow:T,maxPow:O},dsRange:{min:x,max:_},filterRange:F,useIndeces:m,isDateTime:a,isTimeUnit:C,dateTimeUnit:S,interval:M}}_getDefaultDTFormatFn(e){var t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i;return i="year"===e||"month"===e||"day"===e?function(e){return e.getDate()+"-"+t[e.getMonth()]+"-"+e.getFullYear()}:function(e){return e.getDate()+"-"+t[e.getMonth()]+"-"+e.getFullYear()+"<br>"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},i}_getDTIntCnt(e,t,i,r){var n=0,s=new Date(e),a=new Date(t);if(a=a.valueOf(),0>=i)return 1;for(;s.valueOf()<a;)"millisecond"===r?s=new Date(s.valueOf()+i):"second"===r?s=new Date(s.valueOf()+1e3*i):"minute"===r?s=new Date(s.valueOf()+6e4*i):"hour"===r?s=new Date(s.valueOf()+24*(6e4*i)):"day"===r?s.setDate(s.getDate()+i):"month"===r?s.setMonth(s.getMonth()+i):"year"==r&&s.setFullYear(s.getFullYear()+i),n++;return n}_estAxisInterval(e,t,r,n,s,a){if(isNaN(e)||isNaN(t))return NaN;var l=[1,2,5,10,15,20,50,100,200,500],o=0,d=n/(!isNaN(a)&&0<a?a:50);if(this._renderData&&this._renderData.length>r&&this._renderData[r].xAxis&&!isNaN(this._renderData[r].xAxis.avgWidth)){var g=Math.max(1,this._renderData[r].xAxis.avgWidth);0!==g&&isNaN(a)&&(d=.9*n/g)}if(1>=d)return Math.abs(t-e);for(var u=0,p;p=o>=l.length?Math.pow(10,3+o-l.length):l[o],u=this._isDate(e)&&this._isDate(t)?this._getDTIntCnt(e,t,p,s):(t-e)/p,!(u<=d);)o++;var h=this.seriesGroups[r];return(h.spider||h.polar)&&2*p>t-e&&(p=t-e),p}_getPaddingSize(e,t,i,r,n,s,a){var l=Math.max,o=e.min,d=e.max;e.logAxis.enabled&&(o=e.logAxis.minPow,d=e.logAxis.maxPow);var g=e.interval,u=e.dateTimeUnit;if(n){var p=r/l(1,d-o+g)*g;return s?{left:0,right:p}:i?{left:0,right:0}:{left:p/2,right:p/2}}if(i&&!a)return{left:0,right:0};if(this._isDate(o)&&this._isDate(d)){var h=this._getDTIntCnt(o,d,Math.min(g,d-o),u),y=r/l(2,h);return{left:y/2,right:y/2}}var h=l(1,d-o);if(1===h){const e=r/4;return{left:e,right:e}}var y=r/(h+1);return{left:y/2,right:y/2}}_calculateXOffsets(e,t){var i=Math.abs,r=this.seriesGroups[e],n=this._getXAxis(e),s=[],a=[],l=this._getDataLen(e),o=this._getXAxisStats(e,n,t),d=o.min,g=o.max,u=o.isDateTime,p=o.isTimeUnit,h=this._hasColumnSeries(),y=r.polar||r.spider,m=this._get([r.startAngle,r.minAngle,0]),c=this._get([r.endAngle,r.maxAngle,360]),f=y&&!(1e-4<i(i(c-m)-360)),_=this._alignValuesWithTicks(e),b=this._getPaddingSize(o,n,_,t,y,f,h),v=g-d,A=o.filterRange;0===v&&(v=1);var w=t-b.left-b.right;y&&_&&!f&&(b.left=b.right=0);var S=-1,C=-1;for(let r=0;r<l;r++){var k=void 0===n.dataField?r:this._getDataValue(r,n.dataField,e);if(o.useIndeces){if(r<A.min||r>A.max){s.push(NaN),a.push(void 0);continue}if(M=b.left+(r-d)/v*w,!0===o.logAxis.enabled){var I=o.logAxis.base;M=this._smartPlot.scale(k,{min:d.valueOf(),max:g.valueOf(),type:"logarithmic",base:I},{min:0,max:w,flip:!1})}s.push(this.renderer._ptrnd(M)),a.push(k),-1==S&&(S=r),(-1==C||C<r)&&(C=r);continue}if(k=u?this._castAsDate(k,n.dateFormat):this._castAsNumber(k),isNaN(k)||k<A.min||k>A.max){s.push(NaN),a.push(void 0);continue}var M=0;if(!0===o.logAxis.enabled){var I=o.logAxis.base;M=this._smartPlot.scale(k,{min:d.valueOf(),max:g.valueOf(),type:"logarithmic",base:I},{min:0,max:w,flip:!1})}else M=!u||u&&p?(k-d)*w/v:(k.valueOf()-d.valueOf())/(g.valueOf()-d.valueOf())*w;M=this.renderer._ptrnd(b.left+M),s.push(M),a.push(k),-1==S&&(S=r),(-1==C||C<r)&&(C=r)}if(!0===n.flip)for(let e=0;e<s.length;e++)isNaN(s[e])||(s[e]=t-s[e]);(p||u)&&(v=this._getDateDiff(d,g,n.baseUnit),v=this.renderer._rnd(v,1,!1));var F=Math.max(1,v),D=w/F;return S==C&&1===F&&(s[S]=b.left+w/2),{axisStats:o,data:s,xvalues:a,first:S,last:C,length:-1==C?0:C-S+1,itemWidth:D,intervalWidth:D*o.interval,rangeLength:v,useIndeces:o.useIndeces,padding:b,axisSize:w}}_getXAxis(e){return void 0===e||null===e||this.seriesGroups.length<=e?this.xAxis:this.seriesGroups[e].xAxis||this.xAxis}_isGreyScale(e,t){var i=this.seriesGroups[e],r=i.series[t];if(!0===r.greyScale)return!0;return!1!==r.greyScale&&(!0===i.greyScale||!1!==i.greyScale&&!0===this.greyScale)}_getSeriesColors(e,t,r){var n=this._getSeriesColorsInternal(e,t,r);if(this._isGreyScale(e,t))for(var s in n)n[s]=this._draw.toGreyScale(n[s]);return n}_getColorFromScheme(e,t,i){var r="#000000",n=this.seriesGroups[e],s=n.series[t];if(this._isPieGroup(e)){var a=this._getDataLen(e);r=this._getItemColorFromScheme(s.colorScheme||n.colorScheme||this.colorScheme,t*a+i,e,t)}else{var l=0;for(let r=0;r<=e;r++)for(let i=0;i<this.seriesGroups[r].series.length&&(r!==e||parseInt(i)!==t);i++)l++;var o=this.colorScheme;if(n.colorScheme&&(o=n.colorScheme),(void 0===o||null===o||""===o)&&(o=this.colorSchemes[0].name),!o)return r;for(let e=0;e<this.colorSchemes.length;e++){var d=this.colorSchemes[e];if(d.name===o){for(;l>d.colors.length;)l-=d.colors.length,++e>=this.colorSchemes.length&&(e=0),d=this.colorSchemes[e];r=d.colors[l%d.colors.length]}}}return r}_createColorsCache(){this._colorsCache={get:function(e){if(this._store[e])return this._store[e]},set:function(e,t){1e4>this._size&&(this._store[e]=t,this._size++)},clear:function(){this._store={},this._size=0},_size:0,_store:{}}}_getSeriesColorsInternal(e,t,i){var r=this.seriesGroups[e],n=r.series[t];"function"===!typeof n.colorFunction&&"pie"!==r.type&&"donut"!==r.type&&(i=NaN);var s=e+"_"+t+"_"+(isNaN(i)?"NaN":i);if(this._colorsCache.get(s))return this._colorsCache.get(s);var a={lineColor:"#222222",lineColorSelected:"#151515",lineColorSymbol:"#222222",lineColorSymbolSelected:"#151515",fillColor:"#222222",fillColorSelected:"#333333",fillColorSymbol:"#222222",fillColorSymbolSelected:"#333333",fillColorAlt:"#222222",fillColorAltSelected:"#333333"},l;if("function"==typeof n.colorFunction){var o=isNaN(i)?NaN:this._getDataValue(i,n.dataField,e);if(-1!==r.type.indexOf("range")&&!isNaN(i)){var d=this._getDataValue(i,n.dataFieldFrom,e),g=this._getDataValue(i,n.dataFieldTo,e);o={from:d,to:g}}if(l=n.colorFunction(o,i,n,r),"object"==typeof l)for(let e in l)a[e]=l[e];else a.fillColor=l}else{for(let e in a)n[e]&&(a[e]=n[e]);n.fillColor||n.color?n.fillColor=n.fillColor||n.color:a.fillColor=this._getColorFromScheme(e,t,i)}var u={fillColor:{baseColor:"fillColor",adjust:1},fillColorSelected:{baseColor:"fillColor",adjust:1.1},fillColorSymbol:{baseColor:"fillColor",adjust:1},fillColorSymbolSelected:{baseColor:"fillColorSymbol",adjust:2},fillColorAlt:{baseColor:"fillColor",adjust:4},fillColorAltSelected:{baseColor:"fillColor",adjust:3},lineColor:{baseColor:"fillColor",adjust:.95},lineColorSelected:{baseColor:"lineColor",adjust:.95},lineColorSymbol:{baseColor:"lineColor",adjust:1},lineColorSymbolSelected:{baseColor:"lineColorSelected",adjust:1}};for(let r in a)("object"!=typeof l||!l[r])&&n[r]&&(a[r]=n[r]);for(let r in a)("object"!=typeof l||!l[r])&&(n[r]||(a[r]=this.renderer.adjustColor(a[u[r].baseColor],u[r].adjust)));return this._colorsCache.set(s,a),a}_getItemColorFromScheme(e,t,r,n){let s;for((void 0===e||""===e)&&(e=this.colorSchemes[0].name),s=0;s<this.colorSchemes.length&&!(e===this.colorSchemes[s].name);s++);for(var a=0;a<=t;){s===this.colorSchemes.length&&(s=0);var l=this.colorSchemes[s].colors.length;if(a+l<=t)a+=l,s++;else{var o=this.colorSchemes[s].colors[t-a];return this._isGreyScale(r,n)&&0===o.indexOf("#")&&(o=this._draw.toGreyScale(o)),o}}}getColorScheme(e){for(let t=0;t<this.colorSchemes.length;t++)if(this.colorSchemes[t].name===e)return this.colorSchemes[t].colors}addColorScheme(e,t){for(let r=0;r<this.colorSchemes.length;r++)if(this.colorSchemes[r].name===e)return void(this.colorSchemes[r].colors=t);this.colorSchemes.push({name:e,colors:t})}removeColorScheme(e){for(let t=0;t<this.colorSchemes.length;t++)if(this.colorSchemes[t].name===e){this.colorSchemes.splice(t,1);break}}_formatValue(e,t,i,r,n,s){if(e===void 0||null===e)return"";if(this._isObject(e)&&!this._isDate(e)&&!i)return"";if(i){if("function"===!typeof i)return e.toString();try{return i(e,s,n,r)}catch(t){return t.message}}return this._isNumber(e)?this._formatNumber(e,t):this._isDate(e)?this._formatDate(e,t):t?(t.prefix||"")+e.toString()+(t.sufix||""):e.toString()}_getFormattedValue(e,t,r,n,a,l){var o=this.seriesGroups[e],d=o.series[t],s="",g=n,u=a;d.labels&&(g=g||this._getFormatSettings(d.labels),u=u||d.labels.formatFunction),g||u||(g=this._getFormatSettings(d),u=d.formatFunction,!g&&!u&&(g=this._getFormatSettings(o),u=o.formatFunction));var p={},h=0;for(let i in d)0===i.indexOf("dataField")&&(p[i.substring(9).toLowerCase()]=this._getDataValue(r,d[i],e),h++);if(0==h&&(p=this._getDataValue(r,void 0,e)),-1!==o.type.indexOf("waterfall")&&this._isSummary(e,r)&&(p=this._renderData[e].offsets[t][r].value,h=0),u&&"function"==typeof u)try{return u(1==h?p[""]:p,r,d,o)}catch(t){return t.message}if(1==h&&this._isPieGroup(e))return this._formatValue(p[""],g,u,e,t,r);if(0<h){var y=0;for(let i in p){0<y&&""!==s&&(s+="<br>");var m="dataField"+(0<i.length?i.substring(0,1).toUpperCase()+i.substring(1):""),c="displayText"+(0<i.length?i.substring(0,1).toUpperCase()+i.substring(1):""),f=d[c]||d[m],x=p[i];if(void 0!==x)x=this._formatValue(x,g,u,e,t,r);else continue;s+=!0===l?x:f+": "+x,y++}}else void 0!==p&&null!==p&&(s=this._formatValue(p,g,u,e,t,r));return s||""}_isNumberAsString(e){if("string"!=typeof e)return!1;e=e.trim();for(let r=0;r<e.length;r++){var t=e.charAt(r);if(!("0"<=t&&"9">=t||","===t||"."===t)&&("-"!==t||0!=r)&&("("!==t||0!=r)&&(")"!==t||r!=e.length-1))return!1}return!0}_castAsDate(e,t){if(e instanceof Date&&!isNaN(e))return e;if("string"==typeof e){var r;try{if(t&&(r=Smart.Utilities.DateTime.parseDateString(e,void 0,t).toDate(),this._isDate(r)))return r;if(this._autoDateFormats)for(let t=0;t<this._autoDateFormats.length;t++)if(r=Smart.Utilities.DateTime.parseDateString(e,void 0,this._autoDateFormats[t]).toDate(),this._isDate(r))return r;var i=this._detectDateFormat(e);if(i&&(r=Smart.Utilities.DateTime.parseDateString(e,void 0,i).toDate(),this._isDate(r)))return this._autoDateFormats.push(i),r}catch(e){}return r=new Date(e),this._isDate(r)&&-1===e.indexOf(":")&&r.setHours(0,0,0,0),r}}_castAsNumber(e){if(e instanceof Date&&!isNaN(e))return e.valueOf();if("string"==typeof e)if(this._isNumber(e))e=parseFloat(e);else if(!/[a-zA-Z]/.test(e)){var t=new Date(e);void 0!==t&&null!==t&&(e=t.valueOf())}return e}_isNumber(e){return"string"==typeof e&&this._isNumberAsString(e)&&(e=parseFloat(e)),"number"==typeof e&&isFinite(e)}_isDate(e){return e instanceof Date&&!isNaN(e.getDate())}_isBoolean(e){return"boolean"==typeof e}_isObject(e){return e&&("object"==typeof e||"function"==typeof e)||!1}_formatDate(e,t){var i=e.toString();return t&&(t.dateFormat&&(i=new Smart.Utilities.DateTime(e).toString(t.dateFormat)),i=(t.prefix||"")+i+(t.sufix||"")),i}_formatNumber(e,t){if(!this._isNumber(e))return e;t=t||{};const i=this;let r=i.localization.decimalSeparator,n=i.localization.thousandsSeparator;t.decimalSeparator&&(r=t.decimalSeparator),t.thousandsSeparator&&(n=t.thousandsSeparator);var s=t.prefix||"",a=t.sufix||"",l=t.decimalPlaces;isNaN(l)&&(l=this._getDecimalPlaces([e],void 0,3));var o=t.negativeWithBrackets||!1,d=0>e;d&&o&&(e*=-1);var g=e.toString(),u=Math.pow(10,l),p;if(g=(Math.round(e*u)/u).toString(),isNaN(g)&&(g=""),p=g.lastIndexOf("."),0<l)for(0>p?(g+=r,p=g.length-1):"."!==r&&(g=g.replace(".",r));g.length-1-p<l;)g+="0";p=g.lastIndexOf(r),p=-1<p?p:g.length;var h=g.substring(p),y=0;for(let r=p;0<r;r--,y++)0==y%3&&r!==p&&(!d||1<r||d&&o)&&(h=n+h),h=g.charAt(r-1)+h;return g=h,d&&o&&(g="("+g+")"),s+g+a}_calculateControlPoints(e,t){var i=Math.sqrt,r=Math.pow,n=e[t],s=e[t+1],a=e[t+2],l=e[t+3],o=e[t+4],d=e[t+5],g=.4,u=i(r(a-n,2)+r(l-s,2)),p=i(r(o-a,2)+r(d-l,2)),h=u+p;0===h&&(h=1);var y=g*u/h,m=g-y;return[a+y*(n-o),l+y*(s-d),a-m*(n-o),l-m*(s-d)]}_getBezierPoints(e){var t=Math.abs,r="",n=[],s=[],a=e.split(" ");for(let t=0;t<a.length;t++){var l=a[t].split(",");n.push(parseFloat(l[0])),n.push(parseFloat(l[1])),isNaN(n[n.length-1])||isNaN(n[n.length-2])}var o=n.length;if(1>=o)return"";if(2===o)return r="M"+this.renderer._ptrnd(n[0])+","+this.renderer._ptrnd(n[1])+" L"+this.renderer._ptrnd(n[0]+1)+","+this.renderer._ptrnd(n[1]+1)+" ",r;for(let t=0;t<o-4;t+=2)s=s.concat(this._calculateControlPoints(n,t));for(let t=2;t<o-5;t+=2)r+=" C"+this.renderer._ptrnd(s[2*t-2])+","+this.renderer._ptrnd(s[2*t-1])+" "+this.renderer._ptrnd(s[2*t])+","+this.renderer._ptrnd(s[2*t+1])+" "+this.renderer._ptrnd(n[t+2])+","+this.renderer._ptrnd(n[t+3])+" ";return r=4>=o||3>t(n[0]-n[2])||3>t(n[1]-n[3])?"M"+this.renderer._ptrnd(n[0])+","+this.renderer._ptrnd(n[1])+" L"+this.renderer._ptrnd(n[2])+","+this.renderer._ptrnd(n[3])+" "+r:"M"+this.renderer._ptrnd(n[0])+","+this.renderer._ptrnd(n[1])+" Q"+this.renderer._ptrnd(s[0])+","+this.renderer._ptrnd(s[1])+" "+this.renderer._ptrnd(n[2])+","+this.renderer._ptrnd(n[3])+" "+r,4<=o&&(3>t(n[o-2]-n[o-4])||3>t(n[o-1]-n[o-3]))?r+=" L"+this.renderer._ptrnd(n[o-2])+","+this.renderer._ptrnd(n[o-1])+" ":5<=o&&(r+=" Q"+this.renderer._ptrnd(s[2*o-10])+","+this.renderer._ptrnd(s[2*o-9])+" "+this.renderer._ptrnd(n[o-2])+","+this.renderer._ptrnd(n[o-1])+" "),r}_createAnimationGroup(e){this._animGroups||(this._animGroups={}),this._animGroups[e]={animations:[],startTick:NaN}}_startAnimation(e){var t=new Date,i=t.getTime();this._animGroups[e].startTick=i,this._runAnimation(),this._enableAnimTimer()}_enqueueAnimation(e,t,i,r,n,s,a){0>r&&(r=0),a===void 0&&(a="easeInOutSine"),this._animGroups[e].animations.push({key:t,properties:i,duration:r,fn:n,context:s,easing:a})}_stopAnimations(){clearTimeout(this._animtimer),this._animtimer=void 0,this._animGroups=void 0}_enableAnimTimer(){if(!this._animtimer){var e=this;this._animtimer=setTimeout(function(){e._runAnimation()},this._animTickInt)}}_runAnimation(){if(this._animGroups){var e=new Date,t=e.getTime(),i={};for(var r in this._animGroups){var n=this._animGroups[r].animations,s=this._animGroups[r].startTick,a=0;for(let e=0;e<n.length;e++){var l=n[e],o=t-s;l.duration>a&&(a=l.duration);var d=0<l.duration?o/l.duration:1,g=d;if(l.easing&&0!==l.duration&&!1!==l.duration&&(g=Smart.Utilities.Animation.Easings[l.easing](o,0,1,l.duration)),1<d&&(d=1,g=1),l.fn){l.fn(l.key,l.context,g);continue}var u={};for(let e=0;e<l.properties.length;e++){var h=l.properties[e],p=0;p=1==d?h.to:g*(h.to-h.from)+h.from,u[h.key]=p}this.renderer.attr(l.key,u)}s+a>t&&(i[r]={startTick:s,animations:n})}this._animGroups=i,this.renderer instanceof Smart.Utilities.HTML5Renderer&&this.renderer.refresh()}this._animtimer=null,0<Object.values(this._animGroups).length&&this._enableAnimTimer()}_fixCoords(e,t){var i="horizontal"===this.seriesGroups[t].orientation;if(!i)return e;var r=e.x;e.x=e.y,e.y=r+this._plotRect.y-this._plotRect.x;var r=e.width;return e.width=e.height,e.height=r,e}getItemCoord(e,t,i){var r=Math.sin,n=Math.cos,a=Math.abs,l=Math.PI,o=Math.min,d=this;if(d._isPieGroup(e)&&(!d._isSerieVisible(e,t,i)||!d._renderData||d._renderData.length<=e))return{x:NaN,y:NaN};if(!d._isSerieVisible(e,t)||!d._renderData||d._renderData.length<=e)return{x:NaN,y:NaN};var u=d.seriesGroups[e],g=u.series[t],s=d._getItemCoord(e,t,i);if(d._isPieGroup(e)){if(isNaN(s.x)||isNaN(s.y)||isNaN(s.fromAngle)||isNaN(s.toAngle))return{x:NaN,y:NaN};var p=this._plotRect,h=s.fromAngle*(l/180),m=s.toAngle*(l/180);const e=p.x+s.center.x+n(h)*s.outerRadius,t=p.x+s.center.x+n(m)*s.outerRadius,i=p.y+s.center.y-r(h)*s.outerRadius,d=p.y+s.center.y-r(m)*s.outerRadius;var c=o(e,t),f=a(t-e);let g=o(i,d);var x=a(d-i);return s={x:c,y:g,width:f,height:x,center:s.center,centerOffset:s.centerOffset,innerRadius:s.innerRadius,outerRadius:s.outerRadius,selectedRadiusChange:s.selectedRadiusChange,fromAngle:s.fromAngle,toAngle:s.toAngle},s}if(-1!==u.type.indexOf("column")||-1!==u.type.indexOf("waterfall")){var _=this._getColumnSerieWidthAndOffset(e,t);s.height=a(s.y.to-s.y.from),s.y=o(s.y.to,s.y.from),s.x+=_.offset,s.width=_.width}else if(-1!==u.type.indexOf("ohlc")||-1!==u.type.indexOf("candlestick")){var _=this._getColumnSerieWidthAndOffset(e,t);let i=s.y;var b=o(i.Open,i.Close,i.Low,i.High),v=Math.max(i.Open,i.Close,i.Low,i.High);s.height=a(v-b),s.y=b,s.x+=_.offset,s.width=_.width}else if(-1!==u.type.indexOf("line")||-1!==u.type.indexOf("area"))s.width=s.height=0,s.y=s.y.to;else if(-1!==u.type.indexOf("bubble")||-1!==u.type.indexOf("scatter")){s.center={x:s.x,y:s.y.to};var y=s.y.radius;"circle"!==g.symbolType&&void 0!==g.symbolType&&null!==g.symbolType&&(y/=2),s.y=s.y.to,s.radius=y,s.width=2*y,s.height=2*y}if(s=this._fixCoords(s,e),u.polar||u.spider){var A=this._toPolarCoord(this._renderData[e].polarCoords,this._plotRect,s.x,s.y);s.x=A.x,s.y=A.y,s.center&&(s.center=this._toPolarCoord(this._renderData[e].polarCoords,this._plotRect,s.center.x,s.center.y))}return(-1!==u.type.indexOf("bubble")||-1!==u.type.indexOf("scatter"))&&(s.x-=y,s.y-=y),s}_getItemCoord(e,t,r){var n=this.seriesGroups[e],s,a;if(!n||!this._renderData)return{x:NaN,y:NaN};var l=n.series[t];if(!l)return{x:NaN,y:NaN};var o=this._plotRect;if(this._isPieGroup(e)){var d=this._renderData[e].offsets[t][r];if(!d)return{x:NaN,y:NaN};var g=(d.fromAngle+d.toAngle)/2*(Math.PI/180);return s=o.x+d.x+Math.cos(g)*d.outerRadius,a=o.y+d.y-Math.sin(g)*d.outerRadius,{x:s,y:a,center:{x:d.x,y:d.y},centerOffset:d.centerOffset,innerRadius:d.innerRadius,outerRadius:d.outerRadius,selectedRadiusChange:d.selectedRadiusChange,fromAngle:d.fromAngle,toAngle:d.toAngle}}if(s=o.x+this._renderData[e].xoffsets.data[r],a=this._renderData[e].offsets[t][r],isNaN(s)||!a)return{x:NaN,y:NaN};var u={};for(var p in a)u[p]=a[p];return{x:s,y:u}}getXAxisValue(e,t){var i=Math.PI,r=this.seriesGroups[t];if(r){var n=this._getXAxis(t),s=this._plotRect,a=0,l=NaN,o=this._renderData[0].xoffsets.axisStats,d=0,g=0;if(r.polar||r.spider){if(isNaN(e.x)||isNaN(e.y))return NaN;var u=this._getPolarAxisCoords(t,s),p=this.renderer._ptdist(e.x,e.y,u.x,u.y);if(p>u.r)return NaN;var h=Math.atan2(u.y-e.y,e.x-u.x);h=i/2-h,0>h&&(h=2*i+h),l=h*u.r;var y=u.startAngle+i/2,m=u.endAngle+i/2;d=y*u.r,g=m*u.r,a=(m-y)*u.r;var c=this._getPaddingSize(o,n,n.valuesOnTicks,a,!0,u.isClosedCircle,this._hasColumnSeries());u.isClosedCircle?(a-=c.left+c.right,g-=c.left+c.right):!n.valuesOnTicks&&(d+=c.left,g-=c.right)}else{if("horizontal"!==r.orientation){if(e<s.x||e>s.x+s.width)return NaN;l=e-s.x,a=s.width}else{if(e<s.y||e>s.y+s.height)return NaN;l=e-s.y,a=s.height}if(this._renderData[t]&&this._renderData[t].xoffsets){var c=this._renderData[t].xoffsets.padding;a-=c.left+c.right,l-=c.left}g=a}var f=this._smartPlot.scale(l,{min:d,max:g},{min:o.min.valueOf(),max:o.max.valueOf(),type:o.logAxis.enabled?"logarithmic":"linear",base:o.logAxis.base,flip:n.flip});return f}}getValueAxisValue(e,t){var i=this.seriesGroups[t];if(i){var r=this._getValueAxis(t),n=this._plotRect,s=0,a=NaN;if(i.polar||i.spider){if(isNaN(e.x)||isNaN(e.y))return NaN;var l=this._getPolarAxisCoords(t,n);a=this.renderer._ptdist(e.x,e.y,l.x,l.y),s=l.r,a=s-a}else if("horizontal"===i.orientation){if(e<n.x||e>n.x+n.width)return NaN;a=e-n.x,s=n.width}else{if(e<n.y||e>n.y+n.height)return NaN;a=e-n.y,s=n.height}var o=this._stats.seriesGroups[t],d=this._smartPlot.scale(a,{min:0,max:s},{min:o.min.valueOf(),max:o.max.valueOf(),type:o.logarithmic?"logarithmic":"linear",base:o.logBase,flip:!r.flip});return d}}_detectDateFormat(e,t){var i={en_US_d:"M/d/yyyy",en_US_D:"dddd, MMMM dd, yyyy",en_US_t:"h:mm tt",en_US_T:"h:mm:ss tt",en_US_f:"dddd, MMMM dd, yyyy h:mm tt",en_US_F:"dddd, MMMM dd, yyyy h:mm:ss tt",en_US_M:"MMMM dd",en_US_Y:"yyyy MMMM",en_US_S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",en_CA_d:"dd/MM/yyyy",en_CA_D:"MMMM-dd-yy",en_CA_f:"MMMM-dd-yy h:mm tt",en_CA_F:"MMMM-dd-yy h:mm:ss tt",ISO:"yyyy-MM-dd hh:mm:ss",ISO2:"yyyy-MM-dd HH:mm:ss",d1:"dd.MM.yyyy",d2:"dd-MM-yyyy",zone1:"yyyy-MM-ddTHH:mm:ss-HH:mm",zone2:"yyyy-MM-ddTHH:mm:ss+HH:mm",custom:"yyyy-MM-ddTHH:mm:ss.fff",custom2:"yyyy-MM-dd HH:mm:ss.fff",de_DE_d:"dd.MM.yyyy",de_DE_D:"dddd, d. MMMM yyyy",de_DE_t:"HH:mm",de_DE_T:"HH:mm:ss",de_DE_f:"dddd, d. MMMM yyyy HH:mm",de_DE_F:"dddd, d. MMMM yyyy HH:mm:ss",de_DE_M:"dd MMMM",de_DE_Y:"MMMM yyyy",fr_FR_d:"dd/MM/yyyy",fr_FR_D:"dddd d MMMM yyyy",fr_FR_t:"HH:mm",fr_FR_T:"HH:mm:ss",fr_FR_f:"dddd d MMMM yyyy HH:mm",fr_FR_F:"dddd d MMMM yyyy HH:mm:ss",fr_FR_M:"d MMMM",fr_FR_Y:"MMMM yyyy",it_IT_d:"dd/MM/yyyy",it_IT_D:"dddd d MMMM yyyy",it_IT_t:"HH:mm",it_IT_T:"HH:mm:ss",it_IT_f:"dddd d MMMM yyyy HH:mm",it_IT_F:"dddd d MMMM yyyy HH:mm:ss",it_IT_M:"dd MMMM",it_IT_Y:"MMMM yyyy",ru_RU_d:"dd.MM.yyyy",ru_RU_D:"d MMMM yyyy '?.'",ru_RU_t:"H:mm",ru_RU_T:"H:mm:ss",ru_RU_f:"d MMMM yyyy '?.' H:mm",ru_RU_F:"d MMMM yyyy '?.' H:mm:ss",ru_RU_Y:"MMMM yyyy",cs_CZ_d:"d.M.yyyy",cs_CZ_D:"d. MMMM yyyy",cs_CZ_t:"H:mm",cs_CZ_T:"H:mm:ss",cs_CZ_f:"d. MMMM yyyy H:mm",cs_CZ_F:"d. MMMM yyyy H:mm:ss",cs_CZ_M:"dd MMMM",cs_CZ_Y:"MMMM yyyy",he_IL_d:"dd MMMM yyyy",he_IL_D:"dddd dd MMMM yyyy",he_IL_t:"HH:mm",he_IL_T:"HH:mm:ss",he_IL_f:"dddd dd MMMM yyyy HH:mm",he_IL_F:"dddd dd MMMM yyyy HH:mm:ss",he_IL_M:"dd MMMM",he_IL_Y:"MMMM yyyy",hr_HR_d:"d.M.yyyy.",hr_HR_D:"d. MMMM yyyy.",hr_HR_t:"H:mm",hr_HR_T:"H:mm:ss",hr_HR_f:"d. MMMM yyyy. H:mm",hr_HR_F:"d. MMMM yyyy. H:mm:ss",hr_HR_M:"d. MMMM",hu_HU_d:"yyyy.MM.dd.",hu_HU_D:"yyyy. MMMM d.",hu_HU_t:"H:mm",hu_HU_T:"H:mm:ss",hu_HU_f:"yyyy. MMMM d. H:mm",hu_HU_F:"yyyy. MMMM d. H:mm:ss",hu_HU_M:"MMMM d.",hu_HU_Y:"yyyy. MMMM",jp_JP_d:"gg y/M/d",jp_JP_D:"gg y'?'M'?'d'?'",jp_JP_t:"H:mm",jp_JP_T:"H:mm:ss",jp_JP_f:"gg y'?'M'?'d'?' H:mm",jp_JP_F:"gg y'?'M'?'d'?' H:mm:ss",jp_JP_M:"M'?'d'?'",jp_JP_Y:"gg y'?'M'?'",lt_LT_d:"yyyy.MM.dd",lt_LT_D:"yyyy 'm.' MMMM d 'd.'",lt_LT_t:"HH:mm",lt_LT_T:"HH:mm:ss",lt_LT_f:"yyyy 'm.' MMMM d 'd.' HH:mm",lt_LT_F:"yyyy 'm.' MMMM d 'd.' HH:mm:ss",lt_LT_M:"MMMM d 'd.'",lt_LT_Y:"yyyy 'm.' MMMM",sa_IN_d:"dd-MM-yyyy",sa_IN_D:"dd MMMM yyyy dddd",sa_IN_t:"HH:mm",sa_IN_T:"HH:mm:ss",sa_IN_f:"dd MMMM yyyy dddd HH:mm",sa_IN_F:"dd MMMM yyyy dddd HH:mm:ss",sa_IN_M:"dd MMMM",basic_y:"yyyy",basic_ym:"yyyy-MM",basic_d:"yyyy-MM-dd",basic_dhm:"yyyy-MM-dd hh:mm",basic_bhms:"yyyy-MM-dd hh:mm:ss",basic2_ym:"MM-yyyy",basic2_d:"MM-dd-yyyy",basic2_dhm:"MM-dd-yyyy hh:mm",basic2_dhms:"MM-dd-yyyy hh:mm:ss",basic3_ym:"yyyy/MM",basic3_d:"yyyy/MM/dd",basic3_dhm:"yyyy/MM/dd hh:mm",basic3_bhms:"yyyy/MM/dd hh:mm:ss",basic4_ym:"MM/yyyy",basic4_d:"MM/dd/yyyy",basic4_dhm:"MM/dd/yyyy hh:mm",basic4_dhms:"MM/dd/yyyy hh:mm:ss"};t&&(i=Object.assign({},i,t));var r=[];for(var n in Array.isArray(e)?r=e:r.push(e),i)i[n]={format:i[n],count:0};for(let n=0;n<r.length;n++){const e=r[n];if(null!==e&&void 0!==e)for(let t in i)try{const r=e instanceof Date||Smart.Utilities.DateTime.parseDateString(e,void 0,i[t].format);r&&i[t].count++}catch(e){}}var s={key:void 0,count:0};for(let r in i)i[r].count>s.count&&(s.key=r,s.count=i[r].count);return s.key?i[s.key].format:""}_testXAxisDateFormat(e){var t=this,r=t._getXAxis(e),n=t._getDataLen(e),i={};if(t.localization.patterns)for(let e in t.localization.patterns)i["local_"+e]=t.localization.patterns[e];var s=[];for(let a=0;a<n&&10>a;a++){const i=t._getDataValue(a,r.dataField,e);null===i||i===void 0||s.push(i)}var a=t._detectDateFormat(s,i);return a}_getThemeColor(e){var t=this.theme;if(document.body.getAttribute("theme")&&(t=document.body.getAttribute("theme")),"light"===t)switch(e){case"background":return"#FFFFFF";case"line":return"#BCBCBC";case"band":return"#AAAAAA";}return"background"===e?"#2E2E2E":"line"===e?"#707070":"band"===e?"#565656":void 0}});